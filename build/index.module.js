import{moment,qs,annyang,Browser,gpu,cloneDeep,isPlainObject,isArray}from"dtc";import CryptoJS__default,{MD5 as MD5$1,HmacSHA1,enc}from"crypto-js";import axios from"axios";import merge from"lodash.merge";import hotkeys from"hotkeys-js";import{TimelineMax}from"gsap";import{Howler,Howl}from"howler";import{compact}from"lodash-es";import UPNG from"upng-js";import{read,utils}from"xlsx";function mitt(e){return e=e||Object.create(null),{$on(t,i){(e[t]||(e[t]=[])).push(i)},$once(e,t){let i=this;this.$on(e,function n(){i.$off(e,n),t.apply(i,arguments)})},$off(t,i){e[t]&&e[t].splice(e[t].indexOf(i)>>>0,1)},$emit(t,i){(e[t]||[]).slice().map(e=>{e(i)}),(e["*"]||[]).slice().map(e=>{e(t,i)})}}}const __sys_bus_emitter=mitt();class EventBusServer{}Object.assign(EventBusServer.prototype,{getEventBus:()=>__sys_bus_emitter});class VuexServer{}Object.assign(VuexServer.prototype,{getState(){return this.getAppStore().state[this._type]},mapState(e){return mapState(this._type,e)},mapGetters(e){return mapGetters(this._type,e)},mapMutations(e){return mapMutations(this._type,e)},callState(e){return this.getAppStore().state[this._type][e]},callGetter(e,t){return this.getAppStore().getters[this._type+"/"+e](t)},callMutation(e,t){this.getAppStore().commit(this._type+"/"+e,t)}});const mapState=normalizeNamespace((e,t)=>{const i={};return normalizeMap(t).forEach(({key:t,val:n})=>{i[t]=function(){let t=this.$store.state,i=this.$store.getters;if(e){const n=getModuleByNamespace(this.$store,"mapState",e);if(!n)return;t=n.context.state,i=n.context.getters}return"function"==typeof n?n.call(this,t,i):t[n]},i[t].vuex=!0}),i}),mapMutations=normalizeNamespace((e,t)=>{const i={};return normalizeMap(t).forEach(({key:t,val:n})=>{i[t]=function(...t){let i=this.$store.commit;if(e){const t=getModuleByNamespace(this.$store,"mapMutations",e);if(!t)return;i=t.context.commit}return"function"==typeof n?n.apply(this,[i].concat(t)):i.apply(this.$store,[n].concat(t))}}),i}),mapGetters=normalizeNamespace((e,t)=>{const i={};return normalizeMap(t).forEach(({key:t,val:n})=>{n=e+n,i[t]=function(){if(!e||getModuleByNamespace(this.$store,"mapGetters",e)){if("production"===process.env.NODE_ENV||n in this.$store.getters)return this.$store.getters[n];console.error(`[vuex] unknown getter: ${n}`)}},i[t].vuex=!0}),i});function normalizeMap(e){return Array.isArray(e)?e.map(e=>({key:e,val:e})):Object.keys(e).map(t=>({key:t,val:e[t]}))}function normalizeNamespace(e){return(t,i)=>("string"!=typeof t?(i=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,i))}function getModuleByNamespace(e,t,i){const n=e._modulesNamespaceMap[i];return"production"===process.env.NODE_ENV||n||console.error(`[vuex] module namespace not found in ${t}(): ${i}`),n}class EventDispatcher{}Object.assign(EventDispatcher.prototype,{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),n=0,o=i.length;n<o;n++)i[n].call(this,e)}}}});const __sys_error=[],_maxCount=50;class MonitorServer{constructor(){this.initNormalError(),this.initConsoleError(),this.initPromiseError()}initNormalError(){window.onerror=((e,t,i,n,o)=>{let s=o?o.stack:e+"\n"+t+":"+i+":"+n;this._write(s)})}initConsoleError(){var e=console.error;console.error=(t=>{let i=t+"\n"+window.location.href+":0:0[console]";return this._write(i),e(t)})}initPromiseError(){window.onunhandledrejection=(e=>{let t="",i=(t="object"==typeof e.reason?JSON.stringify(e.reason):e.reason)+"\n"+window.location.href+":0:0[reject]";this._write(i)})}_write(e){try{app&&app.runtimeServer?__sys_error.length>0?(__sys_error.map(e=>{app.runtimeServer.addError(e)}),__sys_error.splice(0)):app.runtimeServer.addError(e):(__sys_error.length>=_maxCount&&__sys_error.shift(),__sys_error.push(e))}catch(e){}}}const monitorServer=new MonitorServer,__sys_log=[],_maxCount$1=200;class LogServer{}function judgeMedia(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t||console.log("getUserMedia is not implemented in this browser"),new Promise(function(i,n){t.call(navigator,e,i,n)})})}function runCallback(e){"function"==typeof e&&e()}function checkVideo(e,t){return judgeMedia(),new Promise((i,n)=>{navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{i(t),runCallback(e)}).catch(e=>{n(e),runCallback(t)})})}function checkAudio(e,t){return judgeMedia(),new Promise((i,n)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{i(),t.getTracks().forEach(function(e){e.stop()}),runCallback(e)}).catch(e=>{n(e),runCallback(t)})})}Object.assign(LogServer.prototype,{addError(e){this._addLog({type:"error",msg:e})},addWarn(e){this._addLog({type:"warn",msg:e})},addInfo(e){this._addLog({type:"info",msg:e})},_addLog(e){e=Object.assign({module:this._type,date:moment().format("HH:mm:ss")},e),__sys_log.length>=_maxCount$1&&__sys_log.shift(),__sys_log.push(e),this.getEventBus().$emit("logging",e)},getLog:()=>__sys_log,delLog(){__sys_log.splice(0)}});let __sys_current_context=null,__appStore=null,__http=null;class BaseServer{constructor(e){if(!e)throw new Error("Anov:server type is not null");this._type=e,this._http=__http,this._addLog({type:"info",module:"system",msg:this._type+"Server initialization"}),this.checkVideo=checkVideo,this.checkAudio=checkAudio}_extractConfig(e){return e[this._type]}getAppStore(){return __appStore}getCurrentContext(){return __sys_current_context}static _setCurrentContext(e){__sys_current_context=e}static _setAppStore(e){__appStore=e}}Object.assign(BaseServer.prototype,LogServer.prototype),Object.assign(BaseServer.prototype,EventDispatcher.prototype),Object.assign(BaseServer.prototype,EventBusServer.prototype),Object.assign(BaseServer.prototype,VuexServer.prototype);const T_KEY="anov@2019:helloX",T_IV="anov@2020:helloX",expire=30,token={ct:(e,t)=>getAesString(e+"|"+t,T_KEY,T_IV),vt(e){let t=getDAesString(e,T_KEY,T_IV);if(t&&t.split("|")[1]){let e=+t.split("|")[1],i=1e3*expire;return(new Date).getTime()-e<i}return!1}};function getAesString(e,t,i){t=CryptoJS__default.enc.Utf8.parse(t),i=CryptoJS__default.enc.Utf8.parse(i);return CryptoJS__default.AES.encrypt(e,t,{iv:i,mode:CryptoJS__default.mode.CBC,padding:CryptoJS__default.pad.Pkcs7}).toString()}function getDAesString(e,t,i){t=CryptoJS__default.enc.Utf8.parse(t),i=CryptoJS__default.enc.Utf8.parse(i);return CryptoJS__default.AES.decrypt(e,t,{iv:i,mode:CryptoJS__default.mode.CBC,padding:CryptoJS__default.pad.Pkcs7}).toString(CryptoJS__default.enc.Utf8)}const ga={info:{},getInfo(){var e={};document&&(e.domain=document.domain||"",e.url=document.URL||"",e.title=document.title||"",e.referrer=document.referrer||""),window&&window.screen&&(e.sh=window.screen.height||0,e.sw=window.screen.width||0,e.cd=window.screen.colorDepth||0),navigator&&(e.lang=navigator.language||""),e.GPUmodel=this.info.GPUmodel||"",e.GPUmanufacturer=this.info.GPUmanufacturer||"",e.memoryTotalJsHeapSize=this.info.memoryTotalJsHeapSize||0,e.memoryUsedJsHeapSize=this.info.memoryUsedJsHeapSize||0,e.fps=this.info.fps||0;var t="";for(var i in e)""!=t&&(t+="&"),t+=i+"="+encodeURIComponent(e[i]);return t},updateInfo(e){this.info=Object.assign({},this.info,e)}};var httpInterceptors={init(e){e.http&&(this.http=e.http,e.request&&this.openRequestInterceptors(e.http),e.response&&this.openResponseInterceptors(e.http))},openRequestInterceptors(e){e.interceptors.request.use(e=>{if(!__ANOV__ENV)return void console.warn("__ANOV__ENV全局对象未配置。");let t=(new Date).getTime(),i=token.ct(__ANOV__ENV.projectId,t);return i&&(e.headers.Authorization=i,e.headers.Time=t,e.headers.GA=ga.getInfo(),e.headers["anov-client-type"]=getClientType(),e.headers["anov-version"]=__ANOV__ENV.platformVersion,e.headers["anov-core-version"]=__ANOV__ENV.platformCoreVersion,e.headers.level=__ANOV__ENV.level||"",e.headers.debug=__ANOV__ENV.debug,e.headers.projectLocalDir=__ANOV__ENV.projectLocalDir),e},e=>Promise.error(e))},openResponseInterceptors(e){e.interceptors.response.use(e=>200===e.status?Promise.resolve(e.data):Promise.reject(e.data),e=>(e.response&&e.response.status&&e.response.status,Promise.reject(e.response)))},updateGaInfo(e){ga.updateInfo(e)}};function getClientType(){let e="anov-null";if(__ANOV__ENV&&__ANOV__ENV.platformName)switch(__ANOV__ENV.platformName.toLowerCase()){case"anov":case"anov-dev":e="screen";break;case"anov-go":e="go";break;case"anov-remote":e="remote";break;case"anov-admin":e="server"}return e}const TIMEOUT=6e3,eventType={connected:"adminServer__connected",logined:"logined"};class AdminServer extends BaseServer{constructor(){super("admin"),this.addEventListener("connected"),this.getEventBus().$on("logging",this._addLogToServer.bind(this))}get serverPath(){return this.callState("serverPath")}get connected(){return this.callState("connected")}get isActive(){return this.callState("isActive")}setConnected(e){this.callMutation("setConnected",e)}setServerPath(e){this.callMutation("setServerPath",e)}setIsActive(e){this.callMutation("setIsActive",e)}init(e){let t=this._extractConfig(e);if(!t.serverPath)return void this.addWarn("Server address not configured,[serverPath] is null.");this.setServerPath(t.serverPath);let i=t.timeout||TIMEOUT;this._http=axios.create({baseURL:this.serverPath,timeout:i,headers:{"Content-Type":"application/json;charset=UTF-8"},withCredentials:!0}),httpInterceptors.init({http:this._http,request:!0,response:!0}),this._httpScreenshot=axios.create({timeout:i,headers:{"Content-Type":"application/json;charset=UTF-8"},withCredentials:!0}),httpInterceptors.init({http:this._httpScreenshot,request:!0,response:!0})}getVerifyCodeImg(e){this._http&&this._http.get("/auth/code").then(t=>{e&&e(t)}).catch(t=>{e&&e(!1),this.addError(t.message)})}login(e,t){this._http&&this._http.post("/auth/login",{username:e.username,password:e.password,code:e.code,uuid:e.uuid}).then(e=>{t&&t(e),this.dispatchEvent({type:eventType.logined,result:e})}).catch(e=>{t&&t(e),this.addError(e.message)}).finally(()=>{})}getConfig(e,t){if(!e.key)return this.addError("ProjectId is null"),void(t&&t(!1));this._http.get(`/api/devScreen/checkingScreen?key=${e.key}&code=${e.code}`).then(e=>{t&&t(e),this.code=e.data?e.data.code:""}).catch(e=>{this.addError(e&&e.message),t&&t(!1)})}vaildateToken(e){return token.vt(e)}_init_screenshot_params(e){this._httpScreenshot&&this._httpScreenshot.post("/take",{origin:this.serverPath,...e}).catch(()=>void 0)}_screenshot_upload(){if("development"===process.env.NODE_ENV&&this._httpScreenshot)return this._httpScreenshot.post("/upload").catch(()=>void 0)}_addLogToServer(e){this._http&&__ANOV__ENV.projectId&&this._http.get("/api/devScreen/screenLog",{params:{key:__ANOV__ENV.projectId,description:e.module+":"+e.msg,logType:e.type.toUpperCase(),code:this.code}}).catch(()=>{})}screenshotUpload(e,t){let i=new FormData;i.append("file",e),this._http.post("/api/localStorage/screenFileUpLoad",i).then(e=>{t&&t(e)}).catch(e=>{})}saveScreenImg(e,t){let i={screenImg:e.id,screenKey:e.key};this._http.post("/api/devBigScreen/saveScreenImg",i).then(e=>{t&&t(e)}).catch(e=>{})}getTerminalInfo(e,t){this._http&&this._http.get(`/api/devScreenOnline/findOnlineApp?key=${e.key}&code=${e.code}`).then(e=>{t&&t(e)}).catch(e=>{this.addError(e.message),t&&t(!1)})}updateGa(e){httpInterceptors.updateGaInfo(e)}}const adminServer=new AdminServer;class RuntimeServer extends BaseServer{constructor(){super("runtime")}init(e){this._sysConfigInit(e)}setAppStore(e){e&&BaseServer._setAppStore(e)}setCurrentContext(e){e&&BaseServer._setCurrentContext(e)}exec(code){try{eval(code)}catch(e){this.addError("代码注入异常:"+error.stack)}}_sysConfigInit(e){let t=window.location.href.split("?")[1]||"";t=t.split("#")[0];let i=qs.parse(t,{allowDots:!0,decoder:function(e,t){return"true"===e||"false"!==e&&t(e=e.replaceAll(/\%20|\+/g,"%2B"))}});merge(e,i)}}const runtimeServer=new RuntimeServer,eventType$1={execAction:"execAction"};class ActionServer extends BaseServer{constructor(){super("action"),this._items=[]}init(e){}addActions(e){Array.isArray(e)?e.map(e=>{this._add(e)}):this._add(e)}removeActions(e){Array.isArray(e)?e.map(e=>{this._remove(e)}):this._remove(e)}getActionById(e){return this._items.find(t=>t.id===e)}getActionByName(e){return this._items.find(t=>t.name===e)}getActions(){return this._items}exec(e,t,i=!0){let n=this.getActionById(e)||this.getActionByName(e);n&&n.exec(this.getCurrentContext(),t),i&&this.addInfo("执行动作 "+n.id+":"+n.name),this.dispatchEvent({type:eventType$1.execAction,result:n})}_add(e){this._items.find(t=>t.id===e.id)?this.addError("Anov.ActionServer._add(action):Unable to add, because "+e.id+" action is exists"):this._items.push(e)}_remove(e){this._items.splice(this._items.findIndex(t=>t.id===e),1)}}class Action{constructor(e){this.id=e.id,this.name=e.name,this.exec=e.exec}exec(e){this.exec&&this.exec(...e)}}const actionServer=new ActionServer;class DataSourceServer extends BaseServer{constructor(){super("dataSource"),this._ds={}}init(e){let t=this._extractConfig(e);this.type=t.type}addDataSources(e){this._ds=e}get type(){return this.callState("type")}set type(e){this.type!=e&&this.callMutation("setType",e)}create(){return this._ds[this.type.toUpperCase()]}}const dataSourceServer=new DataSourceServer,codeString="self.onmessage = function (e) {\n  switch (e.data.command) {\n    case \"transform\":\n      transform.transaction(e.data.buffer);\n      break;\n  }\n}\n\nvar transform = {\n  transaction(buffer) {\n    let bufTo16kHz = transform.to16kHz(buffer)\n    let bufTo16BitPCM = transform.to16BitPCM(bufTo16kHz)\n    // let bufToBase64 = transform.toBase64(bufTo16BitPCM)\n    self.postMessage({ 'buffer': bufTo16BitPCM })\n  },\n  to16kHz(buffer) {\n    var data = new Float32Array(buffer)\n    var fitCount = Math.round(data.length * (16000 / 44100))\n    var newData = new Float32Array(fitCount)\n    var springFactor = (data.length - 1) / (fitCount - 1)\n    newData[0] = data[0]\n    for (let i = 1; i < fitCount - 1; i++) {\n      var tmp = i * springFactor\n      var before = Math.floor(tmp).toFixed()\n      var after = Math.ceil(tmp).toFixed()\n      var atPoint = tmp - before\n      newData[i] = data[before] + (data[after] - data[before]) * atPoint\n    }\n    newData[fitCount - 1] = data[data.length - 1]\n    return newData\n  },\n\n  to16BitPCM(input) {\n    var dataLength = input.length * (16 / 8)\n    var dataBuffer = new ArrayBuffer(dataLength)\n    var dataView = new DataView(dataBuffer)\n    var offset = 0\n    for (var i = 0; i < input.length; i++, offset += 2) {\n      var s = Math.max(-1, Math.min(1, input[i]))\n      dataView.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true)\n    }\n    return Array.from(new Int8Array(dataView.buffer))\n  },\n  toBase64(buffer) {\n    var binary = ''\n    var bytes = new Uint8Array(buffer)\n    var len = bytes.byteLength\n    for (var i = 0; i < len; i++) {\n      binary += String.fromCharCode(bytes[i])\n    }\n    return window.btoa(binary)\n  }\n}";var blob=new Blob([codeString]),url=window.URL.createObjectURL(blob);let recorderWorker=new Worker(url),buffer$1=[],AudioContext=window.AudioContext||window.webkitAudioContext;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,recorderWorker.onmessage=function(e){buffer$1.push(...e.data.buffer)};class IatRecorder{constructor(e={}){this.config=e,this.state="ing",this.appId=this.config.configInfo.APPID,this.apiKey=this.config.configInfo.API_KEY}isSupport(){return!!(navigator.getUserMedia&&AudioContext&&recorderWorker)}start(){if(this.isSupport()&&!this.ws){this.abort(),this.state="ing";var e=new AudioContext;this.context=e,this.recorder=e.createScriptProcessor(0,1,1);var t=t=>{if("running"===e.state){var i=this.context.createMediaStreamSource(t);this.mediaStream=i,this.recorder.onaudioprocess=(e=>{this.sendData(e.inputBuffer.getChannelData(0))}),this.connectWebsocket()}else this.config.onError&&this.config.onError({error:"getMediaFail"})},i=e=>{this.recorder=null,this.mediaStream=null,this.context=null,this.config.onError&&this.config.onError({error:"getMediaFail"})};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(e=>{t(e)}).catch(e=>{i()}):navigator.getUserMedia({audio:!0,video:!1},e=>{t(e)},function(e){i()})}else this.isSupport()||this.config.onError&&this.config.onError({error:"getMediaFail"})}abort(){this.state="end";try{this.mediaStream.disconnect(this.recorder),this.recorder.disconnect()}catch(e){}}pause(){"running"===this.context.state&&this.context.suspend()}resume(){"suspended"===this.context.state&&this.context.resume()}sendData(e){recorderWorker.postMessage({command:"transform",buffer:e})}getHandShakeParams(){var e=this.appId,t=this.apiKey,i=Math.floor((new Date).getTime()/1e3),n=MD5$1(e+i).toString(),o=HmacSHA1(n,t),s=enc.Base64.stringify(o);return"?appid="+e+"&ts="+i+"&signa="+(s=encodeURIComponent(s))}connectWebsocket(){var e="wss://rtasr.xfyun.cn/v1/ws";if(e=`${e}${this.getHandShakeParams()}`,"WebSocket"in window)this.ws=new WebSocket(e);else{if(!("MozWebSocket"in window))return this.config.onError&&this.config.onError({error:"not-websocket"}),null;this.ws=new MozWebSocket(e)}this.ws.onopen=(e=>{this.mediaStream.connect(this.recorder),this.recorder.connect(this.context.destination),setTimeout(()=>{this.wsOpened(e)},500)}),this.ws.onmessage=(e=>{this.wsOnMessage(e)}),this.ws.onerror=(e=>{this.abort(),this.config.onError&&this.config.onError({error:"network"})}),this.ws.onclose=(e=>{this.abort(),this.ws=null})}wsOpened(){if(this.ws&&1===this.ws.readyState){var e=buffer$1.splice(0,2560);this.ws.send(new Int8Array(e)),this.clearBuffer=setInterval(()=>{buffer$1.length>3e3&&(buffer$1=[])},1e3),this.handlerInterval=setInterval(()=>{if(this.ws&&1!==this.ws.readyState)return clearInterval(this.clearBuffer),void clearInterval(this.handlerInterval);if(0===buffer$1.length)return"end"===this.state&&this.ws&&(this.ws.close(),this.ws=null,clearInterval(this.handlerInterval),clearInterval(this.clearBuffer)),!1;var e=buffer$1.splice(0,2560);e.length>0&&this.ws&&this.ws.send(new Int8Array(e))},40)}}wsOnMessage(e){let t=JSON.parse(e.data);"started"==t.action?this.config.onStart&&this.config.onStart(e):"result"==t.action?("end"!==this.state&&this.config.onSoundStart&&this.config.onSoundStart(),this.setResult(JSON.parse(t.data))):"error"==t.action&&(console.log("实时语音转写API错误码"+t.code),"10110"===t.code?this.config.onError&&this.config.onError({error:"no-license"}):this.config.onError&&this.config.onError({error:"websocket"}))}setResult(e){if(0!=e.cn.st.type)return;let t="";e.cn.st.rt[0].ws.forEach((e,i)=>{0!=i||"，"!=e.cw[0].w&&"。"!=e.cw[0].w&&"、"!=e.cw[0].w&&"？"!=e.cw[0].w||(e.cw[0].w=""),"啊"!=e.cw[0].w&&"嗯"!=e.cw[0].w&&"呃"!=e.cw[0].w&&"唉"!=e.cw[0].w&&"噢"!=e.cw[0].w||(e.cw[0].w=""),t+=e.cw[0].w}),t.length>=2&&this.config.onMessage&&this.config.onMessage([t],e.cn.st.type)}}const eventType$2={onStart:"onStart",onStop:"onStop",onSoundStart:"onSoundStart",onResult:"onResult",onResultMatch:"onResultMatch",onError:"onError",readyStart:"readyStart"};class VoiceRecognizeServer extends BaseServer{constructor(){super("voiceRecognize"),this._cmds=[],this.config={},this.iatRecorder=annyang,this.iatRecorder.setLanguage("zh-CN ?"),this.iatRecorder.addCallback("start",this._onStart.bind(this)),this.iatRecorder.addCallback("soundstart",this._onSoundStart.bind(this)),this.iatRecorder.addCallback("result",this._onResult.bind(this)),this.iatRecorder.addCallback("errorPermissionBlocked",this._onError.bind(this)),this.iatRecorder.addCallback("errorPermissionDenied",this._onError.bind(this)),this.iatRecorder.addCallback("errorNetwork",this._onError.bind(this))}init(e){let t=this._extractConfig(e);this.config={APPID:t.APPID,API_KEY:t.API_KEY},this.isStart=t.isStart,this.iatType=t.iatType,this.APPID=t.APPID,this.API_KEY=t.API_KEY}changeType(e){switch(e){case"default":this.iatRecorder=annyang;break;case"xf":this.iatRecorder=new IatRecorder({configInfo:this.config,onError:this._onError.bind(this),onMessage:this._onResult.bind(this),onStart:this._onStart.bind(this),onSoundStart:this._onSoundStart.bind(this)});break;default:this.iatRecorder=annyang}}changeServer(e){e!==this.iatType&&(this.iatRecorder&&this.iatRecorder.abort(),this.iatType=e,this.isStart&&this.iatRecorder.start({continuous:!1}))}get isStart(){return this.callState("isStart")}set isStart(e){this.callMutation("setIsStart",e)}get iatType(){return this.callState("iatType")}set iatType(e){this.changeType(e),this.callMutation("changeIatType",e)}get APPID(){return this.callState("APPID")}set APPID(e){this.callMutation("setAPPID",e)}get API_KEY(){return this.callState("API_KEY")}set API_KEY(e){this.callMutation("setAPIKEY",e)}readyStart(){this.dispatchEvent({type:eventType$2.readyStart})}start(){this.iatRecorder.start({continuous:!1})}stop(){this.iatRecorder.abort(),this.isStart=!1,this.addInfo("语音识别停止"),this.dispatchEvent({type:eventType$2.onStop})}pause(){this.iatRecorder.pause()}resume(){this.iatRecorder.resume()}toggle(){this.isStart?this.stop():this.start()}addCommands(e){Array.isArray(e)?this._cmds=this._cmds.concat(e):this._cmds.push(e)}getCommands(){return this._cmds}_onStart(){this.isStart=!0,this.addInfo("语音识别启动"),this.dispatchEvent({type:eventType$2.onStart})}_onSoundStart(){this.dispatchEvent({type:eventType$2.onSoundStart})}_onResult(e){this.addInfo("识别结果:["+e.join(",")+"]"),this._match(e)||this.dispatchEvent({type:eventType$2.onResult,result:e})}_onError(e){let t="";t="not-allowed"===e.error?"请在设置中允许浏览器访问麦克风。":"network"===e.error?"网络错误，请确保连接到远程服务器。":"getMediaFail"===e.error?"麦克风受限，请重新开启语音识别服务。":"websocket"===e.error?"websocket连接失败。":"not-websocket"===e.error?"浏览器不支持websocket。":"no-license"===e.error?"接口没有授权许可。":e.error,this.addError(t),this.dispatchEvent({type:eventType$2.onError,result:t}),this.isStart?this.stop():this.iatRecorder.abort()}_match(e){for(let t=0;t<e.length;t++)for(let i=0;i<this._cmds.length;i++){let n=this._cmds[i],o=n.tag.test(e[t]);if(n.tag.lastIndex=0,o)return n.params=[RegExp.$1,RegExp.$2,RegExp.$3],n.result=e,this.addInfo("指令命中: "+n.tag+"   提取参数:"+n.params.join(",")),this.dispatchEvent({type:eventType$2.onResultMatch,result:n}),!0}}}const voiceRecognizeServer=new VoiceRecognizeServer;function isSupport(){try{return new window.SpeechSynthesisUtterance,!0}catch(e){return!1}}function Synthesis(e={}){if(Synthesis.single_instance||(Synthesis.single_instance=this),e=Object.assign({lang:"zh-CN",volume:1,rate:1,pitch:.5},e),!isSupport())return console.log("your browser do net support the API, visit https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance get more infomation"),null;const t=window.speechSynthesis,i=new SpeechSynthesisUtterance;return Object.keys(e).forEach(t=>{i[t]=e[t]}),this.speak=function(e){e&&(i.text=e,t.speak(i))},this.cancel=function(){t.cancel()},this.setOption=function(t={}){Object.assign(e,t),Object.keys(e).forEach(t=>{i[t]=e[t]})},this.addEventListener=function(e,t){i.addEventListener(e,t)},this.getOption=function(){const{lang:e,volume:t,rate:n,pitch:o}=i;return{lang:e,volume:t,rate:n,pitch:o}},this.getStatus=function(){const{paused:e,pending:i,speaking:n}=t;return{paused:e,pending:i,speaking:n}},this.removeEventListener=function(e,t){i.removeEventListener(e,t)},Synthesis.single_instance}const codeString$1=" self.onmessage = function(e) {\n  transcode.transToAudioData(e.data)\n}\nvar transcode = {\ntransToAudioData: function(audioDataStr, fromRate = 16000, toRate = 22505) {\n  let outputS16 = transcode.base64ToS16(audioDataStr)\n  let output = transcode.transS16ToF32(outputS16)\n  output = transcode.transSamplingRate(output, fromRate, toRate)\n  output = Array.from(output)\n  self.postMessage({\n    data: output, \n    rawAudioData: Array.from(outputS16)\n  })\n},\ntransSamplingRate: function(data, fromRate = 44100, toRate = 16000) {\n  var fitCount = Math.round(data.length * (toRate / fromRate))\n  var newData = new Float32Array(fitCount)\n  var springFactor = (data.length - 1) / (fitCount - 1)\n  newData[0] = data[0]\n  for (let i = 1; i < fitCount - 1; i++) {\n    var tmp = i * springFactor\n    var before = Math.floor(tmp).toFixed()\n    var after = Math.ceil(tmp).toFixed()\n    var atPoint = tmp - before\n    newData[i] = data[before] + (data[after] - data[before]) * atPoint\n  }\n  newData[fitCount - 1] = data[data.length - 1]\n  return newData\n},\ntransS16ToF32: function(input) {\n  var tmpData = []\n  for (let i = 0; i < input.length; i++) {\n    var d = input[i] < 0 ? input[i] / 0x8000 : input[i] / 0x7fff\n    tmpData.push(d)\n  }\n  return new Float32Array(tmpData)\n},\nbase64ToS16: function(base64AudioData) {\n  base64AudioData = atob(base64AudioData)\n  const outputArray = new Uint8Array(base64AudioData.length)\n  for (let i = 0; i < base64AudioData.length; ++i) {\n    outputArray[i] = base64AudioData.charCodeAt(i)\n  }\n  return new Int16Array(new DataView(outputArray.buffer).buffer)\n},\n}\n";var Base64=require("js-base64").Base64,blob$1=new Blob([codeString$1]),url$1=window.URL.createObjectURL(blob$1);let transWorker=new Worker(url$1);function getWebsocketUrl(e){return new Promise((t,i)=>{var n=e.API_KEY,o=e.API_SECRET,s="wss://tts-api.xfyun.cn/v2/tts",r=location.host,a=(new Date).toGMTString(),l=`host: ${r}\ndate: ${a}\nGET /v2/tts HTTP/1.1`,c=CryptoJS__default.HmacSHA256(l,o),h=CryptoJS__default.enc.Base64.stringify(c);t(s=`${s}?authorization=${btoa(`api_key="${n}", algorithm="hmac-sha256", headers="host date request-line", signature="${h}"`)}&date=${a}&host=${r}`)})}class TTSRecorder extends EventDispatcher{constructor(e){super(),this.speed=50*e.rate,this.voice=100*e.volume,this.pitch=100*e.pitch,this.voiceName=e.voiceName,this.text=e.text,this.tte=e.tte,this.defaultText=e.defaultText,this.appId=e.APPID,this.API_KEY=e.API_KEY,this.API_SECRET=e.API_SECRET,this.audioData=[],this.audioDataOffset=0,this.status="init",transWorker.onmessage=(e=>{this.audioData.push(...e.data.data)})}setStatus(e){this.status=e}setParams({rate:e,volume:t,pitch:i,text:n,voiceName:o,tte:s}){void 0!==e&&(this.speed=(50*e).toFixed()-0),void 0!==t&&(this.voice=(100*t).toFixed()-0),void 0!==i&&(this.pitch=(100*i).toFixed()-0),n&&(this.text=n),s&&(this.tte=s),o&&(this.voiceName=o),this.resetAudio()}connectWebSocket(e){this.setStatus("ttsing");return getWebsocketUrl({API_KEY:this.API_KEY,API_SECRET:this.API_SECRET}).then(t=>{let i;if("WebSocket"in window)i=new WebSocket(t);else{if(!("MozWebSocket"in window))return void console.log("浏览器不支持WebSocket");i=new MozWebSocket(t)}this.ttsWS=i,i.onopen=(t=>{this.webSocketSend(),this.playTimeout=setTimeout(()=>{this.audioPlay(e)},1e3)}),i.onmessage=(t=>{this.result(t.data,e)}),i.onerror=(t=>{e&&"test"==e?this.dispatchEvent({type:"testError"}):this.dispatchEvent({type:"error"}),clearTimeout(this.playTimeout),this.setStatus("errorTTS")}),i.onclose=(e=>{})})}webSocketSend(){var e={common:{app_id:this.appId},business:{aue:"raw",auf:"audio/L16;rate=16000",vcn:this.voiceName,speed:this.speed,volume:this.voice,pitch:this.pitch,bgs:0,tte:this.tte},data:{status:2,text:this.encodeText(this.text||this.defaultText,"unicode"===this.tte?"base64&utf16le":"")}};this.ttsWS.send(JSON.stringify(e))}encodeText(e,t){switch(t){case"utf16le":{let t=new ArrayBuffer(4*e.length),i=new Uint16Array(t);for(let t=0,n=e.length;t<n;t++)i[t]=e.charCodeAt(t);return t}case"buffer2Base64":{let t="",i=new Uint8Array(e),n=i.byteLength;for(let e=0;e<n;e++)t+=String.fromCharCode(i[e]);return window.btoa(t)}case"base64&utf16le":return this.encodeText(this.encodeText(e,"utf16le"),"buffer2Base64");default:return Base64.encode(e)}}result(e,t){let i=JSON.parse(e);if(0!==i.code)return t&&"test"==t?this.dispatchEvent({type:"testError"}):this.dispatchEvent({type:"error"}),console.error(`合成失败: ${i.code}:${i.message}`),void this.resetAudio();transWorker.postMessage(i.data.audio),0===i.code&&2===i.data.status&&this.ttsWS.close()}resetAudio(){this.audioStop(),this.setStatus("init"),this.audioDataOffset=0,this.audioData=[],this.ttsWS&&this.ttsWS.close(),clearTimeout(this.playTimeout)}audioInit(){let e=window.AudioContext||window.webkitAudioContext;e&&(this.audioContext=new e,this.audioContext.resume(),this.audioDataOffset=0)}audioPlay(e){this.setStatus("play");let t=this.audioData.slice(this.audioDataOffset);this.audioDataOffset+=t.length;let i=this.audioContext.createBuffer(1,t.length,22050),n=i.getChannelData(0);if(i.copyToChannel)i.copyToChannel(new Float32Array(t),0,0);else for(let e=0;e<t.length;e++)n[e]=t[e];let o=this.bufferSource=this.audioContext.createBufferSource();o.buffer=i,o.connect(this.audioContext.destination),o.start(),e&&"test"==e?this.dispatchEvent({type:"testStart"}):this.dispatchEvent({type:"start"}),o.onended=(t=>{e&&"test"==e?this.dispatchEvent({type:"testEnd"}):this.dispatchEvent({type:"end"}),"play"===this.status&&(this.audioDataOffset<this.audioData.length?this.audioPlay():this.audioStop())})}audioStop(){if(this.setStatus("endPlay"),clearTimeout(this.playTimeout),this.audioDataOffset=0,this.bufferSource)try{this.bufferSource.stop()}catch(e){console.log(e)}}start(e){if(this.audioData.length)this.audioPlay(e);else{if(this.audioContext||this.audioInit(),!this.audioContext)return void console.log("该浏览器不支持webAudioApi相关接口");this.connectWebSocket(e)}}stop(){this.audioStop()}}function SynthesisXF(e={}){e=Object.assign({rate:1,volume:1,pitch:.5,voiceName:"",APPID:"",text:"",tte:"UTF8",APPID:"",API_SECRET:"",API_KEY:""},e);let t=new TTSRecorder(e);this.speak=function(e){t.setParams({text:e}),t.start()},this.cancel=function(){t.stop()},this.test=function(e){t.setParams({text:e}),t.start("test")},this.getOption=function(){const{speed:e,voice:i,pitch:n,voiceName:o}=t;return{rate:e/50,volume:i/100,pitch:n/100,voiceName:o}},this.setOption=function(i={}){Object.assign(e,i),Object.keys(e).forEach(i=>{switch(i){case"rate":t.speed=(50*e[i]).toFixed()-0;break;case"volume":t.voice=(100*e[i]).toFixed()-0;break;case"pitch":t.pitch=(100*e[i]).toFixed()-0}})},this.getStatus=function(){const{status:e}=t;return{status:e}},this.addEventListener=function(e,i){t.addEventListener(e,i)}}class VoiceFeedbackServer extends BaseServer{constructor(){super("voiceFeedback"),this.option={},this.state=!1,this.ready=!1,this.queue=[],this.thirdConfig={},this.synthesis=new Synthesis,this.synthesis.addEventListener("start",this._onStart.bind(this)),this.synthesis.addEventListener("end",this._onEnd.bind(this)),this.synthesis.addEventListener("error",this._onError.bind(this))}get isReady(){return this.ready}get isStart(){return this.callState("isStart")&&(this.state=!0),this.callState("isStart")}set isStart(e){this.state=e,this.callMutation("toggleOpen",e)}get synthesisType(){return this.callState("synthesisType")}set synthesisType(e){switch(e){case"default":this.synthesis=new Synthesis;break;case"xf":this.synthesis=new SynthesisXF(this.getThirdConfig()),this.synthesis.addEventListener("start",this._onStart.bind(this)),this.synthesis.addEventListener("end",this._onEnd.bind(this)),this.synthesis.addEventListener("error",this._onError.bind(this)),this.synthesis.addEventListener("testStart",this._onTestStart.bind(this)),this.synthesis.addEventListener("testEnd",this._onTestEnd.bind(this)),this.synthesis.addEventListener("testError",this._onTestError.bind(this));break;default:this.synthesis=new Synthesis}this.callMutation("changeSynthesisType",e)}init(e){if(this.synthesis?this.ready=!0:this.addError("your browser dont support"),this.callState("isStart")&&(this.state=!0),!this.ready)return;let t=this._extractConfig(e);this.setThirdConfig(t.thirdConfig,!0),this.toggleOpen(t.isStart),this.changeSynthesisType(t.synthesisType)}toggleOpen(e){e?this.start():this.stop(),this.addInfo("语音合成"+(e?"启动":"停止"))}setThirdConfig(e,t){if(this.callMutation("setThirdConfig",e),t)return;let i=this.synthesis.getOption();this.synthesis=new SynthesisXF(this.getThirdConfig()),this.synthesis.addEventListener("start",this._onStart.bind(this)),this.synthesis.addEventListener("end",this._onEnd.bind(this)),this.synthesis.addEventListener("error",this._onError.bind(this)),this.synthesis.setOption(i)}getThirdConfig(){return this.callState("thirdConfig")}speak(e,t,i){this.ready&&this.state?(t&&"object"==typeof t&&this.setOption(t),"boolean"==typeof t&&(i=t),i&&(this.synthesis.cancel(),this.queue=[]),0===this.queue.length&&this.synthesis.speak(e),this.queue.push(e)):this.isStart&&this.addWarn("voiceFeedbackServer unusable")}test(e,t){this.ready&&this.state?(t&&"object"==typeof t&&this.setOption(t),this.synthesis.test(e)):this.addWarn("voiceFeedbackServer unusable")}start(){this.state=!0,this.callMutation("toggleOpen",!0)}stop(){this.state=!1,this.callMutation("toggleOpen",!1),this.queue=[],this.synthesis.cancel()}getOption(){return this.synthesis.getOption()}setOption(e={}){Object.assign(this.option,e),this.synthesis.setOption(this.option)}changeSynthesisType(e){if(this.synthesis.synthesisType===e)return;this.synthesisType=e;let t=this.synthesis.getOption();this.synthesis.setOption(t)}_onStart(){this.dispatchEvent({type:"start"})}_onEnd(){this.queue.shift(),this.dispatchEvent({type:"end"}),this.queue.length&&this.synthesis.speak(this.queue[0])}_onError(e){this.dispatchEvent({type:"error",result:e.error})}_onTestStart(){this.dispatchEvent({type:"testStart"})}_onTestEnd(){this.queue=[],this.dispatchEvent({type:"testEnd"})}_onTestError(e){this.dispatchEvent({type:"testError",result:e})}}const voiceFeedbackServer=new VoiceFeedbackServer,pico={};function camvas(e,t,i,n){var o=this;this.ctx=e,this.video=t,this.callback=i,this.run=!1,this.video.setAttribute("autoplay","1"),this.video.setAttribute("playsinline","1"),this.video.setAttribute("width",1),this.video.setAttribute("height",1),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(e){o.video.srcObject=e,o.run=!0,o.update()},function(e){n&&n(e)}),this.stop=function(){this.video.srcObject&&this.video.srcObject.getTracks().length>0&&this.video.srcObject.getTracks()[0].stop(),this.run=!1},this.update=function(){var e=this,t=Date.now(),i=function(){if(e.run){var n=Date.now()-t;e.callback(e.video,n),t=Date.now(),requestAnimationFrame(i)}};requestAnimationFrame(i)}}pico.unpack_cascade=function(e){const t=new DataView(new ArrayBuffer(4));let i=8;t.setUint8(0,e[i+0]),t.setUint8(1,e[i+1]),t.setUint8(2,e[i+2]),t.setUint8(3,e[i+3]);const n=t.getInt32(0,!0);i+=4,t.setUint8(0,e[i+0]),t.setUint8(1,e[i+1]),t.setUint8(2,e[i+2]),t.setUint8(3,e[i+3]);const o=t.getInt32(0,!0);i+=4;const s=[],r=[],a=[];for(let l=0;l<o;++l){Array.prototype.push.apply(s,[0,0,0,0]),Array.prototype.push.apply(s,e.slice(i,i+4*Math.pow(2,n)-4)),i=i+4*Math.pow(2,n)-4;for(let o=0;o<Math.pow(2,n);++o)t.setUint8(0,e[i+0]),t.setUint8(1,e[i+1]),t.setUint8(2,e[i+2]),t.setUint8(3,e[i+3]),r.push(t.getFloat32(0,!0)),i+=4;t.setUint8(0,e[i+0]),t.setUint8(1,e[i+1]),t.setUint8(2,e[i+2]),t.setUint8(3,e[i+3]),a.push(t.getFloat32(0,!0)),i+=4}const l=new Int8Array(s),c=new Float32Array(r),h=new Float32Array(a);return function(e,t,i,s,r){e*=256,t*=256;let a=0,d=0;const u=Math.pow(2,n)>>0;for(let p=0;p<o;++p){let o=1;for(let c=0;c<n;++c)o=2*o+(s[(e+l[a+4*o+0]*i>>8)*r+(t+l[a+4*o+1]*i>>8)]<=s[(e+l[a+4*o+2]*i>>8)*r+(t+l[a+4*o+3]*i>>8)]);if((d+=c[u*p+o-u])<=h[p])return-1;a+=4*u}return d-h[o-1]}},pico.run_cascade=function(e,t,i){const n=e.pixels,o=e.nrows,s=e.ncols,r=e.ldim,a=i.shiftfactor,l=i.minsize,c=i.maxsize,h=i.scalefactor;let d=l;const u=[];for(;d<=c;){const e=Math.max(a*d,1)>>0,i=d/2+1>>0;for(let a=i;a<=o-i;a+=e)for(let o=i;o<=s-i;o+=e){const e=t(a,o,d,n,r);e>0&&u.push([a,o,d,e])}d*=h}return u},pico.cluster_detections=function(e,t){function i(e,t){const i=e[0],n=e[1],o=e[2],s=t[0],r=t[1],a=t[2],l=Math.max(0,Math.min(i+o/2,s+a/2)-Math.max(i-o/2,s-a/2)),c=Math.max(0,Math.min(n+o/2,r+a/2)-Math.max(n-o/2,r-a/2));return l*c/(o*o+a*a-l*c)}e=e.sort(function(e,t){return t[3]-e[3]});const n=new Array(e.length).fill(0),o=[];for(let s=0;s<e.length;++s)if(0==n[s]){let r=0,a=0,l=0,c=0,h=0;for(let o=s;o<e.length;++o)i(e[s],e[o])>t&&(n[o]=1,r+=e[o][0],a+=e[o][1],l+=e[o][2],c+=e[o][3],h+=1);o.push([r/h,a/h,l/h,c])}return o},pico.instantiate_detection_memory=function(e){let t=0;const i=[];for(let t=0;t<e;++t)i.push([]);return function(e){i[t]=e,t=(t+1)%i.length,e=[];for(let t=0;t<i.length;++t)e=e.concat(i[t]);return e}};const domContainerId="faceRecognizeDomContainer",videoId="faceRecognizeVideo",canvasId="faceRecognizeCanvas",catchSize={w:640,h:480},cascadeurl="https://raw.githubusercontent.com/nenadmarkus/pico/c2e81f9d23cc11d1a612fd21e4f9de0921a5d0d9/rnt/cascades/facefinder";let update_memory=pico.instantiate_detection_memory(5),facefinder_classify_region=function(e,t,i,n,o){return-1};const eventType$3={readyStart:"readyStart",start:"start",stop:"stop",ready:"ready",error:"error"};class FaceRecognizeServer extends BaseServer{constructor(){super("faceRecognize"),this._pico=pico,this._faceRecognizeDomContainer=null,this._video=null,this._canvas=null,this.flag=!1}get isStart(){return this.callState("isStart")}set isStart(e){return this.callMutation("setIsStart",e)}get faceCount(){return this.callState("faceCount")}set faceCount(e){this.callMutation("setFaceCount",e)}init(e){let t=this._extractConfig(e);this._initDom(),t.isStart?this.start():this.stop()}readyStart(){this.dispatchEvent({type:eventType$3.readyStart})}start(){this.flag&&this.isStart||(this._canvas?(fetch(cascadeurl).then(e=>{e.arrayBuffer().then(e=>{this.addInfo("人脸识别启动"),this.dispatchEvent({type:eventType$3.start}),this.isStart=!0,this.flag=this.isStart;var t=new Int8Array(e);facefinder_classify_region=this._pico.unpack_cascade(t)})}).catch(e=>{this.addError("网络错误，请确保连接到远程服务器。"),this.dispatchEvent({type:eventType$3.error})}),this._ctx=this._canvas.getContext("2d"),this._mycamvas=new camvas(this._ctx,this._video,this._processfn.bind(this),e=>{this.addError("无法启动摄像头，请确认已连接摄像头。"),this.dispatchEvent({type:eventType$3.error})})):this.addError("canvas is null"))}stop(){!this.flag&&this.isStart||(this._mycamvas&&this._mycamvas.stop(),this.dispatchEvent({type:eventType$3.stop}),this.addInfo("人脸识别停止"),this.isStart=!1,this.flag=this.isStart)}_initDom(){this._faceRecognizeDomContainer||(this._faceRecognizeDomContainer=document.createElement("div"),this._faceRecognizeDomContainer.id=domContainerId,this._faceRecognizeDomContainer.style="display:none",this._initVideo(),this._initCanvas(),document.body.appendChild(this._faceRecognizeDomContainer))}_initVideo(){this._video||(this._video=document.createElement("video"),this._video.id=videoId,this._video.width=catchSize.w,this._video.height=catchSize.h,this._faceRecognizeDomContainer.appendChild(this._video))}_initCanvas(){this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.id=canvasId,this._canvas.width=catchSize.w,this._canvas.height=catchSize.h,this._faceRecognizeDomContainer.appendChild(this._canvas))}_processfn(e,t){this._ctx.drawImage(e,0,0);var i=this._ctx.getImageData(0,0,640,480).data;let n={pixels:this._rgba_to_grayscale(i,480,640),nrows:480,ncols:640,ldim:640};var o=this._pico.run_cascade(n,facefinder_classify_region,{shiftfactor:.1,minsize:80,maxsize:1e3,scalefactor:1.1});o=update_memory(o),o=this._pico.cluster_detections(o,.2),this.faceCount=0;for(let e=0;e<o.length;++e)o[e][3]>50&&(this._ctx.beginPath(),this._ctx.arc(o[e][1],o[e][0],o[e][2]/2,0,2*Math.PI,!1),this._ctx.lineWidth=3,this._ctx.strokeStyle="red",this._ctx.stroke(),this.faceCount++)}_rgba_to_grayscale(e,t,i){for(var n=new Uint8Array(t*i),o=0;o<t;++o)for(var s=0;s<i;++s)n[o*i+s]=(2*e[4*o*i+4*s+0]+7*e[4*o*i+4*s+1]+1*e[4*o*i+4*s+2])/10;return n}}const faceRecognizeServer=new FaceRecognizeServer;
/*
 * @name: gest.js
 * @description: gest.js is a webcam based gesture recognition library that helps developers make webpages more immersive
 * @version: 0.5.0
 * @author: Hadi Michael (http://hadi.io)
 * @acknowledgements: gest.js is an extension of work started by William Wu (https://github.com/wvvvw)
 * @license: MIT License
	The MIT License (MIT)
	Copyright (c) 2013-2014 Hadi Michael (http://hadi.io)
	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:
	The above copyright notice and this permission notice shall be included in
	all copies or substantial portions of the Software.
	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	THE SOFTWARE.
*/window.gest=function(e){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var t,i,n,o,s={framerate:25,videoCompressionRate:4,sensitivity:80,skinFilter:!1,debug:{state:!1,canvas:null,context:null},timer:null},r=!1,a=!1,l=function(){if(l.prototype._singletonInstance)return l.prototype._singletonInstance;function t(){return f.removeEventListener("DOMContentLoaded",document,t),f.removeEventListener("load",e,t),h()&&(r=!0),!(!a||!r)&&e.gest.start()}return l.prototype._singletonInstance=this,"complete"===document.readyState?t.call():(f.addEventListener("DOMContentLoaded",document,t),f.addEventListener("load",e,t)),!0},c=function(e){var t=f.createCustomEvent("gest",document);t.direction=e.direction||null,t.up=e.up||!1,t.down=e.down||!1,t.left=e.left||!1,t.right=e.right||!1,t.error=e.error||null,f.fireEvent(t)},h=function(){return i=document.createElement("video"),n=document.createElement("canvas"),i.canPlayType&&n.getContext&&n.getContext("2d")&&navigator.getUserMedia?(i.width=300,i.height=225,i.setAttribute("style","visibility: hidden;"),document.body.appendChild(i),n.setAttribute("style","width: 300px; display: none;"),document.body.appendChild(n),o=n.getContext("2d"),!0):(d(0),!1)},d=function(e,t){var i;switch(e){case 0:i={code:e,message:"gest.js can't run in your browser :("};break;case 1:i={code:e,message:"gest.js could not start."};break;case 2:i={code:e,message:"gest.js has already started."};break;case 10:i={code:e,message:"DEEENIED! gest.js needs webcam access.",obj:t};break;case 11:i={code:e,message:"A constraint specified is not supported by the web-browser.",obj:t};break;case 12:i={code:e,message:"No media tracks of the type specified in the constraints are found.",obj:t};break;case 13:i={code:e,message:"Couldn't get access to webcam.",obj:t};break;default:i=null}s.debug.state&&console.error(i.message),c({error:i})},u={huemin:0,huemax:.1,satmin:.3,satmax:1,valmin:.4,valmax:1,rgb2hsv:function(e,t,i){e/=255,t/=255,i/=255;var n,o,s=Math.max(e,t,i),r=Math.min(e,t,i),a=s,l=s-r;if(o=0===s?0:l/s,s==r)n=0;else{switch(s){case e:n=(t-i)/l+(t<i?6:0);break;case t:n=(i-e)/l+2;break;case i:n=(e-t)/l+4}n/=6}return[n,o,a]},apply:function(e){for(var t=4*(e.width*e.height),i=0,n=0;n<e.height;n++)for(var o=0;o<e.width;o++){t=o+n*e.width;var s=e.data[i],r=e.data[i+1],a=e.data[i+2],l=e.data[i+3],c=this.rgb2hsv(s,r,a);(c[0]>this.huemin&&c[0]<this.huemax||c[0]>.59&&c[0]<1)&&c[1]>this.satmin&&c[1]<this.satmax&&c[2]>this.valmin&&c[2]<this.valmax?(e[i]=s,e[i+1]=r,e[i+2]=a,e[i+3]=l):(e.data[i]=255,e.data[i+1]=255,e.data[i+2]=255,e.data[i+3]=0),i=4*t}return e}},p={priorFrame:!1,get:function(e,t,i,n){var r=o.createImageData(i,n),a=0,l=0,c=0;if(!1!==this.priorFrame)for(var h=4*(r.width*r.height);(h-=4)>=0;){Math.abs(e.data[h]-this.priorFrame.data[h])+Math.abs(e.data[h+1]-this.priorFrame.data[h+1])+Math.abs(e.data[h+2]-this.priorFrame.data[h+2])>768*Math.abs((t-100)/100)?(r.data[h]=255,r.data[h+1]=0,r.data[h+2]=0,r.data[h+3]=255,c+=1,a+=h/4%r.width,l+=Math.floor(h/4/r.height)):(r.data[h]=e.data[h],r.data[h+1]=e.data[h+1],r.data[h+2]=e.data[h+2],r.data[h+3]=e.data[h+3])}c>0&&(g.search({x:a,y:l,d:c}),s.debug.state&&s.debug.context.putImageData&&(s.debug.canvas.width=i,s.debug.canvas.height=n,s.debug.context.putImageData(r,0,0))),this.priorFrame=e}},g={prior:!1,filteringFactor:.9,filteredTotal:0,minTotalChange:300,minDirChange:2,longDirChange:7,state:0,search:function(e){var t={x:e.x/e.d,y:e.y/e.d,d:e.d};this.filteredTotal=this.filteringFactor*this.filteredTotal+(1-this.filteringFactor)*t.d;var i=t.d-this.filteredTotal>this.minTotalChange;switch(this.state){case 0:i&&(this.state=1,g.prior=t);break;case 1:this.state=2;var n=t.x-g.prior.x,o=t.y-g.prior.y,s=Math.abs(o)<Math.abs(n);n<-this.minDirChange&&s?c({direction:"Right",right:!0}):n>this.minDirChange&&s&&c({direction:"Left",left:!0}),o>this.minDirChange&&!s?Math.abs(o)>this.longDirChange?c({direction:"Long down",down:!0}):c({direction:"Down",down:!0}):o<-this.minDirChange&&!s&&(Math.abs(o)>this.longDirChange?c({direction:"Long up",up:!0}):c({direction:"Up",up:!0}));break;case 2:i||(this.state=0)}}},f={htmlEvents:{onload:1,onunload:1,onblur:1,onchange:1,onfocus:1,onreset:1,onselect:1,onsubmit:1,onabort:1,onkeydown:1,onkeypress:1,onkeyup:1,onclick:1,ondblclick:1,onmousedown:1,onmousemove:1,onmouseout:1,onmouseover:1,onmouseup:1},addEventListener:function(e,t,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&this.htmlEvents["on"+e]?t.attachEvent("on"+e,i):t["on"+e]=i},removeEventListener:function(e,t,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&this.htmlEvents["on"+e]?t.detachEvent("on"+e,i):t["on"+e]=null},createCustomEvent:function(e,t){try{var i;return t.createEvent?(i=t.createEvent("Event")).initEvent(e,!0,!0):t.createEventObject&&((i=t.createEventObject()).eventType=e),i.evntName=e,i.evntElement=t,i}catch(e){return console.error(e),!1}},fireEvent:function(e){try{e.evntElement.dispatchEvent?e.evntElement.dispatchEvent(e):e.evntElement.fireEvent&&this.htmlEvents["on"+e.evntName]?e.evntElement.fireEvent("on"+e.eventType,e):e.evntElement[e.evntName]?e.evntElement[e.evntName]():e.evntElement["on"+e.evntName]&&e.evntElement["on"+e.evntName]()}catch(e){console.error(e)}}};return l.prototype.videoUsable=function(e){t=e,i.srcObject=t,f.addEventListener("canplaythrough",i,function(){i.play(),f.addEventListener("playing",i,function(){var e=Math.floor(i.getBoundingClientRect().width/s.videoCompressionRate),t=Math.floor(i.getBoundingClientRect().height/s.videoCompressionRate);n.width=e,n.height=t,s.timer=setInterval(function(){!function(e,t){try{o.drawImage(i,0,0,e,t);var n=o.getImageData(0,0,e,t);s.skinFilter?p.get(u.apply(n),s.sensitivity,e,t):p.get(n,s.sensitivity,e,t)}catch(e){if("NS_ERROR_NOT_AVAILABLE"===e.name)return!1;throw e}}(e,t)},1e3/s.framerate)})})},l.prototype.start=function(){return a=!0,!!r&&!!i},l.prototype.stop=function(){return s.timer&&clearInterval(s.timer),!(!r||!a)&&(i&&(i.src=""),!!t&&!!t.getTracks()[0].stop())},l.prototype.options={subscribeWithCallback:function(e){e&&f.addEventListener("gest",document,function(t){e(t)})},sensitivity:function(e){s.sensitivity=e>=100?100:e<=0?0:e},debug:function(e){return s.debug.state=e,e?(s.debug.canvas=document.createElement("canvas"),s.debug.canvas.setAttribute("style","width: 100%; height: 100%; display: block; position: absolute; top: 0; left: 0;"),document.body.appendChild(s.debug.canvas),s.debug.context=s.debug.canvas.getContext("2d")):(s.debug.canvas.setAttribute("style","display: none;"),s.debug.canvas.parentNode.removeChild(s.debug.canvas)),s.debug},skinFilter:function(e){s.skinFilter=e}},new l}(window);const eventType$4={readyStart:"readyStart",start:"start",stop:"stop",ready:"ready",gestureMatch:"gestureMatch",error:"error"};class GestureRecognizeServer extends BaseServer{constructor(){super("gestureRecognize"),this.gest=gest,this.flag=!1,gest.options.sensitivity(80),gest.options.subscribeWithCallback(e=>{this.dispatchEvent({type:eventType$4.gestureMatch,result:e}),this.addInfo("识别动作:"+e.direction)})}get isStart(){return this.callState("isStart")}set isStart(e){return this.callMutation("setIsStart",e)}init(e){this._extractConfig(e).isStart?this.start():this.stop()}readyStart(){this.dispatchEvent({type:eventType$4.readyStart})}start(){if(this.flag&&this.isStart)return;gest.start()&&this.checkVideo().then(e=>{gest.videoUsable(e),this.isStart=!0,this.flag=this.isStart,this.addInfo("手势识别启动"),this.dispatchEvent({type:eventType$4.start})}).catch(e=>{this.dispatchEvent({type:eventType$4.error})})}stop(){!this.flag&&this.isStart||(this.gest.stop(),this.isStart=!1,this.flag=this.isStart,this.dispatchEvent({type:eventType$4.stop}),this.addInfo("手势识别停止"))}}const gestureRecognizeServer=new GestureRecognizeServer;
/*
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 * @license
 */var CanvasImage=function(e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=e.width,this.height=this.canvas.height=e.height,this.context.drawImage(e,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(e){this.context.putImageData(e,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};
/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 * @license
 */
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 * @license
 */
if(ColorThief.prototype.getColor=function(e,t){return this.getPalette(e,5,t)[0]},ColorThief.prototype.getPalette=function(e,t,i){(void 0===t||t<2||t>256)&&(t=10),(void 0===i||i<1)&&(i=10);for(var n,o,s,r,a=new CanvasImage(e),l=a.getImageData().data,c=a.getPixelCount(),h=[],d=0;d<c;d+=i)o=l[(n=4*d)+0],s=l[n+1],r=l[n+2],l[n+3]>=125&&(o>250&&s>250&&r>250||h.push([o,s,r]));var u=MMCQ.quantize(h,t),p=u?u.palette():null;return a.removeCanvas(),p},ColorThief.prototype.getColorFromUrl=function(e,t,i){sourceImage=document.createElement("img");var n=this;sourceImage.addEventListener("load",function(){var o=n.getPalette(sourceImage,5,i)[0];t(o,e)}),sourceImage.src=e},ColorThief.prototype.getImageData=function(e,t){xhr=new XMLHttpRequest,xhr.open("GET",e,!0),xhr.responseType="arraybuffer",xhr.onload=function(e){if(200==this.status){uInt8Array=new Uint8Array(this.response),i=uInt8Array.length,binaryString=new Array(i);for(var i=0;i<uInt8Array.length;i++)binaryString[i]=String.fromCharCode(uInt8Array[i]);data=binaryString.join(""),base64=window.btoa(data),t("data:image/png;base64,"+base64)}},xhr.send()},ColorThief.prototype.getColorAsync=function(e,t,i){var n=this;this.getImageData(e,function(e){sourceImage=document.createElement("img"),sourceImage.addEventListener("load",function(){var e=n.getPalette(sourceImage,5,i)[0];t(e,this)}),sourceImage.src=e})},!pv)var pv={map:function(e,t){var i={};return t?e.map(function(e,n){return i.index=n,t.call(i,e)}):e.slice()},naturalOrder:function(e,t){return e<t?-1:e>t?1:0},sum:function(e,t){var i={};return e.reduce(t?function(e,n,o){return i.index=o,e+t.call(i,n)}:function(e,t){return e+t},0)},max:function(e,t){return Math.max.apply(null,t?pv.map(e,t):e)}};var MMCQ=function(){var e=5,t=8-e,i=1e3,n=.75;function o(t,i,n){return(t<<2*e)+(i<<e)+n}function s(e){var t=[],i=!1;function n(){t.sort(e),i=!0}return{push:function(e){t.push(e),i=!1},peek:function(e){return i||n(),void 0===e&&(e=t.length-1),t[e]},pop:function(){return i||n(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return i||n(),t}}}function r(e,t,i,n,o,s,r){this.r1=e,this.r2=t,this.g1=i,this.g2=n,this.b1=o,this.b2=s,this.histo=r}function a(){this.vboxes=new s(function(e,t){return pv.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function l(e,t){if(t.count()){var i=t.r2-t.r1+1,n=t.g2-t.g1+1,s=t.b2-t.b1+1,r=pv.max([i,n,s]);if(1==t.count())return[t.copy()];var a,l,c,h,d=0,u=[],p=[];if(r==i)for(a=t.r1;a<=t.r2;a++){for(h=0,l=t.g1;l<=t.g2;l++)for(c=t.b1;c<=t.b2;c++)h+=e[o(a,l,c)]||0;d+=h,u[a]=d}else if(r==n)for(a=t.g1;a<=t.g2;a++){for(h=0,l=t.r1;l<=t.r2;l++)for(c=t.b1;c<=t.b2;c++)h+=e[o(l,a,c)]||0;d+=h,u[a]=d}else for(a=t.b1;a<=t.b2;a++){for(h=0,l=t.r1;l<=t.r2;l++)for(c=t.g1;c<=t.g2;c++)h+=e[o(l,c,a)]||0;d+=h,u[a]=d}return u.forEach(function(e,t){p[t]=d-e}),g(r==i?"r":r==n?"g":"b")}function g(e){var i,n,o,s,r,l=e+"1",c=e+"2",h=0;for(a=t[l];a<=t[c];a++)if(u[a]>d/2){for(o=t.copy(),s=t.copy(),r=(i=a-t[l])<=(n=t[c]-a)?Math.min(t[c]-1,~~(a+n/2)):Math.max(t[l],~~(a-1-i/2));!u[r];)r++;for(h=p[r];!h&&u[r-1];)h=p[--r];return o[c]=r,s[l]=o[c]+1,[o,s]}}}return r.prototype={volume:function(e){return this._volume&&!e||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(e){var t=this.histo;if(!this._count_set||e){var i,n,s,r=0;for(i=this.r1;i<=this.r2;i++)for(n=this.g1;n<=this.g2;n++)for(s=this.b1;s<=this.b2;s++)r+=t[o(i,n,s)]||0;this._count=r,this._count_set=!0}return this._count},copy:function(){return new r(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(t){var i=this.histo;if(!this._avg||t){var n,s,r,a,l=0,c=1<<8-e,h=0,d=0,u=0;for(s=this.r1;s<=this.r2;s++)for(r=this.g1;r<=this.g2;r++)for(a=this.b1;a<=this.b2;a++)l+=n=i[o(s,r,a)]||0,h+=n*(s+.5)*c,d+=n*(r+.5)*c,u+=n*(a+.5)*c;this._avg=l?[~~(h/l),~~(d/l),~~(u/l)]:[~~(c*(this.r1+this.r2+1)/2),~~(c*(this.g1+this.g2+1)/2),~~(c*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(e){var i=e[0]>>t,n=e[1]>>t,o=e[2]>>t;return i>=this.r1&&i<=this.r2&&n>=this.g1&&n<=this.g2&&o>=this.b1&&o<=this.b2}},a.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,i=0;i<t.size();i++)if(t.peek(i).vbox.contains(e))return t.peek(i).color;return this.nearest(e)},nearest:function(e){for(var t,i,n,o=this.vboxes,s=0;s<o.size();s++)((i=Math.sqrt(Math.pow(e[0]-o.peek(s).color[0],2)+Math.pow(e[1]-o.peek(s).color[1],2)+Math.pow(e[2]-o.peek(s).color[2],2)))<t||void 0===t)&&(t=i,n=o.peek(s).color);return n},forcebw:function(){var e=this.vboxes;e.sort(function(e,t){return pv.naturalOrder(pv.sum(e.color),pv.sum(t.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var i=e.length-1,n=e[i].color;n[0]>251&&n[1]>251&&n[2]>251&&(e[i].color=[255,255,255])}},{quantize:function(c,h){if(!c.length||h<2||h>256)return!1;var d=function(i){var n,s,r,a,l=new Array(1<<3*e);return i.forEach(function(e){s=e[0]>>t,r=e[1]>>t,a=e[2]>>t,n=o(s,r,a),l[n]=(l[n]||0)+1}),l}(c);d.forEach(function(){});var u=function(e,i){var n,o,s,a=1e6,l=0,c=1e6,h=0,d=1e6,u=0;return e.forEach(function(e){n=e[0]>>t,o=e[1]>>t,s=e[2]>>t,n<a?a=n:n>l&&(l=n),o<c?c=o:o>h&&(h=o),s<d?d=s:s>u&&(u=s)}),new r(a,l,c,h,d,u,i)}(c,d),p=new s(function(e,t){return pv.naturalOrder(e.count(),t.count())});function g(e,t){for(var n,o=1,s=0;s<i;)if((n=e.pop()).count()){var r=l(d,n),a=r[0],c=r[1];if(!a)return;if(e.push(a),c&&(e.push(c),o++),o>=t)return;if(s++>i)return}else e.push(n),s++}p.push(u),g(p,n*h);for(var f=new s(function(e,t){return pv.naturalOrder(e.count()*e.volume(),t.count()*t.volume())});p.size();)f.push(p.pop());g(f,h-f.size());for(var m=new a;f.size();)m.push(f.pop());return m}}}();const domContainerId$1="lightSensorDomContainer",videoId$1="lightSensorVideo",canvasId$1="lightSensorCanvas",imgId="lightSensorImg",catchSize$1={w:100,h:100},eventType$5={readyStart:"readyStart",start:"start",stop:"stop",lightChange:"lightChange",error:"error"};class LightSensorServer extends BaseServer{constructor(){super("lightSensor"),this.flag=!1}get isStart(){return this.callState("isStart")}set isStart(e){this.callMutation("setIsStart",e)}get isBrightness(){return this.callState("isBrightness")}set isBrightness(e){this.callMutation("setIsBrightness",e)}get isHue(){return this.callState("isHue")}set isHue(e){this.callMutation("setIsHue",e)}get intervalTime(){return this.callState("intervalTime")}set intervalTime(e){this.callMutation("setIntervalTime",e)}get lightColor(){return this.callState("lightColor")}set lightColor(e){this.callMutation("setLightColor",e)}init(e){let t=this._extractConfig(e);this.isStart=t.isStart,this.isHue=t.isHue,this.isBrightness=t.isBrightness,this.intervalTime=t.intervalTime,this._initDom()}readyStart(){this.dispatchEvent({type:eventType$5.readyStart})}start(){this.flag&&this.isStart||this.checkVideo().then(e=>{this._video.srcObject=e,this._video.onloadedmetadata=(e=>{this._video.play(),this._taskThread(),this.isStart=!0,this.flag=this.isStart,this.dispatchEvent({type:eventType$5.start}),this.addInfo("光感识别启动")})}).catch(e=>{this.addError(e),this.dispatchEvent({type:eventType$5.error,result:e})})}stop(){!this.flag&&this.isStart||(this._video.srcObject&&this._video.srcObject.getTracks().length>0&&this._video.srcObject.getTracks()[0].stop(),this.isStart=!1,this.flag=this.isStart,clearTimeout(this._taskTimer),this.dispatchEvent({type:eventType$5.stop}),this.addInfo("光感识别停止"))}_initDom(){this._lightSensorDomContainer||(this._lightSensorDomContainer=document.createElement("div"),this._lightSensorDomContainer.id=domContainerId$1,this._lightSensorDomContainer.style="display:none",this._initVideo(),this._initCanvas(),this._initImg(),document.body.appendChild(this._lightSensorDomContainer))}_initVideo(){this._video||(this._video=document.createElement("video"),this._video.id=videoId$1,this._video.width=catchSize$1.w,this._video.height=catchSize$1.h,this._lightSensorDomContainer.appendChild(this._video))}_initCanvas(){this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.id=canvasId$1,this._canvas.width=catchSize$1.w,this._canvas.height=catchSize$1.h,this._lightSensorDomContainer.appendChild(this._canvas))}_initImg(){this._img||(this._img=document.createElement("img"),this._img.id=imgId,this._img.width=catchSize$1.w,this._img.height=catchSize$1.h,this._lightSensorDomContainer.appendChild(this._img))}_taskThread(){this._taskTimer=setTimeout(()=>{this.getColor().then(e=>{this._lightColorIsChange(e)&&(this.lightColor=e,this.dispatchEvent({type:eventType$5.lightChange,result:e})),this._taskThread()})},this.intervalTime||1e3)}getColor(){return new Promise((e,t)=>{this._canvas.getContext("2d").drawImage(this._video,0,0,catchSize$1.w,catchSize$1.h),this._img.src=this._canvas.toDataURL("image/png"),this._img.onload=(()=>{let t=(new ColorThief).getColor(this._img);e(t)}),this._img.onerror=(e=>{t(e)})})}_lightColorIsChange(e){let[t,i,n]=this.lightColor;return!(t===e[0]&&i===e[1]&&n===e[2])}}const lightSensorServer=new LightSensorServer,eventType$6={match:"match"};class HotkeyServer extends BaseServer{constructor(){super("hotkey"),this._items=[]}init(e){}addHotkeys(e){Array.isArray(e)?e.map(e=>{this._add(e)}):this._add(e)}removeHotkey(e){Array.isArray(e)?this._items.map(e=>{this._remove(e.key)}):this._remove(e)}getHotkeys(){return this._items}getScope(){return hotkeys.getScope()}setScope(e){hotkeys.setScope(e)}deleteScope(e){hotkeys.deleteScope(e)}_add(e){this._items.push(e),hotkeys(e.key,e.scope||"all",(t,i)=>(t.preventDefault(),this.getCurrentContext().actionServer.exec(e.action,i),this.dispatchEvent({type:eventType$6.match,result:e}),!1))}_remove(e){this._items.splice(this._items.findIndex(t=>t.key===e),1),hotkeys.unbind(e)}}const hotkeyServer=new HotkeyServer;let Type=function(){let e={};for(let t,i=0;t=["Undefined","Null","Boolean","Number","String","Function","Array","Object"][i++];)!function(t){e["is"+t]=function(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}}(t);return e}();class PartServer extends BaseServer{constructor(){super("part"),this.allComps={},this.currentRoutePath=null}init(e){this.setDragOpt({key:"isDragOpen",val:e&&e.isDragOpen||!1})}get isDragOpen(){return this.callState("isDragOpen")}set isDragOpen(e){this.callMutation("setDragOpt",{key:"isDragOpen",val:e})}getCompByTagName(e){if(!e)return void this.addError("1 argument required, but only 0 present.");if(!this.getCurrentContext())return void this.addError("root do not exist");this._getCurrentAllComps();let t=[];if(0!=(t=this.allComps[this.currentRoutePath].filter(t=>t.$options._componentTag===e)).length)return t;this.addError(`Components labeled ${e} do not exist`)}getCompById(e){if(!e)return void this.addError("1 argument required, but only 0 present.");if(!this.getCurrentContext())return void this.addError("root do not exist");this._getCurrentAllComps();let t=[];if(0!=(t=this.allComps[this.currentRoutePath].filter(t=>t.$el.id===e)).length)return t[0];this.addError(`Components with ID name ${e} do not exist`)}_getAllChildComp(e){let t,i=[];Type.isObject(e)?t=e.$children:Type.isArray(e)&&(t=e);for(let e=0;e<t.length;e++)i.push(t[e]),t[e].$children.length>0&&(i=i.concat(this._getAllChildComp(t[e].$children)));return i}_getCurrentAllComps(){let e=this.getCurrentContext();this.currentRoutePath=e.$router.currentRoute.path,this.allComps[this.currentRoutePath]=this._getAllChildComp(e)}setDragOpt({key:e,val:t}){this.callMutation("setDragOpt",{key:e,val:t})}}let partServer=new PartServer;function judgeMedia$1(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t||console.log("getUserMedia is not implemented in this browser"),new Promise(function(i,n){t.call(navigator,e,i,n)})})}function checkMediaVideo(){return judgeMedia$1(),new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({video:!0}).then(t=>{e("true"),t.getTracks()[0].stop()}).catch(t=>{e("false")})})}function checkMediaAudio(){return judgeMedia$1(),new Promise((e,t)=>{navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{t.getTracks()[0].stop(),e("true")}).catch(t=>{e("false")})})}function performanceMonitor(){let e={},t=window.performance.timing;return e.dnsTimer=((t.domainLookupEnd-t.domainLookupStart)/1e3).toFixed(2),e.parsingDomTimer=((t.domComplete-t.domInteractive)/1e3).toFixed(2),e.whiteScreenTimer=((t.responseStart-t.navigationStart)/1e3).toFixed(2),e.onloadTimer=((t.loadEventStart-t.navigationStart)/1e3).toFixed(2),e.requestConsumingTimer=((t.responseEnd-t.responseStart)/1e3).toFixed(2),e.tcpConnectdTimer=((t.connectEnd-t.connectStart)/1e3).toFixed(2),e.domReadyTimer=((t.domContentLoadedEventEnd-t.navigationStart)/1e3).toFixed(2),e.resourceLoad=((t.loadEventStart-t.domContentLoadedEventEnd)/1e3).toFixed(2),e.navigation={type:0,redirectCount:0},e.navigation.type=window.performance.navigation.type,e.navigation.redirectCount=window.performance.navigation.redirectCount,e}function getFps(){}function getResourceSize(){let e=window.performance.getEntriesByType("resource"),t=0,i=0,n="";return e.forEach((e,i)=>{t+=parseFloat((e.transferSize/1e3).toFixed(1))}),t>1?(i=(t/1e3).toFixed(1),n="MB"):(i=t,n="KB"),{size:i,unit:n,length:e.length}}function displayEffect(e){let t=document.body.clientWidth,i=document.body.clientHeight,n=Math.min(t/e.w,i/e.h);return isNaN(n)&&(n=1),n>1?100:parseFloat(100*n).toFixed(0)}function browserScaleRatio(){var e=0,t=window.screen,i=navigator.userAgent.toLowerCase();return void 0!==window.devicePixelRatio?e=window.devicePixelRatio:~i.indexOf("msie")?t.deviceXDPI&&t.logicalXDPI&&(e=t.deviceXDPI/t.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),e&&(e=Math.round(100*e)),e}function detectionBrowser(){return new Browser}let fireEvent=function(e,t){let i=document.createEvent("Event");i.initEvent(e,!0,!0),i.data=t,window.dispatchEvent(i)};function Network(e={}){let t=null,i=0,n=[],o=0,s=0,r=e;const a=function(e){let r,{loaded:a,timeStamp:l}=e;if(null!==t){let e=8*(a-i),c=l-t;if((r=16===l.toString().length?Math.round(c/1e3)/1e3:Math.round(c)/1e3)<.42)return;!function(e){n.length>=10&&n.shift(),n.push(e)}(e/r/1024/8),function(){let e=n.length;if(!e)return;let t=n.reduce((e,t)=>e+t)/e;o=Math.round(t),s=o<50?1:o<450?2:o<1280?3:4}()}i=a,t=l};this.checkRemoteNetwork=function(e={}){let t=e;return new Promise((e,n)=>{if(!window.navigator.onLine)return console.warn("You seem to be offline."),void n({type:t.type,connected:!1,speed:0,level:0});let r=new XMLHttpRequest;r.timeout=t.timeout||5e3,r.addEventListener("progress",a,!1),r.onreadystatechange=function(){4===r.readyState&&(i=0,200===r.status?e({type:t.type,connected:!0,speed:o,level:s}):n({type:t.type,connected:!1,speed:0,level:0}))},fetch(t.url).then(e=>200===e.status?e.text():{}).catch(e=>{console.log(e)})})};let l=this;this.on=function(e){!function(){!function e(){return l.checkRemoteNetwork(r).then(e=>{fireEvent("connectionStatus",{...e})}).catch(e=>{fireEvent("connectionStatus",{...e})}),e}()}(),window.addEventListener("connectionStatus",e)},this.off=function(e){"function"==typeof e?(window.removeEventListener("connectionStatus",e),clearTimeout(void 0)):console.error("Network: you have to pass in a function")}}function getSpeedWithImg(e,t){return new Promise((i,n)=>{let o=null,s=null,r=document.createElement("img");o=(new Date).getTime(),r.onload=function(e){s=(new Date).getTime(),i(1e3*t/(s-o))},r.src=e+"?t="+(new Date).getTime()}).catch(e=>{reject(0)})}function getNetSpeed(e,t,i){const n=[];for(let o=0;o<i;o++)n.push(getSpeedWithImg(e,t));return Promise.all(n).then(e=>{let t=0;return e.forEach(e=>{t+=e}),t/i}).catch(e=>0)}const eventType$7={onRemoteOpen:"onRemoteOpen",onRemoteClose:"onRemoteClose",systemCheckNetworkSpeed:"systemCheckNetworkSpeed"};class Network$1 extends BaseServer{constructor(){super("env"),this.remoteFlag=!0,this.remote="",this.local="",this.interval=null}init(e){this.remote=e.remote,this.local=e.local,this.network=null,this.networkLevel=e.networkLevel,this.localNetWorkS={type:"local",connected:!0,speed:0,level:0},e.openParams.remote&&this.getRemoteNetwork(),e.openParams.local&&this.setNetWorkOption(),null!=this.interval&&(clearInterval(this.interval),this.interval=null),this.interval=setInterval(()=>{this.setNetWorkOption()},this.local.timeout+this.local.interval)}getRemoteNetwork(){let e=this.remote;this.initNetWork(e)}initNetWork(e){this.networkType=e.type,this.network=new Network(e),this.network.on(this._networkChange.bind(this))}setNetWorkOption(){let e={type:"local",connected:!0,speed:0,level:0};navigator.onLine?this.setNetLevel():(e.connected=!1,this.callMutation("setLocalNetwork",e))}setNetLevel(e){let t={type:"local",connected:!0,speed:0,level:0};t.connected=!0;let i=0,n=this;getNetSpeed(this.local.url,this.local.fileSize,this.local.times).then(o=>{i=o;let s=this.getNetLevel(i);i>1024?(t.speed=(i/1024).toFixed(2),t.unit="MB/S"):(t.speed=i.toFixed(2),t.unit="KB/S"),t.level=s,n.callMutation("setLocalNetwork",t),"systemCheck"==e&&app.envServer.dispatchEvent({type:eventType$7.systemCheckNetworkSpeed,result:t})})}getNetLevel(e){let t=0,i=this.networkLevel;for(let n=0;n<i.length;n++){if(e<i[n].speed){t=i[n].level;break}e>i[4].speed&&(t=5)}return t}offNetWork(){this.network.off(his._networkChange.bind(this))}_networkChange(e){"local"==e.data.type?this.callMutation("setLocalNetwork",e.data):(this.callMutation("setRemoteNetwork",e.data),this.remoteFlag!=e.data.connected&&(e.data.connected?this.dispatchEvent({type:eventType$7.onRemoteOpen}):this.dispatchEvent({type:eventType$7.onRemoteClose}),this.remoteFlag=e.data.connected))}}let network=new Network$1;function weatherInit(e,t){return t&&setInterval(()=>{getWeather(e)},72e5),new Promise((t,i)=>{getWeather(e).then(e=>{t(e)}).catch(e=>{i(e)})})}function getWeather(e){let t="";t=e.ip?`https://api.jisuapi.com/weather/query?appkey=${e.weather.appkey}&ip=${e.ip}`:`https://api.jisuapi.com/weather/query?appkey=${e.weather.appkey}&city=${e.city}`;let i=axios.create({withCredentials:!1});return new Promise((e,n)=>{i.get("https://bird.ioliu.cn/v1/?url="+t).then(t=>{e(t)}).catch(e=>{n(e)})})}function getHardware(){return{GPUInfo:getGPUInfo()}}function getGPUInfo(){return gpu()}function getMemory(){let e={},t=(window.performance.memory.totalJSHeapSize/1024/1024).toFixed(2),i=(window.performance.memory.usedJSHeapSize/1024/1024).toFixed(2);return e.memoryTotalJsHeapSize=t,e.memoryUsedJsHeapSize=i,e}const eventType$8={onLine:"onLine",onOffLine:"offLine",onVideoOpen:"onVideoOpen",onVideoNotOpen:"onVideoNotOpen",onAudioOpen:"onAudioOpen",onAudioNotOpen:"onAudioNotOpen",weatherSuccess:"weatherSuccess",weatherError:"weatherError"};class EnvServer extends BaseServer{constructor(){super("env"),this.remoteFlag=!0,this.params=""}init(e){let t=this._extractConfig(e);this.params=t,this.params.ip=e.bigScreenInfo.ip?e.bigScreenInfo.ip:"",this.remote=t.remote,this.local=t.local,this.browserStandard=t.browserStandard,this.openParams=t.openParams;let i={};i.w=e.pageSize.width,i.h=e.pageSize.height,this.designSize=i;let n=this;document.addEventListener("DOMMouseScroll",function(e){e.ctrlKey&&n.checkBrowserScaleRatio()}),document.addEventListener("keydown",function(e){!e.ctrlKey&&!e.metaKey||"="!==e.key&&"-"!==e.key&&"0"!==e.key||setTimeout(()=>{n.checkBrowserScaleRatio()},200)}),window.addEventListener("online",()=>{this.dispatchEvent({type:eventType$8.onLine}),network.setNetWorkOption()},!0),window.addEventListener("offline",()=>{this.dispatchEvent({type:eventType$8.onOffLine}),network.setNetWorkOption()},!0),this.openParams.browser&&this.checkBrowserInfo(),this.openParams.weather&&this.checkWeather(this.params),this.openParams.video&&this.checkVideo(),this.openParams.audio&&this.checkAudio(),network.init(this.params),this.checkHardware(),this.checkMemory(),this.checkBrowserScaleRatio()}initStatus(){this.openParams.performance&&this.checkPerformance(),this.openParams.performance&&this.checkFps(),this.openParams.performance&&this.checkResource()}get fps(){return this.callState("fps")}get resolution(){return this.callState("resolution")}get browserInfo(){return this.callState("browserInfo")}get localNetwork(){return this.callState("localNetwork")}get remoteNetwork(){return this.callState("remoteNetwork")}get scaleRatio(){return this.callState("scaleRatio")}get designSize(){return this.callState("designSize")}set designSize(e){this.callMutation("setDesignSize",e)}get performance(){return this.callState("performance")}get videoStatus(){return this.callState("videoStatus")}get audioStatus(){return this.callState("audioStatus")}get weather(){return this.callState("weather")}get hardware(){return this.callState("hardware")}get memory(){return this.callState("memory")}set isConnectCapacityServer(e){this.callMutation("setIsConnectCapacityServer",e)}set scaleRatio(e){this.callMutation("setPageScaleRation",e)}get level(){return this.callState("level")}set level(e){this.callMutation("setLevel",e)}setNetWorkOption(e){network.setNetLevel(e)}checkVideo(e){checkMediaVideo().then(t=>{t?this.dispatchEvent({type:eventType$8.onVideoOpen,result:e}):(this.callMutation("setVideoStatus",!1),this.dispatchEvent({type:eventType$8.onVideoNotOpen}))})}checkAudio(e){checkMediaAudio().then(t=>{t?this.dispatchEvent({type:eventType$8.onAudioOpen,result:e}):(this.callMutation("setAudioStatus",!1),this.dispatchEvent({type:eventType$8.onAudioNotOpen}))})}checkBrowserInfo(){let e=detectionBrowser();this.callMutation("setBrowser",e)}displayResize(){let e=displayEffect(this.designSize);this.callMutation("setDisplayEffect",e)}checkPerformance(){let e=performanceMonitor();this.callMutation("setPerformance",e)}checkFps(){return getFps()}checkResource(){let e=getResourceSize();this.callMutation("setResourceSize",e)}checkWeather(e){weatherInit(e).then(e=>{this.callMutation("setWeather",e.data.result),this.dispatchEvent({type:eventType$8.weatherSuccess})}).catch(e=>{this.dispatchEvent({type:eventType$8.weatherError})})}checkHardware(){let e=getHardware();this.callMutation("setHardware",e)}checkMemory(){let e=getMemory();this.callMutation("setMemory",e)}checkBrowserScaleRatio(){let e=browserScaleRatio();this.callMutation("setBrowserScaleRatio",e)}getNetLevel(e){return network.getNetLevel(e)}}let envServer=new EnvServer;class LanguageServer extends BaseServer{constructor(){super("language")}init(e){this.callMutation("setOption",e.options),this.callMutation("setLang",e.lang)}get lang(){return this.callState("lang")}set lang(e){this.callMutation("setLang",e)}setLang(e){this.lang!=e&&(this.lang=e,this.addInfo(e))}next(){const e=this.getState(),t=e.lang,i=e.langOption.length,n=e.langOption;let o=n.findIndex(e=>e.value===t);++o<=i-1?this.setLang(n[o].value):this.setLang(n[0].value)}prev(){const e=this.getState(),t=e.lang,i=e.langOption.length,n=e.langOption;let o=n.findIndex(e=>e.value===t);--o>=0?this.setLang(n[o].value):this.setLang(n[i-1].value)}}const languageServer=new LanguageServer;
/*
 VERSION: 0.17.0
 DATE: 2019-02-07
 UPDATES AND DOCS AT: http://greensock.com
 Requires TweenLite and CSSPlugin version 1.17.0 or later (TweenMax contains both TweenLite and CSSPlugin). ThrowPropsPlugin is required for momentum-based continuation of movement after the mouse/touch is released (ThrowPropsPlugin is a membership benefit of Club GreenSock - http://greensock.com/club/).
 @license Copyright (c) 2008-2019, GreenSock. All rights reserved.
 This work is subject to the terms at http://greensock.com/standard-license or for
 Club GreenSock members, the software agreement that was issued with your membership.
 @author: Jack Doyle, jack@greensock.com
*/var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){_gsScope._gsDefine("GSDevTools","TweenLite core.Animation core.SimpleTimeline TimelineLite utils.Draggable plugins.CSSPlugin".split(" "),function(e,t,i,n,o){var s,r,a,l,c,h=document,d=h.documentElement,u=0,p={},g=function(e,t,i){var n=h.createElementNS?h.createElementNS("svg"===e?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",e):h.createElement(e);return t&&("string"==typeof t&&(t=h.querySelector(t)),t.appendChild(n)),"svg"===e&&(n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xhtml")),i&&(n.style.cssText=i),n},f=function(){h.selection?h.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},m=t._rootTimeline,v=function(t,i){for(var n=[],o=0,s=t._first;s;)s instanceof e?s.vars.id&&(n[o++]=s):(i&&s.vars.id&&(n[o++]=s),o=(n=n.concat(v(s,i))).length),s=s._next;return n},y=function(e,t){var i=0,n=Math.max(0,e._repeat),o=e._first;for(o||(i=e.duration());o;)i=Math.max(i,999<o.totalDuration()?o.endTime(!1):o._startTime+o._totalDuration/o._timeScale),o=o._next;return!t&&n?i*(n+1)+e._repeatDelay*n:i},w=function(e){if(!e)return null;if(e instanceof t)return e;for(var i=v(m,!0),n=i.length;-1<--n;)if(i[n].vars.id===e)return i[n]},S=function(e,t,i,n){if("string"==typeof e)if("="===e.charAt(1)){var o=parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2));0>o&&0===n&&(n=100),e=n/100*t.duration()+o}else if(isNaN(e)&&t.getLabelTime&&-1!==t.getLabelTime(e))e=t.getLabelTime(e);else if(t===C&&(0<(n=e.indexOf("="))?(o=parseInt(e.charAt(n-1)+"1",10)*parseFloat(e.substr(n+1)),e=e.substr(0,n-1)):o=0,n=w(e))){if(e=(e=i/100*n.duration())||0,n.timeline)for(;n.timeline.timeline;)e=e/n._timeScale+n._startTime,n=n.timeline;e+=o}return e=isNaN(e)?i:parseFloat(e),Math.min(100,Math.max(0,e/t.duration()*100))},b=function(t,i,n){s||(g("style",d).innerHTML=".gs-dev-tools{height:51px;bottom:0;left:0;right:0;display:block;position:fixed;overflow:visible;padding:0}.gs-dev-tools *{box-sizing:content-box;visibility:visible}.gs-dev-tools .gs-top{position:relative;z-index:499}.gs-dev-tools .gs-bottom{display:flex;align-items:center;justify-content:space-between;background-color:rgba(0, 0, 0, .6);height:42px;border-top:1px solid #2a3334;position:relative}.gs-dev-tools .timeline{position:relative;height:8px;margin-left:15px;margin-right:15px;overflow:visible}.gs-dev-tools .progress-bar,.gs-dev-tools .timeline-track{height:8px;width:100%;position:absolute;top:0;left:0}.gs-dev-tools .timeline-track{background-color:#2a3334;opacity:.6}.gs-dev-tools .progress-bar{background-color:#44cbd7;height:8px;top:0;width:0;pointer-events:none}.gs-dev-tools .seek-bar{width:100%;position:absolute;height:24px;top:-12px;left:0;background-color:transparent}.gs-dev-tools .in-point,.gs-dev-tools .out-point{width:15px;height:26px;position:absolute;top:-18px}.gs-dev-tools .in-point-shape{fill:none;stroke:#44cbd7;stroke-width:1}.gs-dev-tools .out-point-shape{fill:none;stroke:#44cbd7;stroke-width:1}.gs-dev-tools .in-point{transform:translateX(-100%)}.gs-dev-tools .out-point{left:100%}.gs-dev-tools .grab{stroke:#40a9ff;stroke-width:1}.gs-dev-tools .playhead{position:absolute;top:-5px;transform:translate(-50%, 0);left:0;border-radius:50%;width:16px;height:16px;background-color:#44cbd7}.gs-dev-tools .gs-btn-white{fill:#fff}.gs-dev-tools .pause{opacity:0}.gs-dev-tools .select-animation{vertical-align:middle;position:relative;padding:6px 10px}.gs-dev-tools .select-animation-container{flex-grow:4;width:40%}.gs-dev-tools .select-arrow{display:inline-block;width:12px;height:7px;margin:0 7px;transform:translate(0, -2px)}.gs-dev-tools .select-arrow-shape{stroke:rgba(255, 255, 255, .6);stroke-width:2px;fill:none}.gs-dev-tools .rewind{height:16px;width:19px;padding:10px 4px;min-width:24px}.gs-dev-tools .rewind-path{opacity:.6}.gs-dev-tools .play-pause{width:24px;height:24px;padding:6px 10px;min-width:24px}.gs-dev-tools .ease{width:30px;height:30px;padding:10px;min-width:30px;display:none}.gs-dev-tools .ease-path{fill:none;stroke:rgba(255, 255, 255, .6);stroke-width:2px}.gs-dev-tools .ease-border{fill:rgba(255, 255, 255, .25)}.gs-dev-tools .time-scale{font-family:monospace;font-size:18px;text-align:center;color:rgba(255, 255, 255, .6);padding:4px 4px 4px 0;min-width:30px;margin-left:7px}.gs-dev-tools .loop{width:20px;padding:5px;min-width:20px}.gs-dev-tools .loop-path{fill:rgba(255, 255, 255, .6)}.gs-dev-tools label span{color:#fff;font-family:monospace;text-decoration:none;font-size:16px;line-height:18px}.gs-dev-tools .time-scale span{color:rgba(255, 255, 255, .6)}.gs-dev-tools button:focus,.gs-dev-tools select:focus{outline:0}.gs-dev-tools label{position:relative;cursor:pointer}.gs-dev-tools label.locked{text-decoration:none;cursor:auto}.gs-dev-tools label input,.gs-dev-tools label select{position:absolute;left:0;top:0;z-index:1;font:inherit;font-size:inherit;line-height:inherit;height:100%;width:100%;color:#000!important;opacity:0;background:0;border:none;padding:0;margin:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer}.gs-dev-tools label input+.display{position:relative;z-index:2}.gs-dev-tools .gs-bottom-right{vertical-align:middle;display:flex;align-items:center;flex-grow:4;width:40%;justify-content:flex-end}.gs-dev-tools .time-container{font-size:20px;font-family:DS-DIGI;color:#44cbd7;margin:0 5px;font-weight:700}.gs-dev-tools .logo{width:32px;height:32px;position:relative;top:2px;margin:0 12px}.gs-dev-tools .gs-hit-area{background-color:transparent;width:100%;height:100%;top:0;position:absolute}.gs-dev-tools.minimal{height:auto;display:flex;align-items:stretch}.gs-dev-tools.minimal .gs-top{order:2;flex-grow:4;background-color:rgba(0, 0, 0, 1)}.gs-dev-tools.minimal .gs-bottom{background-color:rgba(0, 0, 0, 1);border-top:none}.gs-dev-tools.minimal .timeline{top:50%;transform:translate(0, -50%)}.gs-dev-tools.minimal .in-point,.gs-dev-tools.minimal .out-point{display:none}.gs-dev-tools.minimal .select-animation-container{display:none}.gs-dev-tools.minimal .rewind{display:none}.gs-dev-tools.minimal .play-pause{width:20px;height:20px;padding:4px 6px;margin-left:14px}.gs-dev-tools.minimal .time-scale{min-width:26px}.gs-dev-tools.minimal .loop{width:18px;min-width:18px;display:none}.gs-dev-tools.minimal .gs-bottom-right{display:none}@media only screen and (max-width:600px){.gs-dev-tools{height:auto;display:flex;align-items:stretch}.gs-dev-tools .gs-top{order:2;flex-grow:4;background-color:rgba(0, 0, 0, 1);height:42px}.gs-dev-tools .gs-bottom{background-color:rgba(0, 0, 0, 1);border-top:none}.gs-dev-tools .timeline{top:50%;transform:translate(0, -50%)}.gs-dev-tools .in-point,.gs-dev-tools .out-point{display:none}.gs-dev-tools .select-animation-container{display:none}.gs-dev-tools .rewind{display:none}.gs-dev-tools .play-pause{width:20px;height:20px;padding:4px 6px;margin-left:14px}.gs-dev-tools .time-scale{min-width:26px}.gs-dev-tools .loop{width:18px;min-width:18px;display:none}.gs-dev-tools .gs-bottom-right{display:none}}",s=!0),"string"==typeof t&&(t=document.querySelector(t));var o=g("div",t||d.getElementsByTagName("body")[0]||d);return o.setAttribute("class","gs-dev-tools"+(i?" minimal":"")),o.innerHTML='<div class=gs-hit-area></div><div class=gs-top><div class=timeline><div class=timeline-track></div><div class=progress-bar></div><div class=seek-bar></div><svg class=in-point viewBox="0 0 15 26"xmlns=http://www.w3.org/2000/svg><polygon class=in-point-shape points=".5 .5 14.5 .5 14.5 25.5 .5 17.5"/><polyline class=grab points="5.5 4 5.5 15"/><polyline class=grab points="9.5 4 9.5 17"/></svg> <svg class=out-point viewBox="0 0 15 26"xmlns=http://www.w3.org/2000/svg><polygon class=out-point-shape points=".5 .5 14.5 .5 14.5 17.5 .5 25.5"/><polyline class=grab points="5.5 4 5.5 17"/><polyline class=grab points="9.5 4 9.5 15"/></svg><div class=playhead></div></div></div><div class=gs-bottom><div class=select-animation-container><label class=select-animation><select class=animation-list><option>Global Timeline<option>myTimeline</select><nobr><span class="display animation-label">Global Timeline</span> <svg class=select-arrow viewBox="0 0 12.05 6.73"xmlns=http://www.w3.org/2000/svg><polyline class=select-arrow-shape points="0.35 0.35 6.03 6.03 11.7 0.35"/></svg></nobr></label></div><svg class=rewind viewBox="0 0 12 15.38"xmlns=http://www.w3.org/2000/svg><path d=M0,.38H2v15H0Zm2,7,10,7.36V0Z class="gs-btn-white rewind-path"/></svg> <svg class=play-pause viewBox="0 0 20.97 25.67"xmlns=http://www.w3.org/2000/svg><g class=play><path d="M8,4.88 C8,10.18 8,15.48 8,20.79 5.33,22.41 2.66,24.04 0,25.67 0,17.11 0,8.55 0,0 2.66,1.62 5.33,3.25 8,4.88"class="gs-btn-white play-1"style=stroke:#fff;stroke-width:.6px /><path d="M14.485,8.855 C16.64,10.18 18.8,11.5 20.97,12.83 16.64,15.48 12.32,18.13 8,20.79 8,15.48 8,10.18 8,4.88 10.16,6.2 12.32,7.53 14.48,8.85"class="gs-btn-white play-2"style=stroke:#fff;stroke-width:.6px /></g></svg> <svg class=loop viewBox="0 0 29 25.38"xmlns=http://www.w3.org/2000/svg><path d=M27.44,5.44,20.19,0V3.06H9.06A9.31,9.31,0,0,0,0,12.41,9.74,9.74,0,0,0,.69,16l3.06-2.23a6,6,0,0,1-.12-1.22,5.49,5.49,0,0,1,5.43-5.5H20.19v3.81Z class=loop-path /><path d=M25.25,11.54a5.18,5.18,0,0,1,.12,1.12,5.41,5.41,0,0,1-5.43,5.41H9.19V14.5L1.94,19.94l7.25,5.44V22.06H19.94A9.2,9.2,0,0,0,29,12.84a9.42,9.42,0,0,0-.68-3.53Z class=loop-path /></svg> <svg class=ease viewBox="0 0 25.67 25.67"xmlns=http://www.w3.org/2000/svg><path d=M.48,25.12c1.74-3.57,4.28-12.6,8.8-10.7s4.75,1.43,6.5-1.11S19.89,1.19,25.2.55 class=ease-path /><path d=M24.67,1V24.67H1V1H24.67m1-1H0V25.67H25.67V0Z class=ease-border /></svg><label class=time-scale><select><option value=10>10x<option value=5>5x<option value=2>2x<option value=1 selected>1x<option value=0.5>0.5x<option value=0.25>0.25x<option value=0.1>0.1x</select><span class="display time-scale-label">1x</span></label><div class=gs-bottom-right><div class=time-container><span class=time>0.00</span> / <span class=duration>0.00</span></div></div></div>',t&&(o.style.position="absolute",o.style.top=i?"calc(100% - 42px)":"calc(100% - 51px)"),n&&("string"==typeof n?o.style.cssText=n:"object"==typeof n&&(n.data="root",e.set(o,n).kill()),o.style.top&&(o.style.bottom="auto"),o.style.width&&e.set(o,{xPercent:-50,left:"50%",right:"auto",data:"root"}).kill()),!i&&600>o.offsetWidth&&(o.setAttribute("class","gs-dev-tools minimal"),t&&(o.style.top="calc(100% - 42px)")),o},x=function(e,t,i,n){var o;if("mousedown"!==t&&"mouseup"!==t||(e.style.cursor="pointer"),"mousedown"===t&&(o=void 0!==e.onpointerdown?"pointerdown":void 0!==e.ontouchstart?"touchstart":null)){var s=function(t){"select"!==t.target.nodeName.toLowerCase()&&t.type===o?(t.stopPropagation(),r&&(t.preventDefault(),i.call(e,t))):t.type!==o&&i.call(e,t),r=!0};return e.addEventListener(o,s,n),void e.addEventListener(t,s,n)}e.addEventListener(t,i,n)},_=function(e,t,i){e.removeEventListener(t,i),(t="mousedown"!==t?null:void 0!==e.onpointerdown?"pointerdown":void 0!==e.ontouchstart?"touchstart":null)&&e.removeEventListener(t,i)},T=function(e,t,i,n){var o=e.options,s=o.length;for(t+="";-1<--s;)if(o[s].innerHTML===t||o[s].value===t)return e.selectedIndex=s,i.innerHTML=o[s].innerHTML,o[s];n&&((s=g("option",e)).setAttribute("value",t),s.innerHTML=i.innerHTML="string"==typeof n?n:t,e.selectedIndex=o.length-1)},E=function(e,t,i){var n=e.options;return t=Math.min(n.length-1,Math.max(0,e.selectedIndex+t)),e.selectedIndex=t,i&&(i.innerHTML=n[t].innerHTML),n[t].value},C=new n({data:"root",id:"Global Timeline",autoRemoveChildren:!1,smoothChildTiming:!0}),A=new n({data:"root",id:"Global Temp",autoRemoveChildren:!1,smoothChildTiming:!0}),k=e.to(C,1,{time:1,ease:Linear.easeNone,data:"root",id:"_rootTween",paused:!0,immediateRender:!1}),I=function(){var e,t=A._first;if(t){if(a&&a.animation()===C){for(e=C._duration;t;){var n=t._next;"function"==typeof t.target&&t.target===t.vars.onComplete&&!t._duration||t.target&&t.target._gsIgnore?i.prototype.add.call(m,t,t._startTime-t._delay):C.add(t,t._startTime-t._delay),t=n}return e!==C.duration()}for(;t;)n=t._next,t._gc||t._totalTime===t._totalDuration?t.kill():i.prototype.add.call(m,t,t._startTime-t._delay),t=n}},M=function(){a&&(a.update(),l=!1),e.ticker.removeEventListener("tick",M)},D=function(e){var t=new n({data:"root",onComplete:function(){t.kill()}});return t.to(e.querySelector(".play-1"),.5,{attr:{d:"M5.75,3.13 C5.75,9.79 5.75,16.46 5.75,23.13 4.08,23.13 2.41,23.13 0.75,23.13 0.75,16.46 0.75,9.79 0.75,3.12 2.41,3.12 4.08,3.12 5.75,3.12"},ease:Power3.easeInOut,rotation:360,transformOrigin:"50% 50%"}).to(e.querySelector(".play-2"),.5,{attr:{d:"M16.38,3.13 C16.38,9.79 16.38,16.46 16.38,23.13 14.71,23.13 13.04,23.13 11.38,23.13 11.38,16.46 11.38,9.79 11.38,3.12 13.04,3.12 14.71,3.12 16.38,3.12"},ease:Power3.easeInOut,rotation:360,transformOrigin:"50% 50%"},.05),t},P=function(e){var t=new n({data:"root",paused:!0,onComplete:function(){t.kill()}});return t.to(e,.5,{rotation:360,ease:Power3.easeInOut,transformOrigin:"50% 50%"}).to(e.querySelectorAll(".loop-path"),.5,{fill:"#44cbd7",ease:Linear.easeNone},0),t},O=function(i){this.vars=i=i||{},i.id=i.id||("string"==typeof i.animation?i.animation:u++),p[i.id+""]=this;var n,s,r,l,h,m,A,M,O,R,N,z,j=this,F=b(i.container,i.minimal,i.css),U=function(e){return F.querySelector(e)},V=function(e,t){return!1!==i.persist&&"undefined"!=typeof sessionStorage&&sessionStorage.setItem("gs-dev-"+e+i.id,t),t},G=function(e){if(!1!==i.persist&&"undefined"!=typeof sessionStorage){var t=sessionStorage.getItem("gs-dev-"+e+i.id);return"animation"===e?t:"loop"===e?"true"===t:parseFloat(t)}},H=U(".playhead"),W=U(".timeline-track"),Y=U(".progress-bar"),X=U(".time"),$=U(".duration"),J=0,Z=function(e,t,i){return function(o){o=W.getBoundingClientRect();var a=e.getBoundingClientRect(),c=a.width*t,d=e._gsTransform.x,u=o.left-a.left-c+d;a=o.right-a.right+(a.width-c)+d,c=u,i&&(e!==Q&&((d=Q.getBoundingClientRect()).left&&(u+=d.left+d.width-o.left)),e!==K&&((d=K.getBoundingClientRect()).left&&(a-=o.left+o.width-d.left))),h=ce,this.applyBounds({minX:u,maxX:a}),n=M.duration()/o.width,s=-c*n,l?M.pause():M.pause(s+n*this.x),this.target===H&&(this.activated&&(this.allowEventDefault=!1),this.activated=!0),r=!0}},q=o.create(H,{type:"x",cursor:"ew-resize",allowNativeTouchScrolling:!1,allowEventDefault:!0,onPress:Z(H,.5,!0),onDrag:function(){var e=s+n*this.x;0>e?e=0:e>M._duration&&(e=M._duration),l||M.time(e),Y.style.width=Math.min(ie-te,Math.max(0,e/M._duration*100-te))+"%",X.innerHTML=e.toFixed(2)},onRelease:function(e){ce||M.resume()}})[0],Q=U(".in-point"),K=U(".out-point"),ee=function(){te=0,ie=100,Q.style.left="0%",K.style.left="100%",V("in",te),V("out",ie),se(!0)},te=0,ie=100,ne=o.create(Q,{type:"x",cursor:"ew-resize",zIndexBoost:!1,allowNativeTouchScrolling:!1,allowEventDefault:!0,onPress:Z(Q,1,!0),onDoubleClick:ee,onDrag:function(){te=(s+n*this.x)/M.duration()*100,M.progress(te/100),se(!0)},onRelease:function(){0>te&&(te=0),f(),Q.style.left=te+"%",V("in",te),e.set(Q,{x:0,data:"root",display:"block"}),ce||M.resume()}})[0],oe=o.create(K,{type:"x",cursor:"ew-resize",allowNativeTouchScrolling:!1,allowEventDefault:!0,zIndexBoost:!1,onPress:Z(K,0,!0),onDoubleClick:ee,onDrag:function(){ie=(s+n*this.x)/M.duration()*100,M.progress(ie/100),se(!0)},onRelease:function(){100<ie&&(ie=100),f(),K.style.left=ie+"%",V("out",ie),e.set(K,{x:0,data:"root",display:"block"}),h||(he(),M.resume())}})[0],se=function(e){if(!q.isPressed||e){var t=m||-1!==A._repeat?100*M.progress()||0:A.totalTime()/A.duration()*100,i=A._repeat&&A._repeatDelay&&A.totalTime()%(A.duration()+A._repeatDelay)>A.duration();100<t&&(t=100),t>=ie?!m||M.paused()||q.isDragging?(t===ie&&-1!==A._repeat||(t=ie,M.progress(t/100)),ce||1!==A.totalProgress()&&-1!==A._repeat||de()):i||(t=te,M.target===A&&M.target.seek(R+(N-R)*te/100),0<A._repeat&&!te&&100===ie?1===A.totalProgress()&&M.totalProgress(0,!0).resume():M.progress(t/100,!0).resume()):t<te&&(t=te,M.progress(t/100,!0)),t!==J||e?(Y.style.left=te+"%",Y.style.width=Math.max(0,t-te)+"%",H.style.left=t+"%",X.innerHTML=M._time.toFixed(2),$.innerHTML=M._duration.toFixed(2),r&&(H.style.transform="translate(-50%,0)",H._gsTransform.x=0,H._gsTransform.xPercent=-50,r=!1),J=t):M._paused!==ce&&ue()}},re=function(e){if(!q.isPressed){var t=e.target.getBoundingClientRect();(t=((e.changedTouches?e.changedTouches[0]:e).clientX-t.left)/t.width*100)<te?(te=Math.max(0,t),Q.style.left=te+"%",ne.startDrag(e)):t>ie?(ie=Math.min(100,t),K.style.left=ie+"%",oe.startDrag(e)):(M.progress(t/100).pause(),se(!0),q.startDrag(e))}},ae=U(".play-pause"),le=D(ae),ce=!1,he=function(){M.progress()>=ie/100&&(M.target===A&&M.target.seek(R+(N-R)*te/100),M._repeat&&!te?M.totalProgress(0,!0):M.progress(te/100,!0)),le.play(),M.resume(),ce&&j.update(),ce=!1},de=function(){le.reverse(),M&&M.pause(),ce=!0},ue=function(){ce?he():de()},pe=function(e){q.isPressed||(M.target===A&&M.target.seek(R+(N-R)*te/100),M.progress(te/100,!0),ce||M.resume())},ge=U(".loop"),fe=P(ge),me=function(e){V("loop",m=e),m?(fe.play(),M.progress()>=ie/100&&(M.target===A&&M.target.seek(R+(N-R)*te/100),A._repeat&&!te&&100===ie?M.totalProgress(0,!0):M.progress(te/100,!0),he())):fe.reverse()},ve=function(){me(!m)},ye=U(".animation-list"),we=U(".animation-label"),Se=function(){var e,t=v(O&&!1===i.globalSync?O:C,!0),n=ye.children,o=0;for(O&&!1===i.globalSync?t.unshift(O):i.hideGlobalTimeline||t.unshift(C),e=0;e<t.length;e++){var s=n[e]||g("option",ye);s.animation=t[e],o=e&&t[e].vars.id===t[e-1].vars.id?o+1:0,s.setAttribute("value",s.innerHTML=t[e].vars.id+(o?" ["+o+"]":t[e+1]&&t[e+1].vars.id===t[e].vars.id?" [0]":""))}for(;e<n.length;e++)ye.removeChild(n[e])},be=function(n){var o=parseFloat(_e.options[_e.selectedIndex].value)||1;if(!arguments.length)return A;if("string"==typeof n&&(n=w(n)),n instanceof t||console.log("AnovDevTools error: invalid animation."),n!==A){A&&(A._inProgress=te,A._outProgress=ie),A=n,M&&(o=M.timeScale(),M.target===O&&(O.resume(),M.kill())),te=A._inProgress||0,ie=A._outProgress||100,Q.style.left=te+"%",K.style.left=ie+"%",z&&(V("animation",A.vars.id),V("in",te),V("out",ie)),R=0;var s=i.maxDuration||Math.min(1e3,y(A));if(A===C||!1!==i.globalSync){if(I(),M=k,a&&a!==j&&console.log("Error: AnovDevTools can only have one instance that's globally synchronized."),a=j,A!==C){var r=A;for(99999999<(N=r.totalDuration())&&(N=r.duration());r.timeline.timeline;)R=R/r._timeScale+r._startTime,N=N/r._timeScale+r._startTime,r=r.timeline}else N=C.duration();N-R>s&&(N=R+s),C.pause(R),k.vars.time=N,k.invalidate(),k.duration(N-R).timeScale(o),ce?k.progress(1).pause(0):e.delayedCall(.01,function(){k.resume().progress(te/100),ce&&he()})}else{if(a===j&&(a=null),A!==O&&O){for(99999999<(N=(r=A).totalDuration())&&(N=r.duration());r.timeline.timeline&&r!==O;)R=R/r._timeScale+r._startTime,N=N/r._timeScale+r._startTime,r=r.timeline;N-R>s&&(N=R+s),O.pause(R),M=e.to(O,N-R,{time:N,ease:Linear.easeNone,data:"root"})}else M=A,!m&&M._repeat&&me(!0);M.timeScale(o),k.pause(),C.resume(),M.seek(0)}$.innerHTML=M.duration().toFixed(2),T(ye,A.vars.id,we)}},xe=function(e){be(ye.options[ye.selectedIndex].animation),e.target&&e.target.blur&&e.target.blur(),ce&&he()},_e=U(".time-scale select"),Te=U(".time-scale-label"),Ee=function(t){t=parseFloat(_e.options[_e.selectedIndex].value)||1,M.timeScale(t),V("timeScale",t),ce||(M.progress()>=ie/100?(M.target===A&&M.target.seek(R+(N-R)*te/100),M.progress(te/100,!0).pause()):M.pause(),e.delayedCall(.01,function(){M.resume()})),Te.innerHTML=t+"x",_e.blur&&_e.blur()},Ce=e.to([U(".gs-bottom"),U(".gs-top")],.3,{autoAlpha:0,y:50,ease:Power2.easeIn,data:"root",paused:!0}),Ae=!1,ke=function(e){o.hitTest(e,F)||q.isDragging||ne.isDragging||oe.isDragging||De.restart(!0)},Ie=function(){Ae||(Ce.play(),De.pause(),Ae=!0)},Me=function(){De.pause(),Ae&&(Ce.reverse(),Ae=!1)},De=e.delayedCall(1.3,Ie).pause();if(Z=function(e){L&&!B&&(B=C._startTime),z=!e,(O=w(i.animation))&&!O.vars.id&&(O.vars.id="[no id]"),Se(),(e=w(G("animation")))&&(e._inProgress=G("in")||0,e._outProgress=G("out")||100),i.paused&&de(),A=null,be(O||e||C);var t=i.timeScale||G("timeScale"),n=e===A;t&&(T(_e,t,Te,t+"x"),M.timeScale(t)),100===(te=("inTime"in i?S(i.inTime,A,0,0):n?e._inProgress:0)||0)&&!i.animation&&e&&(be(C),te=S(i.inTime,A,0,0)||0),te&&(Q.style.left=te+"%",Q.style.display=K.style.display="block"),(ie=("outTime"in i?S(i.outTime,A,100,te):n?e._outProgress:0)||100)<te&&(ie=100),100!==ie&&(K.style.left=ie+"%",Q.style.display=K.style.display="block"),(m="loop"in i?i.loop:G("loop"))&&me(!0),i.paused&&M.progress(te/100,!0).pause(),L&&A===C&&B&&!1!==i.globalSync&&!ce&&M.time(-B,!0),se(!0)},x(ye,"change",xe),x(ye,"mousedown",Se),x(ae,"mousedown",ue),x(U(".seek-bar"),"mousedown",re),x(U(".rewind"),"mousedown",pe),x(ge,"mousedown",ve),x(_e,"change",Ee),"auto"===i.visibility?(x(F,"mouseout",ke),x(F,"mouseover",Me)):"hidden"===i.visibility&&(Ae=!0,Ce.progress(1)),!1!==i.keyboard)if(c&&i.keyboard)console.log("[AnovDevTools warning] only one instance can be affected by keyboard shortcuts. There is already one active.");else{c=j;var Pe=function(e){var t=e.keyCode?e.keyCode:e.which;32===t?ue():87===t?(e=parseFloat(E(_e,-1,Te)),M.timeScale(e),V("timeScale",e)):83===t?(e=parseFloat(E(_e,1,Te)),M.timeScale(e),V("timeScale",e)):65===t?pe():68===t?M.progress(ie/100):76===t?ve():72===t?Ae?Me():Ie():66===t?(te=100*M.progress(),V("in",te),Q.style.left=te+"%",se(!0)):69===t&&(ie=100*M.progress(),V("out",ie),K.style.left=ie+"%",se(!0))};x(d,"keydown",Pe)}e.set(H,{xPercent:-50,x:0,data:"root"}),e.set(Q,{xPercent:-100,x:0,data:"root"}),Q._gsIgnore=K._gsIgnore=H._gsIgnore=ae._gsIgnore=ge._gsIgnore=!0,e.killTweensOf([Q,K,H]),Z(L),L&&e.delayedCall(1e-4,Z,[!1],this),e.ticker.addEventListener("tick",se),this.update=function(e){if(a===j&&(k._paused&&!e||I(),A===C)){e=C._time,C.progress(1,!0).time(e,!0),e=(k._timeline._time-k._startTime)*k._timeScale;var t=Math.min(1e3,C.duration());1e3===t&&(t=Math.min(1e3,y(C)));var i=k.duration()/t;1!==i&&t&&(te*=i,100>ie&&(ie*=i),k.seek(0),k.vars.time=t,k.invalidate(),k.duration(t),k.time(e),$.innerHTML=t.toFixed(2),se(!0))}},this.kill=function(){_(ye,"change",xe),_(ye,"mousedown",Se),_(ae,"mousedown",ue),_(U(".seek-bar"),"mousedown",re),_(U(".rewind"),"mousedown",pe),_(ge,"mousedown",ve),_(_e,"change",Ee),q.disable(),ne.disable(),oe.disable(),e.ticker.removeEventListener("tick",se),_(F,"mouseout",ke),_(F,"mouseover",Me),_(d,"keydown",Pe),F.parentNode.removeChild(F),a===j&&(a=null),delete p[i.id+""]},this.minimal=function(e){var t=F.classList.contains("minimal");if(!arguments.length||t===e)return t;e?F.classList.add("minimal"):F.classList.remove("minimal"),i.container&&(F.style.top=e?"calc(100% - 42px)":"calc(100% - 51px)"),q.isPressed&&(l=!0,q.endDrag(q.pointerEvent),l=!1,t=100*M.progress(),Y.style.width=Math.max(0,t-te)+"%",H.style.left=t+"%",H.style.transform="translate(-50%,0)",H._gsTransform.x=0,H._gsTransform.xPercent=-50,q.startDrag(q.pointerEvent,!0))},this.animation=be,this.updateList=Se},R=!0,L=!0,N=e.onOverwrite,B=0;return O.version="0.1.11",O.logOverwrites=!1,O.globalRecordingTime=2,O.getById=function(e){return e?p[e]:a},m._startTime+=m._time,C._startTime=A._startTime=m._time=m._totalTime=0,e.delayedCall(.01,function(){a?a.update():I()}),e.delayedCall(2,function(){var t;if(!a){I();var n=C._first;for(t=C._startTime;n;){var o=n._next;n._totalDuration!==n._totalTime||!n._duration&&1!==n.ratio?i.prototype.add.call(m,n,n._startTime-n._delay+t):n.kill(),n=o}}2<O.globalRecordingTime?e.delayedCall(O.globalRecordingTime-2,function(){a&&a.update(),R=!1}):R=!1,L=!1}),m.add=function(t,n,o,s){var r=t.data;return!R||!t.vars||"root"===r||"ignore"===r||"isStart"===r||"isFromStart"===r||"_draggable"===r||L&&!t._duration&&t instanceof e||t.vars.onComplete&&t.vars.onComplete===t.vars.onReverseComplete?i.prototype.add.apply(this,arguments):(r=C,k._time&&(k._paused?(r=A,t._recordedTime=C.rawTime()):(n=(m._time-k._startTime)*k._timeScale,l||(e.ticker.addEventListener("tick",M),l=!0))),r.add(t,n,o,s),t.vars.repeat&&(r._dirty=!0),this)},C._enabled=A._enabled=function(e,t){return i.prototype._enabled.apply(this,arguments)},n.prototype._remove=function(e,t){return i.prototype._remove.apply(this,arguments),this._last?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},e.onOverwrite=function(e,t,i,n){O.logOverwrites&&(n?console.log("[Overwrite warning] the following properties were overwritten: ",n,"| target:",i,"| overwritten tween: ",e,"| overwriting tween:",t):console.log("[Overwrite warning] the following tween was overwritten:",e,"by",t)),"function"==typeof N&&N(e,t,i,n)},O.create=function(e){return new O(e)},O},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),_gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:window,(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){_gsScope._gsDefine("utils.Draggable",["events.EventDispatcher","TweenLite","plugins.CSSPlugin"],function(e,t,i){var n,o,s,r,a,l,c,h,d={css:{},data:"_draggable"},u={css:{},data:"_draggable"},p={css:{},data:"_draggable"},g={css:{}},f=_gsScope._gsDefine.globals,m={},v=function(){return!1},y={style:{},appendChild:v,removeChild:v},w=_gsScope.document||{createElement:function(){return y}},S=w.documentElement||{},b=function(e){return w.createElementNS?w.createElementNS("http://www.w3.org/1999/xhtml",e):w.createElement(e)},x=b("div"),_=[],T=180/Math.PI,E=Date.now||function(){return(new Date).getTime()},C=!(w.addEventListener||!w.all),A=w.createElement("div"),k=[],I={},M=0,D=/^(?:a|input|textarea|button|select)$/i,P=0,O=_gsScope.navigator&&-1!==_gsScope.navigator.userAgent.toLowerCase().indexOf("android"),R=0,L={},N={},B=function(e,t){var i,n={};if(t)for(i in e)n[i]=e[i]*t;else for(i in e)n[i]=e[i];return n},z=function(){for(var e=k.length;-1<--e;)k[e]()},j=function(e){k.push(e),1===k.length&&t.ticker.addEventListener("tick",z,this,!1,1)},F=function(e){for(var i=k.length;-1<--i;)k[i]===e&&k.splice(i,1);t.to(U,0,{overwrite:"all",delay:15,onComplete:U,data:"_draggable"})},U=function(){k.length||t.ticker.removeEventListener("tick",z)},V=function(){return null!=window.pageYOffset?window.pageYOffset:null!=w.scrollTop?w.scrollTop:S.scrollTop||w.body.scrollTop||0},G=function(){return null!=window.pageXOffset?window.pageXOffset:null!=w.scrollLeft?w.scrollLeft:S.scrollLeft||w.body.scrollLeft||0},H=function(e,t){Ie(e,"scroll",t),Y(e.parentNode)||H(e.parentNode,t)},W=function(e,t){Me(e,"scroll",t),Y(e.parentNode)||W(e.parentNode,t)},Y=function(e){return!(e&&e!==S&&e!==w&&e!==w.body&&e!==window&&e.nodeType&&e.parentNode)},X=function(e,t){var i="x"===t?"Width":"Height",n="scroll"+i,o="client"+i,s=w.body;return Math.max(0,Y(e)?Math.max(S[n],s[n])-(window["inner"+i]||S[o]||s[o]):e[n]-e[o])},$=function(e){var t=Y(e),i=X(e,"x"),n=X(e,"y");t?e=N:$(e.parentNode),e._gsMaxScrollX=i,e._gsMaxScrollY=n,e._gsScrollX=e.scrollLeft||0,e._gsScrollY=e.scrollTop||0},J=function(e,t){return e=e||window.event,m.pageX=e.clientX+w.body.scrollLeft+S.scrollLeft,m.pageY=e.clientY+w.body.scrollTop+S.scrollTop,t&&(e.returnValue=!1),m},Z=function(e){return e?("string"==typeof e&&(e=t.selector(e)),e.length&&e!==window&&e[0]&&e[0].style&&!e.nodeType&&(e=e[0]),e===window||e.nodeType&&e.style?e:null):e},q=function(e,t){var i,n=e.style;if(void 0===n[t]){var o=["O","Moz","ms","Ms","Webkit"],s=5;for(i=t.charAt(0).toUpperCase()+t.substr(1);-1<--s&&void 0===n[o[s]+i];);if(0>s)return"";t=(3===s?"ms":o[s])+i}return t},Q=function(e,t,i){var n=e.style;n&&(void 0===n[t]&&(t=q(e,t)),null==i?n.removeProperty?n.removeProperty(t.replace(/([A-Z])/g,"-$1").toLowerCase()):n.removeAttribute(t):void 0!==n[t]&&(n[t]=i))},K="undefined"!=typeof window?window:w.defaultView||{getComputedStyle:function(){}},ee=function(e,t){return K.getComputedStyle(e instanceof Element?e:e.host||(e.parentNode||{}).host||e,t)},te=/(?:Left|Right|Width)/i,ie=/(?:\d|\-|\+|=|#|\.)*/g,ne=function(e,t,i,n,o){if("px"===n||!n)return i;if("auto"===n||!i)return 0;var s=te.test(t),r=e,a=x.style,l=0>i;return l&&(i=-i),"%"===n&&-1!==t.indexOf("border")?s=i/100*(s?e.clientWidth:e.clientHeight):(a.cssText="border:0 solid red;position:"+oe(e,"position",!0)+";line-height:0;","%"!==n&&r.appendChild?a[s?"borderLeftWidth":"borderTopWidth"]=i+n:(r=e.parentNode||w.body,a[s?"width":"height"]=i+n),r.appendChild(x),s=parseFloat(x[s?"offsetWidth":"offsetHeight"]),r.removeChild(x),0!==s||o||(s=ne(e,t,i,n,!0))),l?-s:s},oe=function(e,t,i){var n,o=(e._gsTransform||{})[t];return o||0===o?o:(e.style&&e.style[t]?o=e.style[t]:(n=ee(e))?o=(o=n.getPropertyValue(t.replace(/([A-Z])/g,"-$1").toLowerCase()))||n.length?o:n[t]:e.currentStyle&&(o=e.currentStyle[t]),"auto"!==o||"top"!==t&&"left"!==t||("absolute"!==oe(e,"position",!0)?o=0:(n=oe(e,"margin"+(o="left"===t?"Left":"Top"),!0),o=e["offset"+o]-(ne(e,t,parseFloat(n),(n+"").replace(ie,""))||0))),i?o:parseFloat(o)||0)},se=function(e,t,i){var n=e.vars,o=n[i],s=e._listeners[t];"function"==typeof o&&o.apply(n[i+"Scope"]||n.callbackScope||e,n[i+"Params"]||[e.pointerEvent]),s&&e.dispatchEvent(t)},re=function(e,t){var i=Z(e);if(!i){if(void 0!==e.left)return i=Se(t),{left:e.left-i.x,top:e.top-i.y,width:e.width,height:e.height};var n=e.min||e.minX||e.minRotation||0;return{left:n,top:i=e.min||e.minY||0,width:(e.max||e.maxX||e.maxRotation||0)-n,height:(e.max||e.maxY||0)-i}}return Ee(i,t)},ae=function(){if(w.createElementNS){var e=b("div"),t=w.createElementNS("http://www.w3.org/2000/svg","svg"),i=b("div"),n=e.style,o=w.body||S,s="flex"===oe(o,"display",!0);if(w.body&&he){n.position="absolute",o.appendChild(i),i.appendChild(e);var d=e.offsetParent;i.style[he]="rotate(1deg)",h=e.offsetParent===d,i.style.position="absolute",n.height="10px",d=e.offsetTop,i.style.border="5px solid red",c=d!==e.offsetTop,o.removeChild(i)}n=t.style,t.setAttributeNS(null,"width","400px"),t.setAttributeNS(null,"height","400px"),t.setAttributeNS(null,"viewBox","0 0 400 400"),n.display="block",n.boxSizing="border-box",n.border="0px solid red",n.transform="none",e.style.cssText="width:100px;height:100px;overflow:scroll;-ms-overflow-style:none;",o.appendChild(e),e.appendChild(t),i=(d=t.createSVGPoint().matrixTransform(t.getScreenCTM())).y,e.scrollTop=100,d.x=d.y=0,d=d.matrixTransform(t.getScreenCTM()),l=100.1>i-d.y?0:i-d.y-150,e.removeChild(t),o.removeChild(e),o.appendChild(t),s&&(o.style.display="block"),i=(e=t.getScreenCTM()).e,n.border="50px solid red",e=t.getScreenCTM(),0===i&&0===e.e&&0===e.f&&1===e.a?(r=1,a=!0):(r=i!==e.e?1:0,a=1!==e.a),s&&(o.style.display="flex"),o.removeChild(t)}else r=0,a=!1},le=""!==q(x,"perspective"),ce=q(x,"transformOrigin").replace(/^ms/g,"Ms").replace(/([A-Z])/g,"-$1").toLowerCase(),he=q(x,"transform"),de=he.replace(/^ms/g,"Ms").replace(/([A-Z])/g,"-$1").toLowerCase(),ue={},pe={},ge=_gsScope.SVGElement,fe=function(e){return!!(ge&&"function"==typeof e.getBBox&&e.getCTM&&(!e.parentNode||e.parentNode.getBBox&&e.parentNode.getCTM))},me=_gsScope.navigator&&(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(_gsScope.navigator.userAgent)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(_gsScope.navigator.userAgent))&&11>parseFloat(RegExp.$1),ve=[],ye=[],we=function(e){if(!e.getBoundingClientRect||!e.parentNode||!he)return{offsetTop:0,offsetLeft:0,scaleX:1,scaleY:1,offsetParent:S};if(!1!==ze.cacheSVGData&&e._dCache&&e._dCache.lastUpdate===t.ticker.frame)return e._dCache;var i=e,n=be(e);if(n.lastUpdate=t.ticker.frame,e.getBBox&&!n.isSVGRoot){for(i=e.parentNode,e=e.getBBox();i&&"svg"!==(i.nodeName+"").toLowerCase();)i=i.parentNode;var o=we(i);return n.offsetTop=e.y*o.scaleY,n.offsetLeft=e.x*o.scaleX,n.scaleX=o.scaleX,n.scaleY=o.scaleY,n.offsetParent=i||S,n}var s=n.offsetParent;for(s===w.body&&(s=S),ye.length=ve.length=0;i&&("matrix(1, 0, 0, 1, 0, 0)"!==(o=oe(i,he,!0))&&"none"!==o&&"translate3d(0px, 0px, 0px)"!==o&&(ye.push(i),ve.push(i.style[he]),i.style[he]="none"),i!==s);)i=i.parentNode;i=s.getBoundingClientRect(),o=e.getScreenCTM();var c=e.createSVGPoint().matrixTransform(o);if(n.scaleX=Math.sqrt(o.a*o.a+o.b*o.b),n.scaleY=Math.sqrt(o.d*o.d+o.c*o.c),void 0===r&&ae(),n.borderBox&&!a&&e.getAttribute("width")){o=ee(e)||{};var h=parseFloat(o.borderLeftWidth)+parseFloat(o.borderRightWidth)||0,d=parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth)||0,u=parseFloat(o.width)||0;o=parseFloat(o.height)||0,n.scaleX*=(u-h)/u,n.scaleY*=(o-d)/o}for(l?(e=e.getBoundingClientRect(),n.offsetLeft=e.left-i.left,n.offsetTop=e.top-i.top):(n.offsetLeft=c.x-i.left,n.offsetTop=c.y-i.top),n.offsetParent=s,s=ye.length;-1<--s;)ye[s].style[he]=ve[s];return n},Se=function(e,i){if(i=i||{},!e||e===S||!e.parentNode||e===window)return{x:0,y:0};var n=ee(e),o=ce&&n?n.getPropertyValue(ce):"50% 50%",s=o.split(" ");return n=-1!==o.indexOf("left")?"0%":-1!==o.indexOf("right")?"100%":s[0],"center"!==(o=-1!==o.indexOf("top")?"0%":-1!==o.indexOf("bottom")?"100%":s[1])&&null!=o||(o="50%"),("center"===n||isNaN(parseFloat(n)))&&(n="50%"),e.getBBox&&fe(e)?(e._gsTransform||(t.set(e,{x:"+=0",overwrite:!1}),void 0===e._gsTransform.xOrigin&&console.log("Draggable requires at least GSAP 1.17.0")),o=e.getBBox(),i.x=e._gsTransform.xOrigin-o.x,i.y=e._gsTransform.yOrigin-o.y):(e.getBBox&&-1!==(n+o).indexOf("%")&&(e={offsetWidth:(e=e.getBBox()).width,offsetHeight:e.height}),i.x=-1!==n.indexOf("%")?e.offsetWidth*parseFloat(n)/100:parseFloat(n),i.y=-1!==o.indexOf("%")?e.offsetHeight*parseFloat(o)/100:parseFloat(o)),i},be=function(e){if(!1!==ze.cacheSVGData&&e._dCache&&e._dCache.lastUpdate===t.ticker.frame)return e._dCache;var i=e._dCache=e._dCache||{},n=ee(e),o=e.getBBox&&fe(e),s="svg"===(e.nodeName+"").toLowerCase();if(i.isSVG=o,i.isSVGRoot=s,i.borderBox="border-box"===n.boxSizing,i.computedStyle=n,s)(n=e.parentNode||S).insertBefore(x,e),i.offsetParent=x.offsetParent||S,n.removeChild(x);else if(o){for(n=e.parentNode;n&&"svg"!==(n.nodeName+"").toLowerCase();)n=n.parentNode;i.offsetParent=n}else i.offsetParent=e.offsetParent;return i},xe=function(e,t,i,n,o){if(e===window||!e||!e.style||!e.parentNode)return[1,0,0,1,0,0];var s,a=e._dCache||be(e),l=e.parentNode,d=l._dCache||be(l),u=a.computedStyle,p=a.isSVG?d.offsetParent:l.offsetParent,g=a.isSVG&&-1!==(e.style[he]+"").indexOf("matrix")?e.style[he]:u?u.getPropertyValue(de):e.currentStyle?e.currentStyle[he]:"1,0,0,1,0,0";if(e.getBBox&&-1!==(e.getAttribute("transform")+"").indexOf("matrix")&&(g=e.getAttribute("transform")),6<(g=(g+"").match(/(?:\-|\.|\b)(\d|\.|e\-)+/g)||[1,0,0,1,0,0]).length&&(g=[g[0],g[1],g[4],g[5],g[12],g[13]]),n?g[4]=g[5]=0:a.isSVG&&(s=e._gsTransform)&&(s.xOrigin||s.yOrigin)&&(g[0]=parseFloat(g[0]),g[1]=parseFloat(g[1]),g[2]=parseFloat(g[2]),g[3]=parseFloat(g[3]),g[4]=parseFloat(g[4])-(s.xOrigin-(s.xOrigin*g[0]+s.yOrigin*g[2])),g[5]=parseFloat(g[5])-(s.yOrigin-(s.xOrigin*g[1]+s.yOrigin*g[3]))),t){if(void 0===r&&ae(),n=a.isSVG||a.isSVGRoot?we(e):e,a.isSVG)o=e.getBBox(),n=d.isSVGRoot?{x:0,y:0}:l.getBBox(),n={offsetLeft:o.x-n.x,offsetTop:o.y-n.y,offsetParent:a.offsetParent};else if(a.isSVGRoot){s=parseInt(u.borderTopWidth,10)||0;var f=parseInt(u.borderLeftWidth,10)||0;u=(g[0]-r)*f+g[2]*s,f=g[1]*f+(g[3]-r)*s;var m=t.x,v=t.y;s=m-(m*g[0]+v*g[2]),m=v-(m*g[1]+v*g[3]),g[4]=parseFloat(g[4])+s,g[5]=parseFloat(g[5])+m,t.x-=s,t.y-=m,m=n.scaleX,v=n.scaleY,o||(t.x*=m,t.y*=v),g[0]*=m,g[1]*=v,g[2]*=m,g[3]*=v,me||(t.x+=u,t.y+=f),p===w.body&&n.offsetParent===S&&(p=S)}else!c&&e.offsetParent&&(t.x+=parseInt(oe(e.offsetParent,"borderLeftWidth"),10)||0,t.y+=parseInt(oe(e.offsetParent,"borderTopWidth"),10)||0);if(o=l===S||l===w.body,g[4]=Number(g[4])+t.x+(n.offsetLeft||0)-i.x-(o?0:l.scrollLeft||0),g[5]=Number(g[5])+t.y+(n.offsetTop||0)-i.y-(o?0:l.scrollTop||0),l&&"fixed"===oe(e,"position",!0))for(g[4]+=G(),g[5]+=V(),l=l.offsetParent;l;)g[4]-=l.offsetLeft,g[5]-=l.offsetTop,l=l.offsetParent;else!l||l===S||p!==n.offsetParent||d.isSVG||h&&"100100"!==xe(l).join("")||(n=d.isSVGRoot?we(l):l,g[4]-=n.offsetLeft||0,g[5]-=n.offsetTop||0,c||!d.offsetParent||a.isSVG||a.isSVGRoot||(g[4]-=parseInt(oe(d.offsetParent,"borderLeftWidth"),10)||0,g[5]-=parseInt(oe(d.offsetParent,"borderTopWidth"),10)||0))}return g},_e=function(e,t){if(!e||e===window||!e.parentNode)return[1,0,0,1,0,0];for(var i,n,o,s,r,a,l=Se(e,ue),c=Se(e.parentNode,pe),h=xe(e,l,c,!1,!t);(e=e.parentNode)&&e.parentNode&&e!==S;)l=c,c=Se(e.parentNode,l===ue?pe:ue),a=xe(e,l,c),l=h[0],i=h[1],n=h[2],o=h[3],s=h[4],r=h[5],h[0]=l*a[0]+i*a[2],h[1]=l*a[1]+i*a[3],h[2]=n*a[0]+o*a[2],h[3]=n*a[1]+o*a[3],h[4]=s*a[0]+r*a[2]+a[4],h[5]=s*a[1]+r*a[3]+a[5];return t&&(l=h[0],i=h[1],n=h[2],o=h[3],s=h[4],r=h[5],c=l*o-i*n,h[0]=o/c,h[1]=-i/c,h[2]=-n/c,h[3]=l/c,h[4]=(n*r-o*s)/c,h[5]=-(l*r-i*s)/c),h},Te=function(e,t,i){var n=e.x*t[0]+e.y*t[2]+t[4];return t=e.x*t[1]+e.y*t[3]+t[5],e.x=n*i[0]+t*i[2]+i[4],e.y=n*i[1]+t*i[3]+i[5],e},Ee=function(e,t,i){if(!(e=Z(e)))return null;t=Z(t);var n=e.getBBox&&fe(e);if(e===window){var o=V(),s=G(),r=s+(S.clientWidth||e.innerWidth||w.body.clientWidth||0);n=o+((e.innerHeight||0)-20<S.clientHeight?S.clientHeight:e.innerHeight||w.body.clientHeight||0)}else{if(void 0===t||t===window)return e.getBoundingClientRect();if(s=-(o=Se(e)).x,o=-o.y,n)var a=(n=e.getBBox()).width,l=n.height;else if("svg"!==(e.nodeName+"").toLowerCase()&&e.offsetWidth)a=e.offsetWidth,l=e.offsetHeight;else{var c=ee(e);a=parseFloat(c.width),l=parseFloat(c.height)}if(r=s+a,n=o+l,"svg"===e.nodeName.toLowerCase()&&!C){var h=we(e),d=h.computedStyle||{};n=(e.getAttribute("viewBox")||"0 0").split(" ");var u=parseFloat(n[0]),p=parseFloat(n[1]),g=parseFloat(d.borderLeftWidth)||0,f=parseFloat(d.borderTopWidth)||0;s/=h.scaleX,o/=h.scaleY,r=s+a-(a-(a-g)/h.scaleX-u),n=o+l-(l-(l-f)/h.scaleY-p),s-=g/h.scaleX-u,o-=f/h.scaleY-p,c&&(r+=(parseFloat(d.borderRightWidth)+g)/h.scaleX,n+=(f+parseFloat(d.borderBottomWidth))/h.scaleY)}}return e===t?{left:s,top:o,width:r-s,height:n-o}:(a=_e(e),l=_e(t,!0),e=Te({x:s,y:o},a,l),c=Te({x:r,y:o},a,l),r=Te({x:r,y:n},a,l),n=Te({x:s,y:n},a,l),s=Math.min(e.x,c.x,r.x,n.x),o=Math.min(e.y,c.y,r.y,n.y),L.x=L.y=0,i&&Se(t,L),{left:s+L.x,top:o+L.y,width:Math.max(e.x,c.x,r.x,n.x)-s,height:Math.max(e.y,c.y,r.y,n.y)-o})},Ce=function(e){return!!(e&&e.length&&e[0]&&(e[0].nodeType&&e[0].style&&!e.nodeType||e[0].length&&e[0][0]))},Ae="undefined"!=typeof window&&"ontouchstart"in S&&"orientation"in window,ke=function(e){var t=e.split(",");e=(void 0!==x.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==x.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":e).split(",");for(var i={},n=4;-1<--n;)i[t[n]]=e[n],i[e[n]]=t[n];try{S.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){o=1}}))}catch(e){}return i}("touchstart,touchmove,touchend,touchcancel"),Ie=function(e,t,i,n){if(e.addEventListener){var s=ke[t];n=n||(o?{passive:!1}:null),e.addEventListener(s||t,i,n),s&&t!==s&&e.addEventListener(t,i,n)}else e.attachEvent&&e.attachEvent("on"+t,i)},Me=function(e,t,i){if(e.removeEventListener){var n=ke[t];e.removeEventListener(n||t,i),n&&t!==n&&e.removeEventListener(t,i)}else e.detachEvent&&e.detachEvent("on"+t,i)},De=function(e){n=e.touches&&P<e.touches.length,Me(e.target,"touchend",De)},Pe=function(e){n=e.touches&&P<e.touches.length,Ie(e.target,"touchend",De)},Oe=function(e,t,i,n,o,s){var r,a,l={};if(t)if(1!==o&&t instanceof Array){l.end=r=[];var c=t.length;if("object"==typeof t[0])for(a=0;a<c;a++)r[a]=B(t[a],o);else for(a=0;a<c;a++)r[a]=t[a]*o;i+=1.1,n-=1.1}else l.end="function"==typeof t?function(i){var n;if(i=t.call(e,i),1!==o)if("object"==typeof i){var s={};for(n in i)s[n]=i[n]*o;i=s}else i*=o;return i}:t;return(i||0===i)&&(l.max=i),(n||0===n)&&(l.min=n),s&&(l.velocity=0),l},Re=function(e){var t;return!(!e||!e.getAttribute||"BODY"===e.nodeName)&&(!("true"!==(t=e.getAttribute("data-clickable"))&&("false"===t||!e.onclick&&!D.test(e.nodeName+"")&&"true"!==e.getAttribute("contentEditable")))||Re(e.parentNode))},Le=function(e,t){for(var i,n=e.length;-1<--n;)(i=e[n]).ondragstart=i.onselectstart=t?null:v,Q(i,"userSelect",t?"text":"none")},Ne=function(){var e=w.createElement("div"),t=w.createElement("div"),i=t.style,n=w.body||x;return i.display="inline-block",i.position="relative",e.style.cssText=t.innerHTML="width:90px; height:40px; padding:10px; overflow:auto; visibility: hidden",e.appendChild(t),n.appendChild(e),t=t.offsetHeight+18>e.scrollHeight,n.removeChild(e),t}(),Be=function(e,i){e=Z(e),i=i||{};var n,o,s,r,a=w.createElement("div"),l=a.style,c=e.firstChild,h=0,d=0,u=e.scrollTop,p=e.scrollLeft,g=e.scrollWidth,f=e.scrollHeight,m=0,v=0,y=0;if(le&&!1!==i.force3D)var S="translate3d(",b="px,0px)";else he&&(S="translate(",b="px)");this.scrollTop=function(e,t){if(!arguments.length)return-this.top();this.top(-e,t)},this.scrollLeft=function(e,t){if(!arguments.length)return-this.left();this.left(-e,t)},this.left=function(n,o){if(!arguments.length)return-(e.scrollLeft+d);var s=e.scrollLeft-p,r=d;(2<s||-2>s)&&!o?(p=e.scrollLeft,t.killTweensOf(this,!0,{left:1,scrollLeft:1}),this.left(-p),i.onKill&&i.onKill()):(0>(n=-n)?(d=n-.5|0,n=0):n>v?(d=n-v|0,n=v):d=0,(d||r)&&(S?this._suspendTransforms||(l[he]=S+-d+"px,"+-h+b):l.left=-d+"px",0<=d+m&&(l.paddingRight=d+m+"px")),e.scrollLeft=0|n,p=e.scrollLeft)},this.top=function(n,o){if(!arguments.length)return-(e.scrollTop+h);var s=e.scrollTop-u,r=h;(2<s||-2>s)&&!o?(u=e.scrollTop,t.killTweensOf(this,!0,{top:1,scrollTop:1}),this.top(-u),i.onKill&&i.onKill()):(0>(n=-n)?(h=n-.5|0,n=0):n>y?(h=n-y|0,n=y):h=0,(h||r)&&(S?this._suspendTransforms||(l[he]=S+-d+"px,"+-h+b):l.top=-h+"px"),e.scrollTop=0|n,u=e.scrollTop)},this.maxScrollTop=function(){return y},this.maxScrollLeft=function(){return v},this.disable=function(){for(c=a.firstChild;c;)r=c.nextSibling,e.appendChild(c),c=r;e===a.parentNode&&e.removeChild(a)},this.enable=function(){if((c=e.firstChild)!==a){for(;c;)r=c.nextSibling,a.appendChild(c),c=r;e.appendChild(a),this.calibrate()}},this.calibrate=function(t){var i=e.clientWidth===n;if(u=e.scrollTop,p=e.scrollLeft,!i||e.clientHeight!==o||a.offsetHeight!==s||g!==e.scrollWidth||f!==e.scrollHeight||t){if(h||d){var r=this.left(),c=this.top();this.left(-e.scrollLeft),this.top(-e.scrollTop)}i&&!t||(l.display="block",l.width="auto",l.paddingRight="0px",(m=Math.max(0,e.scrollWidth-e.clientWidth))&&(m+=oe(e,"paddingLeft")+(Ne?oe(e,"paddingRight"):0))),l.display="inline-block",l.position="relative",l.overflow="visible",l.verticalAlign="top",l.width="100%",l.paddingRight=m+"px",Ne&&(l.paddingBottom=oe(e,"paddingBottom",!0)),C&&(l.zoom="1"),n=e.clientWidth,o=e.clientHeight,g=e.scrollWidth,f=e.scrollHeight,v=e.scrollWidth-n,y=e.scrollHeight-o,s=a.offsetHeight,l.display="block",(r||c)&&(this.left(r),this.top(c))}},this.content=a,this.element=e,this._suspendTransforms=!1,this.enable()},ze=function(o,r){e.call(this,o),o=Z(o),s||(s=f.com.greensock.plugins.ThrowPropsPlugin),this.vars=r=B(r||{}),this.target=o,this.x=this.y=this.rotation=0,this.dragResistance=parseFloat(r.dragResistance)||0,this.edgeResistance=isNaN(r.edgeResistance)?1:parseFloat(r.edgeResistance)||0,this.lockAxis=r.lockAxis,this.autoScroll=r.autoScroll||0,this.lockedAxis=null,this.allowEventDefault=!!r.allowEventDefault;var a,l,c,h,m,v,y,b,x,k,D,z,U,V,G,X,q,K,ee,te,ie,ne,ae,le,ce,he,de,ue,pe,ge=(r.type||(C?"top,left":"x,y")).toLowerCase(),me=-1!==ge.indexOf("x")||-1!==ge.indexOf("y"),ve=-1!==ge.indexOf("rotation"),ye=ve?"rotation":me?"x":"left",we=me?"y":"top",Se=-1!==ge.indexOf("x")||-1!==ge.indexOf("left")||"scroll"===ge,be=-1!==ge.indexOf("y")||-1!==ge.indexOf("top")||"scroll"===ge,xe=r.minimumMovement||2,Te=this,Ee=function(e){if("string"==typeof e&&(e=t.selector(e)),!e||e.nodeType)return[e];var i,n=[],o=e.length;for(i=0;i!==o;n.push(e[i++]));return n}(r.trigger||r.handle||o),Ce={},De=0,Ne=!1,je=r.autoScrollMarginTop||40,Fe=r.autoScrollMarginRight||40,Ve=r.autoScrollMarginBottom||40,Ge=r.autoScrollMarginLeft||40,He=r.clickableTest||Re,We=0,Ye=function(e){if(!(Te.isPressed&&2>e.which))return e.preventDefault(),e.stopPropagation(),!1;Te.endDrag()},Xe=function(e){if(Te.autoScroll&&Te.isDragging&&(Ne||G)){var t,i,n,s=o,r=15*Te.autoScroll;Ne=!1,N.scrollTop=null!=window.pageYOffset?window.pageYOffset:null!=S.scrollTop?S.scrollTop:w.body.scrollTop,N.scrollLeft=null!=window.pageXOffset?window.pageXOffset:null!=S.scrollLeft?S.scrollLeft:w.body.scrollLeft;var a=Te.pointerX-N.scrollLeft;for(i=Te.pointerY-N.scrollTop;s&&!t;){s=(t=Y(s.parentNode))?N:s.parentNode;var l=t?{bottom:Math.max(S.clientHeight,window.innerHeight||0),right:Math.max(S.clientWidth,window.innerWidth||0),left:0,top:0}:s.getBoundingClientRect(),c=n=0;if(be){var h=s._gsMaxScrollY-s.scrollTop;0>h?n=h:i>l.bottom-Ve&&h?(Ne=!0,n=Math.min(h,r*(1-Math.max(0,l.bottom-i)/Ve)|0)):i<l.top+je&&s.scrollTop&&(Ne=!0,n=-Math.min(s.scrollTop,r*(1-Math.max(0,i-l.top)/je)|0)),n&&(s.scrollTop+=n)}Se&&(0>(h=s._gsMaxScrollX-s.scrollLeft)?c=h:a>l.right-Fe&&h?(Ne=!0,c=Math.min(h,r*(1-Math.max(0,l.right-a)/Fe)|0)):a<l.left+Ge&&s.scrollLeft&&(Ne=!0,c=-Math.min(s.scrollLeft,r*(1-Math.max(0,a-l.left)/Ge)|0)),c&&(s.scrollLeft+=c)),t&&(c||n)&&(window.scrollTo(s.scrollLeft,s.scrollTop),at(Te.pointerX+c,Te.pointerY+n))}}G&&(1e-6>(r=Te.x)&&-1e-6<r&&(r=0),1e-6>(t=Te.y)&&-1e-6<t&&(t=0),ve?(Te.deltaX=r-le.data.rotation,le.data.rotation=Te.rotation=r,le.setRatio(1)):ut?(be&&(Te.deltaY=t-ut.top(),ut.top(t)),Se&&(Te.deltaX=r-ut.left(),ut.left(r))):me?(be&&(Te.deltaY=t-le.data.y,le.data.y=t),Se&&(Te.deltaX=r-le.data.x,le.data.x=r),le.setRatio(1)):(be&&(Te.deltaY=t-parseFloat(o.style.top||0),o.style.top=t+"px"),Se&&(Te.deltaY=r-parseFloat(o.style.left||0),o.style.left=r+"px")),!y||e||de||(de=!0,se(Te,"drag","onDrag"),de=!1)),G=!1},$e=function(e,i){var n=Te.x,s=Te.y;if(o._gsTransform||!me&&!ve||t.set(o,{x:"+=0",overwrite:!1,data:"_draggable"}),me?(Te.y=o._gsTransform.y,Te.x=o._gsTransform.x):ve?Te.x=Te.rotation=o._gsTransform.rotation:ut?(Te.y=ut.top(),Te.x=ut.left()):(Te.y=parseInt(o.style.top,10)||0,Te.x=parseInt(o.style.left,10)||0),(q||K||ee)&&!i&&(Te.isDragging||Te.isThrowing)){if(ee){L.x=Te.x,L.y=Te.y;var r=ee(L);r.x!==Te.x&&(Te.x=r.x,G=!0),r.y!==Te.y&&(Te.y=r.y,G=!0)}q&&((r=q(Te.x))!==Te.x&&(Te.x=r,ve&&(Te.rotation=r),G=!0)),K&&((r=K(Te.y))!==Te.y&&(Te.y=r),G=!0)}G&&Xe(!0),e||(Te.deltaX=Te.x-n,Te.deltaY=Te.y-s,se(Te,"throwupdate","onThrowUpdate"))},Je=function(){if(v=!1,ut)ut.calibrate(),Te.minX=x=-ut.maxScrollLeft(),Te.minY=D=-ut.maxScrollTop(),Te.maxX=b=Te.maxY=k=0,v=!0;else if(r.bounds){var e=re(r.bounds,o.parentNode);if(ve)Te.minX=x=e.left,Te.maxX=b=e.left+e.width,Te.minY=D=Te.maxY=k=0;else if(void 0!==r.bounds.maxX||void 0!==r.bounds.maxY)e=r.bounds,Te.minX=x=e.minX,Te.minY=D=e.minY,Te.maxX=b=e.maxX,Te.maxY=k=e.maxY;else{var t=re(o,o.parentNode);Te.minX=x=oe(o,ye)+e.left-t.left,Te.minY=D=oe(o,we)+e.top-t.top,Te.maxX=b=x+(e.width-t.width),Te.maxY=k=D+(e.height-t.height)}x>b&&(Te.minX=b,Te.maxX=b=x,x=Te.minX),D>k&&(Te.minY=k,Te.maxY=k=D,D=Te.minY),ve&&(Te.minRotation=x,Te.maxRotation=b),v=!0}r.liveSnap&&(t=(e=!0===r.liveSnap?r.snap||{}:r.liveSnap)instanceof Array||"function"==typeof e,ve?(q=nt(t?e:e.rotation,x,b,1),K=null):e.points?ee=ot(t?e:e.points,x,b,D,k,e.radius,ut?-1:1):(Se&&(q=nt(t?e:e.x||e.left||e.scrollLeft,x,b,ut?-1:1)),be&&(K=nt(t?e:e.y||e.top||e.scrollTop,D,k,ut?-1:1))))},Ze=function(){Te.isThrowing=!1,se(Te,"throwcomplete","onThrowComplete")},qe=function(){Te.isThrowing=!1},Qe=function(e,t){if(e&&s){if(!0===e){var i=r.snap||r.liveSnap||{},n=i instanceof Array||"function"==typeof i;e={resistance:(r.throwResistance||r.resistance||1e3)/(ve?10:1)},ve?e.rotation=Oe(Te,n?i:i.rotation,b,x,1,t):(Se&&(e[ye]=Oe(Te,n?i:i.points||i.x||i.left||i.scrollLeft,b,x,ut?-1:1,t||"x"===Te.lockedAxis)),be&&(e[we]=Oe(Te,n?i:i.points||i.y||i.top||i.scrollTop,k,D,ut?-1:1,t||"y"===Te.lockedAxis)),(i.points||i instanceof Array&&"object"==typeof i[0])&&(e.linkedProps=ye+","+we,e.radius=i.radius))}Te.isThrowing=!0,n=isNaN(r.overshootTolerance)?1===r.edgeResistance?0:1-Te.edgeResistance+.2:r.overshootTolerance,Te.tween=i=s.to(ut||o,{throwProps:e,data:"_draggable",ease:r.ease||f.Power3.easeOut,onComplete:Ze,onOverwrite:qe,onUpdate:r.fastMode?se:$e,onUpdateParams:r.fastMode?[Te,"onthrowupdate","onThrowUpdate"]:i&&i.radius?[!1,!0]:_},Math.max(r.minDuration||0,r.maxDuration||0)||2,isNaN(r.minDuration)?0===n||"object"==typeof e&&1e3<e.resistance?0:.5:r.minDuration,n),r.fastMode||(ut&&(ut._suspendTransforms=!0),i.render(i.duration(),!0,!0),$e(!0,!0),Te.endX=Te.x,Te.endY=Te.y,ve&&(Te.endRotation=Te.x),i.play(0),$e(!0,!0),ut&&(ut._suspendTransforms=!1))}else v&&Te.applyBounds()},Ke=function(e){var t=ne||[1,0,0,1,0,0];if(ne=_e(o.parentNode,!0),e&&Te.isPressed&&t.join(",")!==ne.join(",")){e=t[0];var i=t[1],n=t[2],s=t[3],r=t[4];t=t[5];var a=e*s-i*n;e=-i/a*l+e/a*c+-(e*t-i*r)/a,c=(n=s/a*l+-n/a*c+(n*t-s*r)/a)*ne[1]+e*ne[3]+ne[5],l=n*ne[0]+e*ne[2]+ne[4]}ne[1]||ne[2]||1!=ne[0]||1!=ne[3]||0!=ne[4]||0!=ne[5]||(ne=null)},et=function(){var e=1-Te.edgeResistance;if(Ke(!1),ne&&(l=Te.pointerX*ne[0]+Te.pointerY*ne[2]+ne[4],c=Te.pointerX*ne[1]+Te.pointerY*ne[3]+ne[5]),G&&(at(Te.pointerX,Te.pointerY),Xe(!0)),ut)Je(),m=ut.top(),h=ut.left();else if(tt()?($e(!0,!0),Je()):Te.applyBounds(),ve){var t=o,i={x:0,y:0},n=void 0;t=Z(t),t=_e(t,!1);var s=i.x,r=i.y;(n=!0===n?i:n||{}).x=s*t[0]+r*t[2]+t[4],n.y=s*t[1]+r*t[3]+t[5],V=Te.rotationOrigin=n,$e(!0,!0),h=Te.x,m=Te.y=Math.atan2(V.y-Te.pointerY,Te.pointerX-V.x)*T}else m=oe(o,we),h=oe(o,ye);v&&e&&(h>b?h=b+(h-b)/e:h<x&&(h=x-(x-h)/e),ve||(m>k?m=k+(m-k)/e:m<D&&(m=D-(D-m)/e))),Te.startX=h,Te.startY=m},tt=function(){return Te.tween&&Te.tween.isActive()},it=function(){!A.parentNode||tt()||Te.isDragging||A.parentNode.removeChild(A)},nt=function(e,t,i,n){return null==t&&(t=-999999999999999),null==i&&(i=999999999999999),"function"==typeof e?function(o){var s=Te.isPressed?1-Te.edgeResistance:1;return e.call(Te,o>i?i+(o-i)*s:o<t?t+(o-t)*s:o)*n}:e instanceof Array?function(n){for(var o,s,r=e.length,a=0,l=999999999999999;-1<--r;)0>(s=(o=e[r])-n)&&(s=-s),s<l&&o>=t&&o<=i&&(a=r,l=s);return e[a]}:isNaN(e)?function(e){return e}:function(){return e*n}},ot=function(e,t,i,n,o,s,r){return s=s&&999999999999999>s?s*s:999999999999999,"function"==typeof e?function(a){var l=Te.isPressed?1-Te.edgeResistance:1,c=a.x,h=a.y;if(a.x=c=c>i?i+(c-i)*l:c<t?t+(c-t)*l:c,a.y=h=h>o?o+(h-o)*l:h<n?n+(h-n)*l:h,(l=e.call(Te,a))!==a&&(a.x=l.x,a.y=l.y),1!==r&&(a.x*=r,a.y*=r),999999999999999>s){l=a.x-c;var d=a.y-h;l*l+d*d>s&&(a.x=c,a.y=h)}return a}:e instanceof Array?function(t){for(var i,n,o=e.length,r=0,a=999999999999999;-1<--o;)(i=(i=(n=e[o]).x-t.x)*i+(n=n.y-t.y)*n)<a&&(r=o,a=i);return a<=s?e[r]:t}:function(e){return e}},st=function(e,i){var n;if(a&&!Te.isPressed&&e&&("mousedown"!==e.type&&"pointerdown"!==e.type||i||!(30>E()-We)||!ke[Te.pointerEvent.type]))if(ae=tt(),Te.pointerEvent=e,ke[e.type]?(ie=-1!==e.type.indexOf("touch")?e.currentTarget||e.target:w,Ie(ie,"touchend",lt),Ie(ie,"touchmove",rt),Ie(ie,"touchcancel",lt),Ie(w,"touchstart",Pe)):(ie=null,Ie(w,"mousemove",rt)),he=null,Ie(w,"mouseup",lt),e&&e.target&&Ie(e.target,"mouseup",lt),te=He.call(Te,e.target)&&!1!==r.dragClickables&&!i)Ie(e.target,"change",lt),se(Te,"pressInit","onPressInit"),se(Te,"press","onPress"),Le(Ee,!0);else{if(ce=!(!ie||Se===be||!1===Te.vars.allowNativeTouchScrolling||Te.vars.allowContextMenu&&e&&(e.ctrlKey||2<e.which))&&(Se?"y":"x"),C?e=J(e,!0):ce||Te.allowEventDefault||(e.preventDefault(),e.preventManipulation&&e.preventManipulation()),e.changedTouches?(e=z=e.changedTouches[0],U=e.identifier):e.pointerId?U=e.pointerId:z=U=null,P++,j(Xe),c=Te.pointerY=e.pageY,l=Te.pointerX=e.pageX,se(Te,"pressInit","onPressInit"),(ce||Te.autoScroll)&&$(o.parentNode),!o.parentNode||!Te.autoScroll||ut||ve||!o.parentNode._gsMaxScrollX||A.parentNode||o.getBBox||(A.style.width=o.parentNode.scrollWidth+"px",o.parentNode.appendChild(A)),et(),Te.tween&&Te.tween.kill(),Te.isThrowing=!1,t.killTweensOf(ut||o,!0,Ce),ut&&t.killTweensOf(o,!0,{scrollTo:1}),Te.tween=Te.lockedAxis=null,(r.zIndexBoost||!ve&&!ut&&!1!==r.zIndexBoost)&&(o.style.zIndex=ze.zIndex++),Te.isPressed=!0,y=!(!r.onDrag&&!Te._listeners.drag),!ve&&(!1!==r.cursor||r.activeCursor))for(n=Ee.length;-1<--n;)Q(Ee[n],"cursor",r.activeCursor||r.cursor||"move");se(Te,"press","onPress")}},rt=function(e){var t,i,o=e;if(a&&!n&&Te.isPressed&&e){if(Te.pointerEvent=e,t=e.changedTouches){if((e=t[0])!==z&&e.identifier!==U){for(i=t.length;-1<--i&&(e=t[i]).identifier!==U;);if(0>i)return}}else if(e.pointerId&&U&&e.pointerId!==U)return;if(C)e=J(e,!0);else{if(ie&&ce&&!he){var s=e.pageX;if(t=e.pageY,ne&&(i=s*ne[0]+t*ne[2]+ne[4],t=s*ne[1]+t*ne[3]+ne[5],s=i),((i=Math.abs(s-l))!==(t=Math.abs(t-c))&&(i>xe||t>xe)||O&&ce===he)&&(he=i>t&&Se?"x":"y",!1!==Te.vars.lockAxisOnTouchScroll&&(Te.lockedAxis="x"===he?"y":"x","function"==typeof Te.vars.onLockAxis&&Te.vars.onLockAxis.call(Te,o)),O&&ce===he))return void lt(o)}Te.allowEventDefault||ce&&(!he||ce===he)||!1===o.cancelable||(o.preventDefault(),o.preventManipulation&&o.preventManipulation())}Te.autoScroll&&(Ne=!0),at(e.pageX,e.pageY)}},at=function(e,t){var i=1-Te.dragResistance,n=1-Te.edgeResistance;if(Te.pointerX=e,Te.pointerY=t,ve){var o=Math.atan2(V.y-t,e-V.x)*T,s=Te.y-o;180<s?(m-=360,Te.y=o):-180>s&&(m+=360,Te.y=o),Te.x!==h||Math.abs(m-o)>xe?(Te.y=o,s=h+(m-o)*i):s=h}else{if(ne){var r=e*ne[0]+t*ne[2]+ne[4];t=e*ne[1]+t*ne[3]+ne[5],e=r}(o=t-c)<xe&&o>-xe&&(o=0),(s=e-l)<xe&&s>-xe&&(s=0),(Te.lockAxis||Te.lockedAxis)&&(s||o)&&((r=Te.lockedAxis)||(Te.lockedAxis=r=Se&&Math.abs(s)>Math.abs(o)?"y":be?"x":null)&&"function"==typeof Te.vars.onLockAxis&&Te.vars.onLockAxis.call(Te,Te.pointerEvent),"y"===r?o=0:"x"===r&&(s=0)),s=h+s*i,o=m+o*i}(q||K||ee)&&(Te.x!==s||Te.y!==o&&!ve)?(ee&&(L.x=s,L.y=o,s=(r=ee(L)).x,o=r.y),q&&(s=q(s)),K&&(o=K(o))):v&&(s>b?s=b+(s-b)*n:s<x&&(s=x+(s-x)*n),ve||(o>k?o=k+(o-k)*n:o<D&&(o=D+(o-D)*n))),ve||ne||(s=Math.round(s),o=Math.round(o)),(Te.x!==s||Te.y!==o&&!ve)&&(ve?(Te.endRotation=Te.x=Te.endX=s,G=!0):(be&&(Te.y=Te.endY=o,G=!0),Se&&(Te.x=Te.endX=s,G=!0)),!Te.isDragging&&Te.isPressed&&(Te.isDragging=!0,se(Te,"dragstart","onDragStart")))},lt=function(e,i){if(a&&Te.isPressed&&(!e||null==U||i||!(e.pointerId&&e.pointerId!==U||e.changedTouches&&!function(e,t){for(var i=e.length;-1<--i;)if(e[i].identifier===t)return!0;return!1}(e.changedTouches,U)))){Te.isPressed=!1;var n,s,l,c=e,h=Te.isDragging,d=Te.vars.allowContextMenu&&e&&(e.ctrlKey||2<e.which),u=t.delayedCall(.001,it);if(ie?(Me(ie,"touchend",lt),Me(ie,"touchmove",rt),Me(ie,"touchcancel",lt),Me(w,"touchstart",Pe)):Me(w,"mousemove",rt),Me(w,"mouseup",lt),e&&e.target&&Me(e.target,"mouseup",lt),G=!1,!te||d){if(F(Xe),!ve)for(s=Ee.length;-1<--s;)Q(Ee[s],"cursor",r.cursor||(!1!==r.cursor?"move":null));if(h&&(De=R=E(),Te.isDragging=!1),P--,e){if(C&&(e=J(e,!1)),(n=e.changedTouches)&&((e=n[0])!==z&&e.identifier!==U)){for(s=n.length;-1<--s&&(e=n[s]).identifier!==U;);if(0>s)return}Te.pointerEvent=c,Te.pointerX=e.pageX,Te.pointerY=e.pageY}if(d&&c)c.preventDefault(),c.preventManipulation&&c.preventManipulation(),se(Te,"release","onRelease");else if(c&&!h){if(ae&&(r.snap||r.bounds)&&Qe(r.throwProps),se(Te,"release","onRelease"),(!O||"touchmove"!==c.type)&&-1===c.type.indexOf("cancel")){se(Te,"click","onClick"),300>E()-We&&se(Te,"doubleclick","onDoubleClick");var p=c.target||c.srcElement||o;We=E(),O||c.defaultPrevented||t.delayedCall(1e-5,function(){We!==ue&&Te.enabled()&&!Te.isPressed&&(p.click?p.click():w.createEvent&&((l=w.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,window,1,Te.pointerEvent.screenX,Te.pointerEvent.screenY,Te.pointerX,Te.pointerY,!1,!1,!1,!1,0,null),p.dispatchEvent(l)))})}}else Qe(r.throwProps),C||Te.allowEventDefault||!c||!1===r.dragClickables&&He.call(Te,c.target)||!h||ce&&(!he||ce!==he)||!1===c.cancelable||(c.preventDefault(),c.preventManipulation&&c.preventManipulation()),se(Te,"release","onRelease");return tt()&&u.duration(Te.tween.duration()),h&&se(Te,"dragend","onDragEnd"),!0}e&&(Me(e.target,"change",lt),Te.pointerEvent=c),Le(Ee,!1),se(Te,"release","onRelease"),se(Te,"click","onClick"),te=!1}},ct=function(e){if(e&&Te.isDragging&&!ut){var t=(e=e.target||e.srcElement||o.parentNode).scrollLeft-e._gsScrollX,i=e.scrollTop-e._gsScrollY;(t||i)&&(ne?(l-=t*ne[0]+i*ne[2],c-=i*ne[3]+t*ne[1]):(l-=t,c-=i),e._gsScrollX+=t,e._gsScrollY+=i,at(Te.pointerX,Te.pointerY))}},ht=function(e){var t=E(),i=40>t-We;t=40>t-De;var n=i&&ue===We,o=!!e.preventDefault,s=Te.pointerEvent&&Te.pointerEvent.defaultPrevented,r=i&&pe===We,a=e.isTrusted||null==e.isTrusted&&i&&n;o&&(n||t&&!1!==Te.vars.suppressClickOnDrag)&&e.stopImmediatePropagation(),!i||Te.pointerEvent&&Te.pointerEvent.defaultPrevented||n&&a===r?(Te.isPressed||t||i)&&(o?a&&e.detail&&i&&!s||(e.preventDefault(),e.preventManipulation&&e.preventManipulation()):e.returnValue=!1):(a&&n&&(pe=We),ue=We)},dt=function(e){return ne?{x:e.x*ne[0]+e.y*ne[2]+ne[4],y:e.x*ne[1]+e.y*ne[3]+ne[5]}:{x:e.x,y:e.y}};if((X=ze.get(this.target))&&X.kill(),this.startDrag=function(e,t){if(st(e||Te.pointerEvent,!0),t&&!Te.hitTest(e||Te.pointerEvent)){var i=Ue(e||Te.pointerEvent),n=Ue(o);i=dt({x:i.left+i.width/2,y:i.top+i.height/2}),n=dt({x:n.left+n.width/2,y:n.top+n.height/2}),l-=i.x-n.x,c-=i.y-n.y}Te.isDragging||(Te.isDragging=!0,se(Te,"dragstart","onDragStart"))},this.drag=rt,this.endDrag=function(e){lt(e||Te.pointerEvent,!0)},this.timeSinceDrag=function(){return Te.isDragging?0:(E()-De)/1e3},this.timeSinceClick=function(){return(E()-We)/1e3},this.hitTest=function(e,t){return ze.hitTest(Te.target,e,t)},this.getDirection=function(e,t){var i="velocity"===e&&s?e:"object"!=typeof e||ve?"start":"element";if("element"===i)var n=Ue(Te.target),o=Ue(e);var r="start"===i?Te.x-h:"velocity"===i?s.getVelocity(this.target,ye):n.left+n.width/2-(o.left+o.width/2);return ve?0>r?"counter-clockwise":"clockwise":(t=t||2,i="start"===i?Te.y-m:"velocity"===i?s.getVelocity(this.target,we):n.top+n.height/2-(o.top+o.height/2),r=(n=Math.abs(r/i))<1/t?"":0>r?"left":"right",n<t&&(""!==r&&(r+="-"),r+=0>i?"up":"down"),r)},this.applyBounds=function(e){var t;if(e&&r.bounds!==e)return r.bounds=e,Te.update(!0);if($e(!0),Je(),v){e=Te.x;var i=Te.y;if(e>b?e=b:e<x&&(e=x),i>k?i=k:i<D&&(i=D),Te.x!==e||Te.y!==i){var n=!0;if(Te.x=Te.endX=e,ve?Te.endRotation=e:Te.y=Te.endY=i,G=!0,Xe(!0),Te.autoScroll&&!Te.isDragging)for($(o.parentNode),e=o,N.scrollTop=null!=window.pageYOffset?window.pageYOffset:null!=S.scrollTop?S.scrollTop:w.body.scrollTop,N.scrollLeft=null!=window.pageXOffset?window.pageXOffset:null!=S.scrollLeft?S.scrollLeft:w.body.scrollLeft;e&&!t;)e=(t=Y(e.parentNode))?N:e.parentNode,be&&e.scrollTop>e._gsMaxScrollY&&(e.scrollTop=e._gsMaxScrollY),Se&&e.scrollLeft>e._gsMaxScrollX&&(e.scrollLeft=e._gsMaxScrollX)}Te.isThrowing&&(n||Te.endX>b||Te.endX<x||Te.endY>k||Te.endY<D)&&Qe(r.throwProps,n)}return Te},this.update=function(e,t,i){var n=Te.x,s=Te.y;return Ke(!t),e?Te.applyBounds():(G&&i&&Xe(!0),$e(!0)),t&&(at(Te.pointerX,Te.pointerY),G&&Xe(!0)),Te.isPressed&&!t&&(Se&&.01<Math.abs(n-Te.x)||be&&.01<Math.abs(s-Te.y)&&!ve)&&et(),Te.autoScroll&&($(o.parentNode),Ne=Te.isDragging,Xe(!0)),Te.autoScroll&&(W(o,ct),H(o,ct)),Te},this.enable=function(e){var n;if("soft"!==e){for(n=Ee.length;-1<--n;){var l=Ee[n];Ie(l,"mousedown",st),Ie(l,"touchstart",st),Ie(l,"click",ht,!0),ve||!1===r.cursor||Q(l,"cursor",r.cursor||"move"),Q(l,"touchCallout","none"),Q(l,"touchAction",Se===be?"none":Se?"pan-y":"pan-x"),fe(l)&&Q(l.ownerSVGElement||l,"touchAction",Se===be?"none":Se?"pan-y":"pan-x"),this.vars.allowContextMenu||Ie(l,"contextmenu",Ye)}Le(Ee,!1)}return H(o,ct),a=!0,s&&"soft"!==e&&s.track(ut||o,me?"x,y":ve?"rotation":"top,left"),ut&&ut.enable(),o._gsDragID=e="d"+M++,I[e]=this,ut&&(ut.element._gsDragID=e),t.set(o,{x:"+=0",overwrite:!1,data:"_draggable"}),le={t:o,data:C?gt:o._gsTransform,tween:{},setRatio:C?function(){t.set(o,pt)}:i._internals.setTransformRatio||i._internals.set3DTransformRatio},et(),Te.update(!0),Te},this.disable=function(e){var t,i=Te.isDragging;if(!ve)for(t=Ee.length;-1<--t;)Q(Ee[t],"cursor",null);if("soft"!==e){for(t=Ee.length;-1<--t;){var n=Ee[t];Q(n,"touchCallout",null),Q(n,"touchAction",null),Me(n,"mousedown",st),Me(n,"touchstart",st),Me(n,"click",ht),Me(n,"contextmenu",Ye)}Le(Ee,!0),ie&&(Me(ie,"touchcancel",lt),Me(ie,"touchend",lt),Me(ie,"touchmove",rt)),Me(w,"mouseup",lt),Me(w,"mousemove",rt)}return W(o,ct),a=!1,s&&"soft"!==e&&s.untrack(ut||o,me?"x,y":ve?"rotation":"top,left"),ut&&ut.disable(),F(Xe),Te.isDragging=Te.isPressed=te=!1,i&&se(Te,"dragend","onDragEnd"),Te},this.enabled=function(e,t){return arguments.length?e?Te.enable(t):Te.disable(t):a},this.kill=function(){return Te.isThrowing=!1,t.killTweensOf(ut||o,!0,Ce),Te.disable(),t.set(Ee,{clearProps:"userSelect"}),delete I[o._gsDragID],Te},-1!==ge.indexOf("scroll")){var ut=this.scrollProxy=new Be(o,function(e,t){for(var i in t)void 0===e[i]&&(e[i]=t[i]);return e}({onKill:function(){Te.isPressed&&lt(null)}},r));o.style.overflowY=be&&!Ae?"auto":"hidden",o.style.overflowX=Se&&!Ae?"auto":"hidden",o=ut.content}if(!1!==r.force3D&&t.set(o,{force3D:!0}),ve?Ce.rotation=1:(Se&&(Ce[ye]=1),be&&(Ce[we]=1)),ve){var pt=g,gt=pt.css;pt.overwrite=!1}else me&&(gt=(pt=Se&&be?d:Se?u:p).css,pt.overwrite=!1);this.enable()},je=ze.prototype=new e;je.constructor=ze,je.pointerX=je.pointerY=je.startX=je.startY=je.deltaX=je.deltaY=0,je.isDragging=je.isPressed=!1,ze.version="0.17.0",ze.zIndex=1e3,Ie(w,"touchcancel",function(){}),Ie(w,"contextmenu",function(e){for(var t in I)I[t].isPressed&&I[t].endDrag()}),ze.create=function(e,i){if("string"==typeof e&&(e=t.selector(e)),e&&0!==e.length)if(Ce(e)){var n,o,s=e,r=[],a=s.length;for(n=0;n<a;n++){var l=s[n];if(Ce(l))for(o=0;o<l.length;o++)r.push(l[o]);else l&&0!==l.length&&r.push(l)}s=r}else s=[e];else s=[];for(r=s.length;-1<--r;)s[r]=new ze(s[r],i);return s},ze.get=function(e){return I[(Z(e)||{})._gsDragID]},ze.timeSinceDrag=function(){return(E()-R)/1e3};var Fe={},Ue=function(e,t){if(e===window)return Fe.left=Fe.top=0,Fe.width=Fe.right=S.clientWidth||e.innerWidth||w.body.clientWidth||0,Fe.height=Fe.bottom=(e.innerHeight||0)-20<S.clientHeight?S.clientHeight:e.innerHeight||w.body.clientHeight||0,Fe;if(e.pageX!==t)var i={left:e.pageX-G(),top:e.pageY-V(),right:e.pageX-G()+1,bottom:e.pageY-V()+1};else if(e.nodeType||e.left===t||e.top===t)if(C){var n,o=0,s=0,r=(i=Z(e)).offsetWidth;for(n=i.offsetHeight;i;)o+=i.offsetTop,s+=i.offsetLeft,i=i.offsetParent;i={top:o,left:s,width:r,height:n}}else i=Z(e).getBoundingClientRect();else i=e;return i.right===t&&i.width!==t?(i.right=i.left+i.width,i.bottom=i.top+i.height):i.width===t&&(i={width:i.right-i.left,height:i.bottom-i.top,right:i.right,left:i.left,bottom:i.bottom,top:i.top}),i};return ze.hitTest=function(e,t,i){if(e===t)return!1;e=Ue(e);var n=(t=Ue(t)).left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top;if(n||!i)return!n;n=-1!==(i+"").indexOf("%"),i=parseFloat(i)||0;var o=Math.max(e.left,t.left),s=Math.max(e.top,t.top);return o=Math.min(e.right,t.right)-o,s=Math.min(e.bottom,t.bottom)-s,!(0>o||0>s)&&(n?(i*=.01,(n=o*s)>=e.width*e.height*i||n>=t.width*t.height*i):o>i&&s>i)},A.style.cssText="visibility:hidden;height:1px;top:-1px;pointer-events:none;position:relative;clear:both;",ze},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()();class AnimateServer extends BaseServer{constructor(){super("animate"),this.options={paused:!1,ease:Linear.easeNone},this.tlArr=[],this.devTool=null}get animateDebug(){return this.callState("animateDebug")}setAnimateDebug(e){this.callMutation("setAnimateDebug",e),this.dispatchEvent({type:"animateDebug"})}init(e,t){this._listeners&&this._listeners.animateDebug||this.addEventListener("animateDebug",e=>{this.animateDebug?this.createDevTool():this.killDevTool()}),this.setAnimateDebug(e.animateDebug)}createTl(e){this.options.id="AnovTimeline";let t=new TimelineMax(this.options);return this.tlArr.push(t),t._path=e.path,t._labels=e.tlConfig&&e.tlConfig.labels||{},t._type=e.tlConfig&&e.tlConfig.type||"enter",t}getCurrentRouteTl(e="enter"){let t=this.getCurrentContext().$router.currentRoute.path;return this.tlArr.filter(e=>e._path==t).find(t=>t._type==e)}createDevTool(e="#con"){let t=this.getCurrentRouteTl();this.devTool=GSDevTools.create({globalSync:!1,hideGlobalTimeline:!0,animation:t,container:e})}killDevTool(){this.devTool&&(this.devTool.kill(),this.devTool=null)}restart(){this.getCurrentRouteTl().restart()}getById(e="",t="enter"){return this.getCurrentRouteTl().getChildren().find(t=>t.vars.id==e)}}let animateServer=new AnimateServer;function changeThemeByFilter(e,t){let{blur:i=0,brightness:n,contrast:o,grayscale:s,hueRotate:r,invert:a,opacity:l,saturate:c,sepia:h=0}=t;if("string"==typeof e&&(e=document.querySelector(e)),e instanceof HTMLElement){let t=`blur(${i}px) brightness(${n}%) contrast(${o}%) grayscale(${s}%) hue-rotate(${r}deg) invert(${a}%) opacity(${l}%) saturate(${c}%) sepia(${h}%)`;e.style.setProperty("filter",t),e.style.setProperty("transition","filter ease 0.3s")}}class ThemeServer extends BaseServer{constructor(){super("theme")}init(e){this.callMutation("initTheme",e.themes);const t=e.currentThemeValue;this.callMutation("setTheme",t)}addTheme(e){this.callMutation("addTheme",e)}deleteTheme(e){this.callMutation("deleteTheme",e)}modifyTheme(e){this.callMutation("modifyTheme",e)}modifyThemeName(e){this.callMutation("modifyThemeName",e)}setTheme(e){this.callMutation("setTheme",e),this.addInfo(`set theme ${e}`)}applyTheme(e,t){t?changeThemeByFilter(e,t):console.warn("You have to pass the config")}next(){const e=this.getState(),t=e.currentThemeValue,i=e.themes.length;let n=e.themes.findIndex((e,i)=>e.value===t);++n<=i-1?this.setTheme(e.themes[n].value):this.setTheme(e.themes[0].value)}prev(){const e=this.getState(),t=e.currentThemeValue,i=e.themes.length;let n=e.themes.findIndex((e,i)=>e.value===t);--n>=0?this.setTheme(e.themes[n].value):this.setTheme(e.themes[i-1].value)}adjust(e,t){const i=this.getState(),n=i.currentThemeValue,o=i.adjThemeValue;let s;if(n===o){s=i.themes.filter(e=>e.value===n)[0].config}else s=i.adjTheme;Object.assign(s,t),this.applyTheme(e,s),this.callMutation("setAdjThemeValue"),this.callMutation("setAdjTheme",s)}}const themeServer=new ThemeServer;class PageServer extends BaseServer{constructor(){super("page"),this.num=0}init(e){let t=cloneDeep(e);this.callMutation("setPage",t),this.getRoutes()}get allPages(){return this.callState("pages")}getPageByPath(e){return this.allPages.find(t=>t.path===e)}deletePart(e){if(!e)return;let t=this.getCurrentContext().$router.currentRoute.path;this.callMutation("deletePart",{path:t,id:e})}resetPart(e){if(!e)return;let t=this.getCurrentContext().$router.currentRoute.path;this.callMutation("resetPart",{path:t,id:e})}changePart(e){let t=this.getCurrentContext().$router.currentRoute.path;this.callMutation("changePart",{path:t,part:e})}getRoutes(){let e=this.getCurrentContext();this.routes=cloneDeep(e.$router.options.routes),this.routes.forEach((e,t)=>{"/"!=e.path&&"*"!=e.path||this.routes.splice(t,1)})}go(e=1){let t=this.getCurrentContext(),i=t.$router.currentRoute.path;this.routes.forEach((t,n)=>{t.path==i&&(1!=e&&-1!=e&&(e=1),this.num=n+e)}),this.num==this.routes.length&&(this.num=0),-1==this.num&&(this.num=this.routes.length-1);let n=this.routes[this.num].path;t.$router.push({path:n})}goTo(e=1){let t=this.getCurrentContext();this.num=e-1,NaN==this.num&&(this.num=0),this.num==this.routes.length&&(this.num=0),-1==this.num&&(this.num=this.routes.length-1);let i=this.routes[this.num].path;t.$router.push({path:i})}goByNameText(e){let t=this.routes.find(t=>t.nameText==e);t&&this.getCurrentContext().$router.push({path:t.path})}handleInfo(e={}){let t=e.to&&e.to.path;if(!t)return void this.addWarn("没有路由path");let i=this.routes.find(e=>e.path==t);if(!i)return void this.addWarn(`${t}匹配路由失败`);let n=i.path,o=i.nameText;this.addInfo(`页面路由切换到${o}(${n})`)}}let pageServer=new PageServer;class SoundServer extends BaseServer{constructor(){super("sound"),this.soundsOptions=[],this.soundsLoad=!1,this.soundsLoadNum=0,this.soundsNum=0,this.config={},this.howler=Howler,this.changeSoundsArr=[]}addChangeSounds(){this.changeSoundsArr=[];let e=this.config.soundsSrc;for(let t in e)this.changeSoundsArr.push(t)}changeSounds(e){let t=e||1,i=this.changeSoundsArr.length;for(let e=0;e<i;e++)if(this.changeSoundsArr[e]==this.soundsType){let n=e+t;n==i&&(n=0),-1==n&&(n=i-1),this.soundsType=this.changeSoundsArr[n];break}}changeVolume(e){this.howler.volume(e)}getVolume(){return this.howler.volume()}changeIsSoundOpen(){this.isSoundOpen=!this.isSoundOpen}set isSoundOpen(e){this.callMutation("setIsSoundOpen",e),e&&this.initPlayer()}get isSoundOpen(){return this.callState("isSoundOpen")}set soundsType(e){this.callMutation("setSoundsType",e),this.dispatchEvent({type:"soundsType"})}get soundsType(){return this.callState("soundsType")}init(e){this.config=Object.assign({},e),this.soundsType=this.config.soundsType,this.isSoundOpen=this.config.isSoundOpen,this.addChangeSounds(),this._listeners&&this._listeners.soundsType||this.addEventListener("soundsType",e=>{this.isSoundOpen&&(this.howler.unload(),this.initPlayer()),this.addInfo("sound type is changed")})}initPlayer(){this.soundsOptions=[],this.soundsNum=this.config.soundOpt.length;try{this.config.soundOpt.forEach(e=>{if(this.config.soundsSrc[this.soundsType][e.type],this.config.soundsSrc[this.soundsType][e.type]){let t=this.config.soundsSrc[this.soundsType][e.type];this.soundsOptions.push({type:e.type,src:t})}})}catch(e){this.addError(e),console.error(e)}this.createPlayer(this.soundsOptions)}createPlayer(e){e.forEach(e=>{this[e.type]=new Howl({src:e.src,onload:this._load,onplay:this._onplay,onloaderror:this._loaderror,onplayerror:this._playerror,html5:!0}),this[e.type]._soundsType=e.type})}_load(){soundServer.soundsLoadNum++,soundServer.soundsLoadNum==soundServer.soundsNum&&(soundServer.soundsLoad=!0)}_loaderror(e,t){soundServer.addError("sound file "+this._src+" load error"),soundServer.soundsNum--}_onplay(e){this._prevPlayId=e}_playerror(e,t){soundServer.addError("sound file "+this._src+" play error")}_validate(e){let t=!0;return this.isSoundOpen?this[e]?t:(this.addWarn(e+" sound do not exist"),t=!1):t=!1}play(e){let t=e.type;if(this._validate(t)){if(!e.duration)return this[t].play();if(-1==e.duration){let e=this[t].play();return this[t].loop(!0,e),e}return 1e3*this[t]._duration<=e.duration&&(e.duration=1e3*this[t]._duration),this[t]._sprite={__default:[0,1e3*this[t]._duration],playTime:[0,e.duration]},this[t].play("playTime")}}stop(e){if(!e)return void this.howler._howls.forEach(e=>{e.stop()});let t=e.type,i=e.id;t?i?this[t].stop(i):this[t]&&this[t].stop():this.isSoundOpen&&this.addWarn("sound type do not exist")}volume(e){let t=e.type,i=e.vol||1;this._validate(t)&&this[t].volume(i)}fade(e){let t=e.type,i=e.from||1,n=e.to||1,o=e.duration||500;this._validate(t)&&this[t].fade(i,n,o)}}let soundServer=new SoundServer;const eventType$9={process:"process",completed:"completed"};class PreloadServer extends BaseServer{constructor(){super("preload"),this._preloadList=[]}get allCount(){return this._preloadList.length}get completeCount(){return this._preloadList.filter(e=>e.isload).length}get isComplete(){return this.callState("isComplete")}set isComplete(e){this.callMutation("setIsComplete",e)}init(e){this.isComplete=!1}add(e){e.name?e.load?this._preloadList.push(e):this.addError("预加载资源:"+e.name+",load方法未实现。"):this.addError("预加载资源name属性为空或未实现。")}load(){this._preloadList.map(e=>{Object.assign(e,{isload:!1,complete:this._onPreloadObjCompleteCallback.bind(this)}),e.load()})}_onPreloadObjCompleteCallback(e){e.isload=!0,this.dispatchEvent({type:eventType$9.process,result:{name:e.name,allCount:this.allCount,completeCount:this.completeCount}}),this.allCount==this.completeCount&&(this.isComplete=!0,this.dispatchEvent({type:eventType$9.completed}),this.addInfo(this.allCount+"个资源加载完成"))}}const preloadServer=new PreloadServer,AES=CryptoJS__default.AES,UTF8=CryptoJS__default.enc.Utf8,key="anov@2019";let _IS_VALIDATE=!1,heartbeatTime=null;const heartbeatTimeSpan=3e3,evnetType={pass:"pass",noPass:"noPass",expireDay:"expireDay"};class LicenseServer extends BaseServer{constructor(){super("license")}get code(){return this.callState("code")}set code(e){this.callMutation("setCode",e),this.validate()}init(e){let t=this._extractConfig(e);this.code=t.code}validate(){let e={isValid:!0,message:"验证通过"};try{this.obj=this._getLicenseObj(),window.__ANOV__PROJECT={projectId:this.obj.projId||"",projectName:this.obj.projName||"",copyright:this.obj.copyright||""}}catch(t){return this.addError("code decrypt error"),e.isValid=_IS_VALIDATE=!1,e.message="无效的许可证",this.dispatchEvent({type:evnetType.noPass,result:e}),e}if(this.obj.dueDate&&!this._validateTime())return this.addError("_validateTime"),e.isValid=_IS_VALIDATE=!1,e.message="无效的许可证",this.dispatchEvent({type:evnetType.noPass,result:e}),e;if(this.obj.hosts&&!this._validateHost())return this.addError("_validateHost"),e.isValid=_IS_VALIDATE=!1,e.message="无效的许可证",this.dispatchEvent({type:evnetType.noPass,result:e}),e;if(!this._validateProject())return this.addError("_validateProject"),e.isValid=_IS_VALIDATE=!1,e.message="无效的项目许可证",this.dispatchEvent({type:evnetType.noPass,result:e}),e;_IS_VALIDATE=!0,this.dispatchEvent({type:evnetType.pass,result:e});let t=this._expireDay();this.callMutation("setExpireDay",t),this.callMutation("setDueDate",this.obj.dueDate);let i="warn";return 1===t&&(i="error"),t<5&&this.dispatchEvent({type:evnetType.expireDay,result:{type:i}}),e}_validateTime(e){return new Date<new Date(this.obj.dueDate)}_validateHost(){return!this.obj.hosts||!compact(this.obj.hosts).length}_validateUser(e,t){return this.obj.user.name.toLowerCase()==e.toLowerCase()&&this.obj.user.pwd==t}_getLicenseObj(){let e=AES.decrypt(this.code,key).toString(UTF8);return JSON.parse(e)}_expireDay(){let e=new Date(this.obj.dueDate).getTime()-(new Date).getTime();return Math.floor(e/864e5)}_validateProject(){var e=document.getElementById("projectName");let t=document.getElementById("copyright");return __ANOV__ENV.projectId==__ANOV__PROJECT.projectId&&__ANOV__ENV.projectName==__ANOV__PROJECT.projectName&&__ANOV__ENV.copyright==__ANOV__PROJECT.copyright&&__ANOV__PROJECT.projectName===document.title&&e&&e.innerText===__ANOV__PROJECT.projectName&&t&&t.innerText===__ANOV__PROJECT.copyright}heartbeat(){heartbeatTime=setTimeout(()=>{this.heartbeat();let e=document.getElementById("appLoading");if(!_IS_VALIDATE&&e&&"none"==e.style.display)try{let e=this.getCurrentContext().partServer.getCompByTagName("validPeriod");if(e&&e.length>0){let e=document.querySelector(".valid-period"),t=document.querySelector(".valid-period-wrapper"),i=document.getElementById("app");(!e||!t||""!=e.style.display&&"block"!=e.style.display||t.innerText.indexOf("无效的")<0||"blur(10px)"!=i.style.filter)&&(this._validateProject()?this.__c("E012001:Invalid license, system load failed"):this.__c("E012004:Invalid project license"))}else this.__c("E012002:Invalid license, system not loaded properly")}catch(e){this.__c("E012003:Invalid license,"+e.message)}else this._validateProject()||this.__c("E012004:Invalid project license")},heartbeatTimeSpan)}__c(e){clearTimeout(heartbeatTime);let t=`<body style="\n    background: #300;\n"><div style="font-size:30px;color:#d44;padding:20px;border-bottom: 1px solid;">ANOV无效的许可证!<br>${e}</div>\n<p style="\n    color: #999;\n    padding: 0 30px;\n    width: 400px;\n    word-wrap: break-word;\n    word-break: normal;\n    height: 300px;\n">${this.code} </p>\n<div style="\n    border-top: 1px solid #d44;\n    color: #d44;\n    padding: 30px;\n">联系管理员：朱润亚\n    <p>微信&amp;电话:18610279719</p>\n    <p>邮箱:zhu18@vip.qq.com</p>\n</div></body>`;document.write(t)}}const licenseServer=new LicenseServer;setTimeout(()=>{try{app.$on(app.EventType.ready,()=>{app.licenseServer.heartbeat()})}catch{}},0);const eventType$a={onOpen:"onOpen",onClose:"onClose"};class SystemCheckServer extends BaseServer{constructor(){super("systemCheck")}get defaultParams(){return this.callState("defaultParams")}set defaultParams(e){this.callMutation("setDefaultParams",e)}init(e){let t=this._extractConfig(e);this.defaultParams=t}get isSystemCheckOpen(){return this.callState("isSystemCheckOpen")}set isSystemCheckOpen(e){this.callMutation("setIsOpen",e)}open(){this.callMutation("setIsOpen",!0),this.dispatchEvent({type:eventType$a.onOpen}),this.addInfo("系统自检开启")}close(){this.callMutation("setIsOpen",!1),this.dispatchEvent({type:eventType$a.onClose})}}const systemCheckServer=new SystemCheckServer;var throttle=require("lodash.throttle");class SizeAdapt{constructor(e){Object.assign(this,{sizeEqualRatio:!1,w:1920,h:1080,wrapSelector:"",domSelector:"body",left:"m",top:"m",isResize:!0,resizeCallback:null},e),this.isResize&&window.addEventListener("resize",throttle(this.resize.bind(this),300))}resize(){let e=document.querySelector(this.wrapSelector),t=document.querySelector(this.domSelector);if(!e||!t)return;t.style.position="absolute",t.style.width=this.w+"px",t.style.height=this.h+"px";let i,n,o,s,r=this.wrapSelector?e.clientWidth:document.body.clientWidth,a=this.wrapSelector?e.clientHeight:document.body.clientHeight,l=Math.min(r/this.w,a/this.h);if(this.sizeEqualRatio){switch(t.style.transform="scale("+l+")",this.top){case"m":n=(a-this.h)/2+"px";break;case"t":n=this.h*(l-1)/2+"px";break;case"b":s=this.h*(l-1)/2+"px"}switch(this.left){case"m":i=(r-this.w)/2+"px";break;case"l":i=this.w*(l-1)/2+"px";break;case"r":o=this.w*(l-1)/2+"px"}}else t.style.transform="scale("+r/this.w+","+a/this.h+")",i=this.w*(r/this.w-1)/2+"px",n=this.h*(a/this.h-1)/2+"px";n?t.style.top=n:t.style.bottom=s,i?t.style.left=i:t.style.right=o,this.resizeCallback&&"function"==typeof this.resizeCallback&&this.resizeCallback(l)}updateAdapt(e={}){Object.assign(this,e),this.resize()}}class SizeAdaptServer extends BaseServer{constructor(){super("sizeAdapt")}create(e){return new SizeAdapt(e)}}let sizeAdaptServer=new SizeAdaptServer;const weather={rain(e){const t=document.querySelector(e.dom);if(!t)return;const i=e.count||1500,n=document.createElement("canvas");n.id="weather_rain",n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.zIndex=e.index||1,n.style.pointerEvents="none",t.appendChild(n);const o=n.getContext("2d");function s(e){n.width=t.offsetWidth,n.height=t.offsetHeight,n.style.width=n.width+"px",n.style.height=n.height+"px"}window.addEventListener("resize",()=>{s()},!1),s();class r{constructor(e,t,i,n,o,s){this.height=e,this.width=t,this.startPositionX=i,this.startPositionY=n,this.currentPositionY=n,this.speed=o,this.colorOpacity=s}draw(){o.beginPath(),o.moveTo(this.startPositionX,this.currentPositionY),o.lineTo(this.startPositionX,this.currentPositionY+this.height),o.strokeStyle="rgba(150, 150, 150, "+this.colorOpacity+")",o.lineWidth=this.width,o.stroke(),this.update()}update(){this.currentPositionY+this.height>n.height?this.currentPositionY=0:this.currentPositionY+=this.speed}}const a=[];for(let e=0;e<i;e++)a.push(new r(Math.round(20*Math.random())+10,Math.round(20*Math.random())/10,Math.round(Math.random()*n.width),Math.round(Math.random()*n.height),Math.round(15*Math.random())+5,.5*Math.random()));!function e(){requestAnimationFrame(e),o.clearRect(0,0,n.width,n.height),o.lineJoin="round";for(let e=0;e<a.length;e++)a[e].draw()}()},snow(e){const t=document.querySelector(e.dom);e.count;if(!t)return;let i={current:0,force:.1,target:.1,min:.1,max:.25,easing:.005};new class{constructor(t,i={}){i=Object.assign({antialias:!1,depthTest:!1,mousemove:!1,autosize:!0,side:"front",vertex:"\n            precision highp float;\n    \n            attribute vec4 a_position;\n            attribute vec4 a_color;\n    \n            uniform float u_time;\n            uniform vec2 u_resolution;\n            uniform vec2 u_mousemove;\n            uniform mat4 u_projection;\n    \n            varying vec4 v_color;\n    \n            void main() {\n    \n              gl_Position = u_projection * a_position;\n              gl_PointSize = (10.0 / gl_Position.w) * 100.0;\n    \n              v_color = a_color;\n    \n            }",fragment:"\n            precision highp float;\n    \n            uniform sampler2D u_texture;\n            uniform int u_hasTexture;\n    \n            varying vec4 v_color;\n    \n            void main() {\n    \n              if ( u_hasTexture == 1 ) {\n    \n                gl_FragColor = v_color * texture2D(u_texture, gl_PointCoord);\n    \n              } else {\n    \n                gl_FragColor = v_color;\n    \n              }\n    \n            }",uniforms:{},buffers:{},camera:{},texture:null,onUpdate:()=>{},onResize:()=>{}},i);const n=Object.assign({time:{type:"float",value:0},hasTexture:{type:"int",value:0},resolution:{type:"vec2",value:[0,0]},mousemove:{type:"vec2",value:[0,0]},projection:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},i.uniforms),o=Object.assign({position:{size:3,data:[]},color:{size:4,data:[]}},i.buffers),s=Object.assign({fov:60,near:1,far:1e4,aspect:1,z:100,perspective:!0},i.camera),r=document.createElement("canvas"),a=r.getContext("webgl",{antialias:i.antialias});if(r.id="weather_snow",r.style.position="absolute",r.style.zIndex=e.index||1,r.style.pointerEvents="none",!a)return!1;this.count=0,this.gl=a,this.canvas=r,this.camera=s,this.holder=t,this.onUpdate=i.onUpdate,this.onResize=i.onResize,this.data={},t.appendChild(r),this.createProgram(i.vertex,i.fragment),this.createBuffers(o),this.createUniforms(n),this.updateBuffers(),this.updateUniforms(),this.createTexture(i.texture),a.enable(a.BLEND),a.enable(a.CULL_FACE),a.blendFunc(a.SRC_ALPHA,a.ONE),a[i.depthTest?"enable":"disable"](a.DEPTH_TEST),i.autosize&&window.addEventListener("resize",e=>this.resize(e),!1),i.mousemove&&window.addEventListener("mousemove",e=>this.mousemove(e),!1),this.resize(),this.update=this.update.bind(this),this.time={start:performance.now(),old:performance.now()},this.update()}mousemove(e){let t=e.pageX/this.width*2-1,i=e.pageY/this.height*2-1;this.uniforms.mousemove=[t,i]}resize(e){const t=this.holder,i=this.canvas,n=this.gl,o=this.width=t.offsetWidth,s=this.height=t.offsetHeight,r=this.aspect=o/s,a=devicePixelRatio;i.width=o*a,i.height=s*a,i.style.width=o+"px",i.style.height=s+"px",n.viewport(0,0,o*a,s*a),n.clearColor(0,0,0,0),this.uniforms.resolution=[o,s],this.uniforms.projection=this.setProjection(r),this.onResize(o,s,a)}setProjection(e){const t=this.camera;if(t.perspective){t.aspect=e;const i=t.fov*(Math.PI/180),n=Math.tan(.5*Math.PI-.5*i),o=1/(t.near-t.far),s=[n/t.aspect,0,0,0,0,n,0,0,0,0,(t.near+t.far)*o,-1,0,0,t.near*t.far*o*2,0];return s[14]+=t.z,s[15]+=t.z,s}return[2/this.width,0,0,0,0,-2/this.height,0,0,0,0,1,0,-1,1,0,1]}createShader(e,t){const i=this.gl,n=i.createShader(e);if(i.shaderSource(n,t),i.compileShader(n),i.getShaderParameter(n,i.COMPILE_STATUS))return n;console.log(i.getShaderInfoLog(n)),i.deleteShader(n)}createProgram(e,t){const i=this.gl,n=this.createShader(i.VERTEX_SHADER,e),o=this.createShader(i.FRAGMENT_SHADER,t),s=i.createProgram();i.attachShader(s,n),i.attachShader(s,o),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)?(i.useProgram(s),this.program=s):i.deleteProgram(s)}createUniforms(e){const t=this.gl,i=this.data.uniforms=e,n=this.uniforms={};Object.keys(i).forEach(e=>{i[e].location=t.getUniformLocation(this.program,"u_"+e),Object.defineProperty(n,e,{set:t=>{i[e].value=t,this.setUniform(e,t)},get:()=>i[e].value})})}setUniform(e,t){const i=this.gl,n=this.data.uniforms[e];switch(n.value=t,n.type){case"int":i.uniform1i(n.location,t);break;case"float":i.uniform1f(n.location,t);break;case"vec2":i.uniform2f(n.location,...t);break;case"vec3":i.uniform3f(n.location,...t);break;case"vec4":i.uniform4f(n.location,...t);break;case"mat2":i.uniformMatrix2fv(n.location,!1,t);break;case"mat3":i.uniformMatrix3fv(n.location,!1,t);break;case"mat4":i.uniformMatrix4fv(n.location,!1,t)}}updateUniforms(){this.gl;const e=this.data.uniforms;Object.keys(e).forEach(t=>{const i=e[t];this.uniforms[t]=i.value})}createBuffers(e){this.gl;const t=this.data.buffers=e,i=this.buffers={};Object.keys(t).forEach(e=>{const n=t[e];n.buffer=this.createBuffer("a_"+e,n.size),Object.defineProperty(i,e,{set:i=>{t[e].data=i,this.setBuffer(e,i),"position"==e&&(this.count=t.position.data.length/3)},get:()=>t[e].data})})}createBuffer(e,t){const i=this.gl,n=this.program,o=i.getAttribLocation(n,e),s=i.createBuffer();return i.bindBuffer(i.ARRAY_BUFFER,s),i.enableVertexAttribArray(o),i.vertexAttribPointer(o,t,i.FLOAT,!1,0,0),s}setBuffer(e,t){const i=this.gl,n=this.data.buffers;(null!=e||i.bindBuffer(i.ARRAY_BUFFER,null))&&(i.bindBuffer(i.ARRAY_BUFFER,n[e].buffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(t),i.STATIC_DRAW))}updateBuffers(){this.gl;const e=this.buffers;Object.keys(e).forEach(t=>e[t]=buffer.data),this.setBuffer(null)}createTexture(e){const t=this.gl,i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),this.texture=i,e&&(this.uniforms.hasTexture=1,this.loadTexture(e))}loadTexture(e){const t=this.gl,i=this.texture,n=new Image;n.onload=(()=>{t.bindTexture(t.TEXTURE_2D,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}),n.src=e}update(){const e=this.gl,t=performance.now(),i=(t-this.time.start)/5e3,n=t-this.time.old;this.time.old=t,this.uniforms.time=i,this.count>0&&(e.clear(e.COLORBUFFERBIT),e.drawArrays(e.POINTS,0,this.count)),this.onUpdate(n),requestAnimationFrame(this.update)}}(t,{depthTest:!1,texture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGAGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTUtMDctMDNUMTg6NTk6MjIrMDI6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmIzMzBlMWI0LTk5ZDctNGU2NS05MGQ2LTNmYjFiYmE2ZTE0MCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjAyNThjNzMxLTQ4ZjQtYTA0MS1hNGFkLTQ4MTA2MTVjY2FlYSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjJjY2VkMTUyLTRjNzAtNDFlZC1hMzcyLWRlOWY4NjgyZTcwMSI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MmNjZWQxNTItNGM3MC00MWVkLWEzNzItZGU5Zjg2ODJlNzAxIiBzdEV2dDp3aGVuPSIyMDE1LTA3LTAzVDE4OjU5OjIyKzAyOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YjMzMGUxYjQtOTlkNy00ZTY1LTkwZDYtM2ZiMWJiYTZlMTQwIiBzdEV2dDp3aGVuPSIyMDE5LTAxLTEyVDE1OjE0OjQwKzAxOjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz50mbqsAAAToElEQVR4nOVbW49dR5X+VlXtc2v3Ne52N6bTTnAc0u02GRJQwEhYQkJ5QhmhPPOUl0iBB/4AP4JfMA95IEIaJEYiQhlesCZMEE1iGxJHIjK21XbSwX1xd5+zd9Va87BrVdfefWwI4xEaUVJpn7PPPnVqfbUu31pVh0QE/8zN/KMn8I9uTl+8+uqrAAARgYgghIBer4dnnnkGAPDFL34RANDr9eiJJ55AVVUgIhhjwMwYDAbY3Nyk8+fPP/DHdnd3ZWtrS6y1ICICACLCtWvXxDmH2dlZXL9+HR988AF6vR5mZmawvb2Nw8NDeO+xt7eHpaUlDAYDTE5O4vvf/z7OnTuH1157DR9++CGICNvb2zh58iTubG7iwrP/gvmz61iZG2B5aQG/+e93MDExgW9/+9vHAcgbEWFvbw+Tk5O0uLiIEydOyPnz52lychL9fj89BgD7+/s0MTGh4KT749rU1JRMTU3p22R7y8vL2N3dTWPs7e3JnTt3sLW1BWvtAwF9FK0BQFwUfPLJJ5ibm8Mrr7yiGqCmkgtHZVni4OCAJiYmCAAiEA0AmBlEpGPnDoez1wqMrK2tydraGr333nu4evUqfv/730tZluh2u405PqqWABgOhwCAnZ0dLCws4Ec/+hGdOnUqf5ZEhA4ODtDr9chaS51OB/Pz84QjoRsA6bjOOel0OknY7HMBgL/85S8yGo1kYWEB1loCIBcuXMCFCxdkfX2dNjY25J133sH9+/chIo8UhATA5z//eRweHmJxcRHf+973iIioqioURaGTNQBQlqWJq2GYGWVZUq/XGwcCAVCTkUxg7UDUgtnZWd7e3hZmhrVWkGnH+vo61tfX8eUvfxlvvPGG3Lx5E8vLy8hM6dEA0Ov1MBwO8eKLL+Lpp5/GRx99hLm5ORXGACAiotnZWROFIQDGGJNee+8hIlQURVqibLUku2pnAEJEZnZ2VoXmDKwExPnz57G8vIxf/epXuHXrlnz88ccoyxLe+/+VRiQA7t+/j+npaaytrREAeuKJJ/SjXGACQCEEIyLGOWc6nQ6h1gZTVZWJqv6g8MoAwMwiImyt5UxQ7TlIlIMwPT2Nl156SXZ3d+nKlSuoqkq2t7f/buEbADjncOnSJXrssceAphorABARC8CIiBERKyI2hGCcc0REptPpGGttDhhCCClc5gKKSC50qKqKrbVsjMnvqzbw7u6uMDPNzMzw1NSUXLx4ET/5yU/o5s2b8t5772E0GmFycvIz+4gEwNmzZ/H0008DqD33cDikfr9vNFwDMGVZWmutcc5ZAE5EbDQBS0QqvEF0mAAoCq5NALAxRlqCBmstExEDCLHrZwIgFEUhckRbBQBefvllAYC3334bV65ckY2NDezv738mEBIA3nuMRiOgVmfa39+nbrdL0SsbAKbT6Zi46tZaa4nIEpGN49j4nI2AkYiYLAQmAFQoACwiLCKBiAIRBQA+jqNgMADq9/v63mZjAABeeOEFvPDCC3Tt2jV5/fXX5U9/+hMI+Js4RFoe51yK1c45zM/P58ITAENExtRL6mIvAHS0i0iXmbsAekTUN8b0AfRFpA+gD2AQez+79gD0RETH6cZrkf1GfjUP6FhbW6Mf/OAHeOmll6jb7WBrawvAw7lD0oAzZ86gFfeBzNtrZ2Zna2gLEXFRAwpmLuJnyT+ISMQr+ZTc+wcAuvIetUlV8bVFUxNyZxiy9/l4BAALCwvmu9/9rpxZWaH/evs3Mqw8HpbvJQDW19d1xfPeBsEyswVQeO+dtdZZa9NqWWsLAI6IHOoQaVpjHQMgdi8iPgJQReHzbgFU2ULo9/JQmfMLPPf881j/0pfk3376H9gyI6ycXnw4ALOzs+lmCIEODg7oxIkThohoOBxSp9MxRGSdczZGA0tEBWpNKIwxHX0dx3XRB+QAAE0foDbviaiKwBVRWO3Wex9ql0MBzbAcsnFzcAFAOkVBFy88hW63J1UIGJf6JwCuXLmC9fV1AIAxBv1+H0QEESEiMsxs1NMTke10OiqkE5GO2rAxJtksERkRMaj9R1sLfJysB1CFEEpjjGqA+hiDWrPK+H3ViFxLc2eZTEHbM6trAIB3331XNOEaC8DCwoK+JCKCc47ia1Lq2+oWtboXRFREALpxzA4Ruegj9FnDzDDGCABmZjbGqPqXOFr5Ml5HqE2uin6mxFGk0V4B4LIsiYh8pO05yBxCECLC4uIiXbp0SbJstgnA3t5e7gTbbrNBf9sgKBCoTSBFBUSugMgTAGiMlizmewClMcYDGMXvlxHUMgpeZgInrhEB9Vm48/GawuSNGzdodnYWp06dEu89QsitJgMgQ08R1FhOIQTKihgkIoaZrTEm8QARSUCISBf1ihbRri1iGG0BwKjtvxOFdHoVERdC0N8wkVjlpqTFG2nFe5/P//Tp0+JcLeb169dxeHiI55577jgAjz/+OFqt7TFyDSBmJiIyquIRgEJVH7UZFDiK3xoZdPICgDOvn6/2iIg03ObEikSEtAoVgcznKXF+6V6321VtoNXVVezs7DTkSkRoc3OzDUAtde0PGmSCiKgoCiIiik6uZkiRJEWG6IhInWNXRHpE1ENNfnJSNJFdJwBMiMgEgAkiGhCRPt8D0DPGdBVcZi7UxHDcR7XDOLz3+POf/9yQb5wT1C8pomNbCAHMTDE85TTYoqUJiOaAOpHK9VWjQRE5gM3GyHMKAIAxRqQOS0xE4pxrpMwA2HtvALA68Vwea60sLy+PB+Djjz/G5z73OZ1UTiqkqiohImFmFEUhRCTGmLzUlTcTBVWTKBBXTBki1U1/i1E7N/UVyi5T0RS1xQgza/1gXBrNcXyOmsg4YpLQsbz3qRLVAGB+fr4tCLz3IiKKtMQQJnEwtb8crBQ6lT/ESSQHSURKpAT1CodoLho2rSZRugAikjLFzHmGOG6izhlXaZOvJPTJkyePrRYAIBYWGiqvzEmFNcao0ByLGg1NyX8w8w+5eeRa0RWRDhF1Ee0bNY9QX6G9LyI9EenGZ/NESbsFoKm6EREzGo00cjR8wc7OTgOApAFxdRt1u6IokpqJCHvvWfN2XRGuwwFnK5OnqkkTMmflEHlBZgYBRyGONFTGz5jqBCnPFRwAx8zqcBt+AwBFx50zRgFAw+FQpqenjwNw9+5ddLtdnDhxQifV6MwsRMTGGGHmRkEjqjFHVU3fia9T+IwTUpMw2cRyz60rlhMl1ZqCmQuKeUO09UTTs/HbJqBNBoNB40YygY2NDezt7Y35Tj0Zay0751hEQqSwqefvY4Ejd1LqM6B5QeyaMjsR0SQq74lRRqKkxKqgZhGmHQa1RjkWhHY+kDTga1/7mjrCdtUWcSD23jMRBWttyuSIqBIRVVEPwBtjqgyMoGGrsRS1o1M75YzhtWlyyjjj1ajKM7OlukjTSOOJKGe2DSBipEstacCPf/xjvPnmm405olV0cM6FWMkNAEIIIYhIEJHAzIGIfLRXBScvdXE0k6QRes1UN88xbKYx6jPymoQxxhiKmWrm8Nr1jEbb399vvE8a8Morr2Bubi53hNpUCwxqLQjW2hALGAFHK14BqJi5QqYZCkh8VkFgHK16Hu/y0Jm/TnZtjEkFV2amGgP6mwuhmhdoSxrQ6XRw69YtfPjhh+3vNKo41tpUxnLOqVfOe+L0+WfRcWnxI2lF5i8Sr49JzrjKlIKUkyS9Nljj39oSHLdu3UJZlpiammonFzqohiolJKmaE4X0AKpcG3CU4alj03Q2D1mIgqUQqpEk4yH6TEPAfMVzkhaf1Wca9733yFsC4Jvf/Ga6eePGDSwuLkq3202/EEKQw8ND7vV6wTmXfIBGgBBCZa11RKQakKe4eVZIOMrwEAE1aDo/NRENs6nFvcNxPckOQEII4r3XLfvU2u+PbWHdvXsXP/vZz2R3d7fxAzEfYOeclrG8McZHx1dZa0sAlYhUrUKG9rFmgjHmgiONUocaiEjB5pgWJFDGACHOOXQ6nXYyJwcHB40bSQM0PpZlia9//esgInz66acYDAbS7/el1+vl5WldIR9XXusBlYJgrS2ZeRR5foFY4oo/Rzji+GoOwBG3aFSGc0eqYTUDpr2VxiIiVVVJBKABTntXOQGwsbEBoK4MTUxM4Nq1a7DWyurqKvr9fu4LGltaWtcjokRViaiUowqRFk+1LKarwkQUYgKUp98hRo9cEyoc+Z1kJpnwDUGJSLfZj7XLv/41Ln7jG8cBmJycTDe99xgMBlhZWUG/34fm4DiqtugkTFTHYK2toqClMSavE+bbZg0AolAujoM6fxI1sWQ6GSBKuJR7sDGGiYhDCJwla+N8BUQERcssEgBxXzA1IsL169fhvcezzz6LmZkZnTRQU01NjnRlQlx93cRQB5gXRY8BEEHLa4XJDESkAlBGv6J8Q/1OCHWFs60NHBM0oeaxHGEAZ7/61YacCYCvfOUrjQ9iLAZQcwS9rVctkuS0GEf5uZawx5WqdEWUHCnLUwKWA1ACGBljSmYu0XSMPv42I+4469hVVYlzTjIzEABg7/Hrt97Cd1588TgA4zYNFIiDgwM5efJkftyFu92u7tLoVpWPk05cHc0ymTo6TaN1T1ALIMeywBhSRwoCjkeJPClLGhALoTrXpPLGGLlw7lxDvgRAe8Mgb4PBIP88IT0cDrkoimCt1ZS0kqPydc7rc9Kjds5RrS0zK/UFjtih0ulSREaoQ+UIx0NqDkR7w7ThBzY2NrC7u4szTz752QBotYRop9PRukBgZmOtJWOMCSFUmqigWZBIDjSuvgPgjDGavipzy80qlcrRigo4rgFt4dN8RQR5IeQYABcvXnygxLdv38Zrr72GH/7wh3myxNnWNzvngvfeOOd8FttV7TXuCx1thzf2CzIfoOww3x3OQVBfkK9+mws0vP/W1pZcv35dTp48ibm5ufEA6GnPdhMRTExMYHJyMs4/edbGigKgeERGdz8aiUx0qoIsj4j5fHKCUu9Cae0x8QvUkaCt+rkW5IXSvEwuADA3N4fnn38eRVEc2yEmvfHHP/5xLAAKAhHh3LlzjTMEIQQ3Go3MYDAwAFw8M2BjbE9VHIm7x3HnuMg+y2uFjb2ILBwGHGmAR51yj1DvJ+q9HBzVCjUlvnfvnty4cUO0SLK2tpZkSxqwsrIyVngiSsddx5y5YWOMbjhyzA2AOlevgNrzxqKHZAXUEFmj8oMcAAUhX1HPzJUxplK2GULwqJmor6qKY54iQE3kdnd3OdY35He/+51cvnwZExMTMMY0AEga0CZCbRC89/DeY2pqKs/TDQA6PDw0uolpjLHOOcfMzntvnXPOGFOISBFCKGLG6Jg5rw6bPM9HdogiRgT1GxUze135yBBLLcyo1ohIqKqKO51OKMtS3n//fckLJhcuXDiuAXfu3HkgAABweHiYb5/lbI76/T6JCO/s7ICIMD09jbhzlJe2OdJXZ611xpik+sxsRUTNqyYtzcqzRoQQt9FTPTKEkMryMV1nItJECKPRCH/4wx/SHmcbgKQB77777kMBUAR7vR594QtfQLb3ljRBRCiGQ43tNhNU9wotxd0hZrbWWqrLCibXAM0/NGNMSVCoz+h5730wxngR8cwcnHNp1XHkA0RE+ODgoOH5coefNODnP//5QwGg+GeElZUVefLJJ8fVDYmISP0EM0sIAd1ut6EFEQwTQtBTZCYSKZWfdOs7jpMSHsSSnF5jPpCKJ51Oh9vz8t5ja2urUTMcC4Cex39Y63Q6WFlZQVEUcu/ePep2uxgMBnmWqBrBzjndUzQAJO7aSqwm6Va60mATQtATH3k0yLM6RvQJ6khRO0dmZv2cEfnGaDSSbreLoihQVRVCCGMPTuZbY38VAGstiqLAaDTC66+/Lt/61rf0rzQPqiKnvQU9GxTvKwB65s9E+0x1/QwEHVMTHXbOcfQFbK1VX5GYX1mWuH37NpaXl2l3d5eXl5cfeGp07F9mHtaICGVZYjAYYGZmRgDQaDSSoijywmQuHEUA8tp/ewsrnUkOIehefg5AIl5RzVPPs8DsGTlz5oxYa+XevXu4c+dOntHiXJYQfWYA1Jacc7r7Im+++SZWV1fp7NmzOlktn7XBUHJCIQRDddxUUqUHq5MGVFUFAIibtOrUhJnVNDi7z3fv3hURkaWlpWQ6Tz311EPl+cwAjGvRxnS1xjrI1n0ajUbinCNdGf2vQQyFABqHnZMmhBAkaiADkMPDQ4n/cJPhcIj5+Xl1nvj3n/4UB/v7ODEx0ZjQv7788qMFoNPppBj76aefyi9+8QssLS3JpUuXKNt2b+QGg8EgrzNSr9djzQi1jTlqj+hcARz9+cJ7D+ecnDlzJiVABwcH0GNxh/H/UOPaIwEgb/fv38fVq1fbyVVuy5RdtVGkrzQzM/Mwhyzta/Y7aZE/+ugj/Odbb8n0zAzmTp1CfbJmfHvkADjnMDMzg8ceewzGGNnf38fly5fp9OnTknNwNEEQay2mpqbaf7Bot3alV8a9/u1vfytXr13D6uoqyrJ86Hz/euz7O5uivr29jV/+8peyubmZx/Njh5xiMjMutz/WfVXxzs4O7+zsyL1792R/f78RBRYWFjA5OYm4OXKs5+2Ra0C7OeewsLCA+F+kvKUVGw6H2Nzc1Pxh7DiBGT0iWXr8cbp5+zY+eP99mZ6exsHBAZaWlrC6upqefZjKt1vKBf5Z2/+ZCfx/af8DTo8DJZHbJ6cAAAAASUVORK5CYII=",uniforms:{worldSize:{type:"vec3",value:[0,0,0]},gravity:{type:"float",value:100},wind:{type:"float",value:0}},buffers:{size:{size:1,data:[]},rotation:{size:3,data:[]},speed:{size:3,data:[]}},vertex:"\n        precision highp float;\n    \n        attribute vec4 a_position;\n        attribute vec4 a_color;\n        attribute vec3 a_rotation;\n        attribute vec3 a_speed;\n        attribute float a_size;\n    \n        uniform float u_time;\n        uniform vec2 u_mousemove;\n        uniform vec2 u_resolution;\n        uniform mat4 u_projection;\n        uniform vec3 u_worldSize;\n        uniform float u_gravity;\n        uniform float u_wind;\n    \n        varying vec4 v_color;\n        varying float v_rotation;\n    \n        void main() {\n    \n          v_color = a_color;\n          v_rotation = a_rotation.x + u_time * a_rotation.y;\n    \n          vec3 pos = a_position.xyz;\n    \n          pos.x = mod(pos.x + u_time + u_wind * a_speed.x, u_worldSize.x * 2.0) - u_worldSize.x;\n          pos.y = mod(pos.y - u_time * a_speed.y * u_gravity, u_worldSize.y * 2.0) - u_worldSize.y;\n    \n          pos.x += sin(u_time * a_speed.z) * a_rotation.z;\n          pos.z += cos(u_time * a_speed.z) * a_rotation.z;\n    \n          gl_Position = u_projection * vec4( pos.xyz, a_position.w );\n          gl_PointSize = ( a_size / gl_Position.w ) * 100.0;\n    \n        }",fragment:"\n        precision highp float;\n    \n        uniform sampler2D u_texture;\n    \n        varying vec4 v_color;\n        varying float v_rotation;\n    \n        void main() {\n    \n          vec2 rotated = vec2(\n            cos(v_rotation) * (gl_PointCoord.x - 0.5) + sin(v_rotation) * (gl_PointCoord.y - 0.5) + 0.5,\n            cos(v_rotation) * (gl_PointCoord.y - 0.5) - sin(v_rotation) * (gl_PointCoord.x - 0.5) + 0.5\n          );\n    \n          vec4 snowflake = texture2D(u_texture, rotated);\n    \n          gl_FragColor = vec4(snowflake.rgb, snowflake.a * v_color.a);\n    \n        }",onResize(e,t,i){const n=e/t*110;this.uniforms.worldSize=[n,110,80],this.buffers.position=[],this.buffers.color=[],this.buffers.rotation=[],this.buffers.size=[],this.buffers.speed=[]},onUpdate(e){i.force+=(i.target-i.force)*i.easing,i.current+=i.force*(.2*e),this.uniforms.wind=i.current,Math.random()>.995&&(i.target=(i.min+Math.random()*(i.max-i.min))*(Math.random()>.5?-1:1))}})}};class SpecialEffectServer extends BaseServer{constructor(){super("specialEffect")}get weather(){return weather}}let specialEffectServer=new SpecialEffectServer;const MD5=CryptoJS__default.MD5;function extractData(e){let t=e,i=t.length,n=new Uint8Array(i/4*3),o=0;for(let e=0;e<i-1;e+=4){let i=t.subarray(e,e+3);n.set(i,o),o+=3}let s=n.length;for(let e=n.length-1;e>0&&0==n[e];e--)s--;let r=n.subarray(0,s);return new TextDecoder("utf-8").decode(r)}function decodeApng(e){let t={success:!1,msg:"",msgType:1,data:void 0},i=UPNG.decode(e),n=i.frames.length;if(n<2)return t.msg="无效的数据芯片",t.msgType=3,t;let o=new Uint8ClampedArray(260100*n);for(let e=1;e<n;e++){let t=UPNG.toRGBA8(i)[e],n=new Uint8Array(t),s=n[0],r=n.subarray(1020),a=new Uint8ClampedArray(s*s*4);for(let e=0;e<s;e++){let t=r.subarray(255*e*4,255*e*4+4*s);a.set(t,e*s*4)}o.set(a,260100*(e-1))}let s=extractData(o),r=UPNG.toRGBA8(i)[1];if(extractData(new Uint8Array(r).subarray(4,128))!==MD5(s).toString())return t.msg="校验失败",t.msgType=2,t;try{JSON.parse(s),t.success=!0,t.msg="解析成功",t.msgType=0,t.data=s}catch(e){t.msg="解析失败",t.msgType=1}return t}function isAb(e){return e instanceof ArrayBuffer}async function getImageBlob(e){return await new Promise((t,i)=>{let n=new XMLHttpRequest;n.open("get",e,!0),n.responseType="blob",n.onload=function(){200===this.status&&(this.response.type.includes("image/")&&t(this.response),i(null))},n.onerror=function(e){i(e)},n.send()})}async function img2str2(e){let t={success:!1,msg:"",msgType:3,data:void 0};return await new Promise((i,n)=>{if("string"==typeof e){let o=new FileReader;getImageBlob(e).then(e=>{o.readAsArrayBuffer(e)}).catch(e=>{t.msg="获取图片异常",n(t)}),o.onload=function(e){let t=decodeApng(e.target.result);i(t)}}else if(isAb(e)){let t=decodeApng(e);i(t)}else t.msg="无效的图片地址",n(t)})}const configI18nMapping={voiceRecognize:"cmlpanel.recognition",gestureRecognize:"cmlpanel.gestures",faceRecognize:"cmlpanel.face",voiceFeedback:"cmlpanel.prompts",lightSensor:"cmlpanel.lightSensor",theme:"cmlpanel.theme",sound:"cmlpanel.soundManage",soundsType:"cmlpanel.changeSound",LangI18n:"cmlpanel.i18n",DataSource:"cmlpanel.data",check:"cmlpanel.systemCheck",Hotkeys:"cmlpanel.hotkeys",Commands:"cmlpanel.commands",Actions:"cmlpanel.action",customLayout:"cmlpanel.customLayout",logSetting:"cmlpanel.console_log",vuexSetting:"cmlpanel.console_config",timeLine:"cmlpanel.timeLine"},eventType$b={configLoad:"configLoad",notValid:"notValid",error:"error"},CONFIG_PATH="./anov.png";class ChipServer extends BaseServer{constructor(){super("chip")}init(e){let t={dom:document.body,configPath:e.configPath?e.configPath:CONFIG_PATH,isDrop:!0};"string"==typeof(e=Object.assign(t,e)).configPath&&e.configPath;try{this.loadConfig(e.configPath)}catch(e){this.dispatchEvent({type:eventType$b.error,result:"数据芯片已损坏"})}e.isDrop&&this.initDrop(e.dom)}initDrop(e){e.addEventListener("dragover",t=>{t.preventDefault(),e.className.indexOf("ondrag")<0&&(e.className+=" ondrag")}),e.ondrop=(t=>{this.isDropLoad=!0,e.className=e.className.replace(" ondrag","");var i=t.dataTransfer.files;this.reader(i[0],e=>{this.loadConfig(e)})}),document.ondragover=function(e){e.preventDefault()},document.ondrop=function(e){e.preventDefault()}}loadConfig(e){var t=new Date;img2str2(e).then(i=>{let n=!1,o=null,s=null;if(i.success){try{var r=(new Date).getTime()-t.getTime();s="解析"+(e.byteLength||e.length)/1e3+"kb,用时:"+r+"ms",o=JSON.parse(i.data),window.__ANOV__PROJECT={projectId:o.projId||"",projectName:o.projName||"",copyright:o.copyright||""},n=!0,window.__ANOV__PERMISSION=o.panel.permission}catch(e){this.dispatchEvent({type:eventType$b.notValid,result:"不是有效的数据芯片"})}n&&this.dispatchEvent({type:eventType$b.configLoad,result:o,isDropLoad:this.isDropLoad,msg:s})}else this.dispatchEvent({type:eventType$b.notValid,result:i.msg});this.isDropLoad=!1})}reader(e,t){var i=new FileReader;try{i.readAsDataURL(e)}catch(i){this._addLog({type:"error",msg:"read chip error! path:"+e}),t(e)}i.onload=function(){t&&t(i.result)}}}const chipServer=new ChipServer;chipServer.configI18nMapping=configI18nMapping;var admin={namespaced:!0,state:{serverPath:"",connected:!1,isActive:!1},mutations:{setServerPath(e,t){e.serverPath=t},setConnected(e,t){e.connected=t},setIsActive(e,t){e.isActive=t}}},voiceRecognize={namespaced:!0,state:{isStart:!1,iatType:"default",APPID:"",API_KEY:""},getters:{isStart:(e,t)=>e.isStart,iatType:(e,t)=>e.iatType,APPID:(e,t)=>e.APPID,API_KEY:(e,t)=>e.API_KEY},mutations:{setIsStart(e,t){e.isStart!=t&&(e.isStart=t)},changeIatType(e,t){e.iatType!=t&&(e.iatType=t)},setAPPID(e,t){e.APPID!=t&&(e.APPID=t)},setAPIKEY(e,t){e.API_KEY!=t&&(e.API_KEY=t)}}};const store={namespaced:!0,state:{isStart:!1,synthesisType:"default",thirdConfig:{APPID:"",API_SECRET:"",API_KEY:"",voiceName:""}},getters:{isStart:e=>e.isStart,synthesisType:e=>e.synthesisType,thirdConfig:e=>e.thirdConfig},mutations:{toggleOpen(e,t){"boolean"==typeof t&&(e.isStart=t)},changeSynthesisType(e,t){e.synthesisType=t},setThirdConfig(e,t){"object"==typeof t&&Object.assign(e.thirdConfig,t)}}};var faceRecognize={namespaced:!0,state:{isStart:!1,faceCount:0},mutations:{setIsStart(e,t){e.isStart!=t&&(e.isStart=t)},setFaceCount(e,t){e.faceCount=t}}},dataSource={namespaced:!0,state:{type:"mock"},getters:{},mutations:{setType(e,t){e.type=t}}},gestureRecognize={namespaced:!0,state:{isStart:!1},mutations:{setIsStart(e,t){e.isStart!=t&&(e.isStart=t)}}},lightSensor={namespaced:!0,state:{isStart:!1,isBrightness:!0,isHue:!0,intervalTime:1e3,lightColor:[200,200,200]},mutations:{setIsStart(e,t){e.isStart=t},setIsBrightness(e,t){e.isBrightness=t},setIsHue(e,t){e.isHue=t},setIntervalTime(e,t){e.intervalTime=t},setLightColor(e,t){e.lightColor=t}}};const store$1={namespaced:!0,state:{resolution:{w:1920,h:1080},designSize:{w:3840,h:1080},browserInfo:{},localNetwork:{type:"local",connected:!1,speed:0,level:0},remoteNetwork:{type:"remote",connected:!1,speed:0,level:0},scaleRatio:1,performance:{},videoStatus:!1,audioStatus:!1,videousable:!1,audiousable:!1,fps:0,weather:{},resourceSize:{},displayEffect:0,isConnectCapacityServer:!1,hardware:{},memory:{performance:{memoryTotalJsHeapSize:0,memoryUsedJsHeapSize:0},currentMemory:{mb:1,unit:"MB"}},browserScaleRatio:1,level:""},getters:{localNetwork:e=>e.localNetwork},mutations:{setResolution(e,t){e.resolution=t},setBrowser(e,t){e.browserInfo=t},setLocalNetwork(e,t){e.localNetwork=t},setRemoteNetwork(e,t){e.remoteNetwork=t},setPageScaleRation(e,t){e.scaleRatio=t},setDesignSize(e,t){e.designSize=t},setPerformance(e,t){e.performance=t},setVideoStatus(e,t){e.videoStatus=t},setAudioStatus(e,t){e.audioStatus=t},setFps(e,t){e.fps=t},setWeather(e,t){e.weather=t},setResourceSize(e,t){e.resourceSize=t},setDisplayEffect(e,t){e.displayEffect=t},setIsConnectCapacityServer(e,t){e.isConnectCapacityServer=t},setHardware(e,t){e.hardware=t},setMemory(e,t){e.memory.performance=t},setCurrentMemory(e,t){e.memory.currentMemory=t},setBrowserScaleRatio(e,t){e.browserScaleRatio=t},setLevel(e,t){e.level=t}}};var language={namespaced:!0,state:{lang:"zh-CN",langOption:[]},mutations:{setLang(e,t){e.lang=t},setOption(e,t){e.langOption=t}}};const store$2={namespaced:!0,state:{themes:[],currentThemeValue:"default",adjTheme:{},adjThemeValue:"default"},getters:{themes:e=>e.themes,currentThemeValue:e=>e.currentThemeValue,currentTheme:e=>e.themes.filter(t=>t.value===e.currentThemeValue||!1)[0],systemAddedThemes:e=>e.themes.filter(e=>"system"===e.type||!1),customAddedThemes:e=>e.themes.filter(e=>"custom"===e.type||!1)},mutations:{initTheme(e,t){t.findIndex(e=>"default"===e.value)>=0||console.error('make sure have a "default" theme'),e.themes=t.map(e=>(e.id||(e.id=e.value),e.type||(e.type="system"),e))},setTheme(e,t){e.currentThemeValue=t,e.adjThemeValue=t},addTheme(e,t){e.themes.push(t)},deleteTheme(e,t){let i=e.themes;for(let n=0;n<i.length;n++)i[n].id===t&&i[n].value===e.currentThemeValue&&(e.currentThemeValue=i[n-1].value||i[0].value);e.themes=e.themes.filter(e=>e.id!==t||!1)},modifyTheme(e,t){e.themes.forEach(e=>{e.id===t.id&&(e.config=t.params)})},modifyThemeName(e,t){e.themes.forEach(e=>{e.id===t.id&&(e.label=t.label)})},setAdjTheme(e,t){e.adjTheme=t},setAdjThemeValue(e,t){e.adjThemeValue="custom"}}};var preload={namespaced:!0,state:{isComplete:!1},mutations:{setIsComplete(e,t){e.isComplete=t}}},license={namespaced:!0,state:{code:"",expireDay:0,dueDate:""},mutations:{setCode(e,t){e.code=t},setExpireDay(e,t){e.expireDay=t},setDueDate(e,t){e.dueDate=t}}};const store$3={namespaced:!0,state:{isSystemCheckOpen:!1,defaultParams:{}},getters:{},mutations:{setIsOpen(e,t){e.isSystemCheckOpen=t},setDefaultParams(e,t){e.defaultParams=t}}};var animate={namespaced:!0,state:{animateDebug:!1},mutations:{setAnimateDebug(e,t){e.animateDebug=t}}};const store$4={namespaced:!0,state:{pages:[],destroyParts:[]},mutations:{changePart(e,t){let i=e.pages.find(e=>e.path==t.path).parts.find(e=>e.id==(t.part&&t.part.id));Object.assign(i.style,t.part.style)},addPage(e,t){e.pages.push(t)},setPage(e,t){e.pages=t&&t.pages||[],e.destroyParts=t&&t.destroyParts||[]},deletePart(e,{path:t,id:i}){let n=e.pages.find(e=>e.path===t);if(!n)return;let o=n.parts;for(let s=0;s<o.length;s++){let r=o[s];if(r.id===i){let o={[`${t}_${i}`]:r};e.destroyParts.push(o),n.parts.splice(s,1);break}}},resetPart(e,{path:t,id:i}){let n=e.destroyParts,o=e.pages.find(e=>e.path===t);for(let e=0;e<n.length;e++){let s=n[e];if(s[`${t}_${i}`]){o.parts.push(s[`${t}_${i}`]),n.splice(e,1);break}}}}},store$5={namespaced:!0,state:{isDragOpen:!1,lockAspectRatio:!0,draggable:!0,resizable:!0,axis:"both",grid:[1,1],minW:10,minH:10},mutations:{setDragOpt(e,{key:t,val:i}){"undefined"!=e[t]&&(e[t]=i)}}},store$6={namespaced:!0,state:{isSoundOpen:!1,soundsType:"default"},mutations:{setIsSoundOpen(e,t){e.isSoundOpen=t},setSoundsType(e,t){e.soundsType=t}}},store$7={namespaced:!0,state:{isOpen:!1,focusedId:"",carousel:!1},mutations:{setIsOpen(e,t){e.isOpen=t},setFocusedId(e,t){e.focusedId=t},setCarousel(e,t){e.carousel=t}}},store$8={namespaced:!0,state:{isLoginOpen:!1,loginState:!1,loginId:"",isLogin:!1},mutations:{setIsLoginOpen(e,t){e.isLoginOpen=t},setLoginState(e,t){e.loginState=t},setLoginId(e,t){e.loginId=t},setIsLogin(e,t){e.isLogin=t}}},store$9={admin:admin,voiceRecognize:voiceRecognize,voiceFeedback:store,faceRecognize:faceRecognize,dataSource:dataSource,gestureRecognize:gestureRecognize,lightSensor:lightSensor,part:store$5,page:store$4,env:store$1,language:language,theme:store$2,preload:preload,sound:store$6,license:license,systemCheck:store$3,animate:animate,focus:store$7,permission:store$8};class FocusServer extends BaseServer{constructor(){super("focus"),this.focusOptions=[],this.carouselNum=-1}get isOpen(){return this.callState("isOpen")}set isOpen(e){this.callMutation("setIsOpen",e)}get focusedId(){return this.callState("focusedId")}set focusedId(e){this.callMutation("setFocusedId",e)}get carousel(){return this.callState("carousel")}set carousel(e){this.callMutation("setCarousel",e)}init(e){this.isOpen=e.isOpen,this.carousel=e.carousel,this.focusOptions=e.focusOptions||[]}activated(e){if(!this.isOpen||this.focusedId)return;let t,i=e;if(isPlainObject(e)){if(!e.id)return;i=e.id,!this.focusOptions.find(e=>e.id==i)&&this.focusOptions.push(e)}(t=this.focusOptions.find(e=>e.id==i))&&(this.focusedId=i,this._show())}inactivated(){this.focusedId&&this._hide()}focuseNext(){this.carouselNum++,this.carouselNum>=this.focusOptions.length&&(this.carouselNum=0);let e=this.focusOptions[this.carouselNum]&&this.focusOptions[this.carouselNum].id;app.focusServer.activated(e)}setFocusOptions(e={}){if(!e.id)return;this.focusOptions.find(t=>t.id==e.id)||this.focusOptions.push(e)}resetFocusOptions(e=[]){isArray(e)&&(this.focusOptions=e)}updateFocusOptions(e={}){if(!e.id)return;let t=this.focusOptions.find(t=>t.id==e.id);Object.assign(t,e)}_show(){this.focusedId&&this.dispatchEvent({type:"show"})}_hide(){this.dispatchEvent({type:"hide"})}hideComplete(){this.dispatchEvent({type:"hideComplete"})}}let focusServer=new FocusServer;const evnetType$1={loginState:"loginState",loginOpen:"loginOpen",loginClose:"loginClose",loginSuccess:"loginSuccess",loginError:"loginError"};class PermissionServer extends BaseServer{constructor(){super("permission"),this.loginOptions=[]}init(e){let t=this._extractConfig(e);this.loginOptions=t.loginOptions}get loginState(){return this.callState("loginState")}get isLogin(){return this.callState("isLogin")}get loginId(){return this.callState("loginId")}set loginId(e){this.callMutation("setLoginId",e)}set isLogin(e){this.callMutation("setIsLogin",e)}setLoginState(e){this.callMutation("setLoginState",e),e?this.dispatchEvent({type:evnetType$1.loginSuccess}):this.dispatchEvent({type:evnetType$1.loginError})}openLogin(){this.callMutation("setIsLoginOpen",!0),this.dispatchEvent({type:evnetType$1.loginOpen})}closeLogin(){this.callMutation("setIsLoginOpen",!1),this.dispatchEvent({type:evnetType$1.loginClose})}}let permissionServer=new PermissionServer;class DataConversion extends BaseServer{constructor(){super("dataConversion")}xlsx2json(e,t={}){let i={},n=read(e,t);return n.SheetNames.forEach(function(e){let t=utils.sheet_to_json(n.Sheets[e]);i[e]=t}),i}}let dataConversion=new DataConversion,corePackageJson=require("./../package.json"),coreName=corePackageJson.name||"",coreVerison=corePackageJson.version||"";console.log("%c"+coreName+"%cv"+coreVerison+"%c\t\t\t\thttps://www.npmjs.com/package/anov-core","font-size:12px;background:#606;padding:3px 10px;font-weight:bold;color:#ccc;","background:#000;padding:3px 10px;color:#ccc;","color:#999;");let anovPackageJSON=require("./../../../package.json"),name=anovPackageJSON.name||"",verison=anovPackageJSON.version||"",projectId=anovPackageJSON.projectId||"",projectName=anovPackageJSON.projectName||"",copyright=anovPackageJSON.copyright||"",str="%c"+name+" %cv"+verison+"%c\t\t\t\thttps://anov.woyun.cn/";console.log(str,"font-size:12px;background:#066;padding:3px 10px;font-weight:bold;color:#ccc;","font-size:12px;background:#000;padding:3px 10px;color:#ccc;","background:transparent;color:#999;"),console.log("%c[anov] %cprojectId:"+projectId+", projectName:"+projectName+"-"+copyright,"color:#399;padding:5px 0px","color:#666;");export{Action,actionServer,adminServer,animateServer,chipServer,dataConversion,dataSourceServer,envServer,faceRecognizeServer,focusServer,gestureRecognizeServer,hotkeyServer,languageServer,licenseServer,lightSensorServer,pageServer,partServer,permissionServer,preloadServer,runtimeServer,sizeAdaptServer,soundServer,specialEffectServer,store$9 as store,systemCheckServer,themeServer,voiceFeedbackServer,voiceRecognizeServer};
